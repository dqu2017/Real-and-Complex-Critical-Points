(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    363134,       8873]
NotebookOptionsPosition[    342539,       8567]
NotebookOutlinePosition[    342977,       8584]
CellTagsIndexPosition[    342934,       8581]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Exit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.890155054283395*^9, 3.8901550566210957`*^9}, {
  3.912474241660734*^9, 3.912474242264205*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"8669d291-cd7e-49ac-9853-a9c2c01b9b80"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellLabel->
  "In[488]:=",ExpressionUUID->"1e5cfc05-c04b-411b-97a1-ba180fbdfeb8"],

Cell[CellGroupData[{

Cell["Get Bdry data and critical point for 4 - simplex", "Section",
 CellChangeTimes->{{3.914583227429459*^9, 3.914583245005979*^9}, 
   3.918816274650124*^9},ExpressionUUID->"8f6b0ca8-8e8f-4233-868a-\
0bc0990a9a1d"],

Cell[CellGroupData[{

Cell["Define parameters", "Subsection",
 CellChangeTimes->{{3.9123743637159643`*^9, 
  3.912374373282226*^9}},ExpressionUUID->"0a9e6b0e-d1c8-4b85-9aa2-\
0cde8a146d25"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sigma4", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"PauliMatrix", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"sigmabar4", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}], "}"}], ",", 
     RowBox[{"-", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"su11sigma", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PauliMatrix", "[", "3", "]"}], ",", 
     RowBox[{"I", " ", 
      RowBox[{"PauliMatrix", "[", "1", "]"}]}], ",", 
     RowBox[{"I", " ", 
      RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8870415766373463`*^9, 3.887041576640115*^9}},
 CellLabel->
  "In[489]:=",ExpressionUUID->"e148683c-689f-4aee-b41f-11a3fb4c777f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Jvec", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"-", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8870415839791107`*^9, 3.887041583982251*^9}, {
  3.911767417085882*^9, 3.911767418546623*^9}},
 CellLabel->
  "In[492]:=",ExpressionUUID->"4eb677e2-2168-475c-8282-b2ae79a65ce3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"jjvec", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"I", "/", "2"}], " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1"}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.887041590969199*^9, 3.887041597707075*^9}},
 CellLabel->
  "In[493]:=",ExpressionUUID->"5503d985-7f3a-494f-8f84-b49421c8aa66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"edgeor", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Subsets", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Subsets", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], ",", 
      RowBox[{"{", "4", "}"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"faceor", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Subsets", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", "3", "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Subsets", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], ",", 
      RowBox[{"{", "4", "}"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.887041603687332*^9, 3.887041603690481*^9}},
 CellLabel->
  "In[495]:=",ExpressionUUID->"3849ae44-2d4d-4f3f-b200-07ce27a5a7e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"etof", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tetorder", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"j", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5", ",", "1", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"edgefromfaceor", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Subsets", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], "&"}], "/@", 
      RowBox[{"faceor", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"edgefromfaceornum", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"edgeor", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"edgefromfaceor", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "//", "Flatten"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.887041611112288*^9, 3.8870416111149406`*^9}},
 CellLabel->
  "In[497]:=",ExpressionUUID->"10e54791-b7bd-45c1-9baa-790251373679"]
}, Closed]],

Cell[CellGroupData[{

Cell["define 4d outgoing normals", "Subsection",
 CellChangeTimes->{{3.912460104040395*^9, 
  3.9124601104388638`*^9}},ExpressionUUID->"f3f1d9ed-413d-4230-94f6-\
73b49feffba9"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"vector", " ", "lenght", " ", "square", " ", "function"}], ",", 
   " ", "v1", ",", " ", 
   RowBox[{
   "v2", " ", "are", " ", "the", " ", "end", " ", "points", " ", "of", " ", 
    "the", " ", "vector"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.912456525948284*^9, 3.91245660489703*^9}},
 CellLabel->
  "In[501]:=",ExpressionUUID->"cae9c073-1829-4e80-9a25-b696075e30fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistanceSquare", "[", 
   RowBox[{"P1_", ",", "P2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"P1", "-", "P2"}], ")"}], ".", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], ".", 
   RowBox[{"(", 
    RowBox[{"P1", "-", "P2"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.9124565652373667`*^9, 3.9124565781144867`*^9}},
 CellLabel->
  "In[502]:=",ExpressionUUID->"b66829b9-9c75-43bc-aece-e3415bf4509a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "V3sq", " ", "is", " ", "the", " ", "volume", " ", "Square", " ", "of", 
    " ", "Tetrahedra"}], ",", " ", 
   RowBox[{"ls", " ", "is", " ", "length", " ", "square"}]}], "*)"}]], "Input",\

 CellChangeTimes->{{3.912456633653277*^9, 3.9124566571636763`*^9}},
 CellLabel->
  "In[503]:=",ExpressionUUID->"10c29e57-9de2-4959-912a-1ec06790559d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CM3D", "[", 
   RowBox[{"{", 
    RowBox[{
    "ls12_", ",", "ls13_", ",", "ls14_", ",", "ls23_", ",", "ls24_", ",", 
     "ls34_"}], "}"}], "]"}], ":=", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "ls12", "ls13", "ls14", "1"},
      {"ls12", "0", "ls23", "ls24", "1"},
      {"ls13", "ls23", "0", "ls34", "1"},
      {"ls14", "ls24", "ls34", "0", "1"},
      {"1", "1", "1", "1", "0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V3sq", "[", 
   RowBox[{"{", 
    RowBox[{
    "ls12_", ",", "ls13_", ",", "ls14_", ",", "ls23_", ",", "ls24_", ",", 
     "ls34_"}], "}"}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{"3", "+", "1"}]], 
    RowBox[{
     SuperscriptBox["2", "3"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"3", "!"}], ")"}], "2"]}]], 
   RowBox[{"Det", "[", 
    RowBox[{"CM3D", "[", 
     RowBox[{"{", 
      RowBox[{
      "ls12", ",", "ls13", ",", "ls14", ",", "ls23", ",", "ls24", ",", 
       "ls34"}], "}"}], "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.83493532569634*^9, 3.834935375331972*^9}, {
  3.8475612616293163`*^9, 3.847561262036572*^9}, {3.854126300466716*^9, 
  3.854126308073391*^9}, {3.8542095578576202`*^9, 3.8542095687559023`*^9}},
 CellLabel->
  "In[504]:=",ExpressionUUID->"960ce8e4-c9a3-4601-997c-715da9fecc9a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "output", " ", "is", " ", "the", " ", "4", "d", " ", "normals", " ", "of", 
    " ", "five", " ", "tetrehedra", " ", "when", " ", "the", " ", "input", 
    " ", "is", " ", "the", " ", "coordinates", " ", "of", " ", "the", " ", 
    "4"}], "-", 
   RowBox[{
    RowBox[{"simplex", ".", " ", "This"}], " ", "4"}], "-", 
   RowBox[{"d", " ", "normal", " ", "is", " ", 
    RowBox[{"outgoing", "."}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.912456647297121*^9, 3.912456726071274*^9}, {
  3.912457915619046*^9, 3.912457927774061*^9}},
 CellLabel->
  "In[506]:=",ExpressionUUID->"debf953e-7e37-48a1-9351-0cd78e5dd699"],

Cell[BoxData[
 RowBox[{
  RowBox[{"get4dnormal", "[", "bdypoints_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ll$111", "=", 
       RowBox[{"Length", "[", "bdypoints", "]"}]}], ",", "edgevec", ",", "a", 
      ",", "b", ",", "c", ",", "d", ",", "unsignnormalvec$111", ",", 
      "centers", ",", "randompoints", ",", "randompoints1", ",", 
      "randompoinsall", ",", "pos", ",", "sign", ",", "lineareqns", ",", 
      "type", ",", "solntest"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ll$111", "=", 
      RowBox[{"Length", "[", "bdypoints", "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"edgevec", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"bdypoints", "[", 
             RowBox[{"[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
            RowBox[{"bdypoints", "[", 
             RowBox[{"[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
         RowBox[{"edgeor", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"unsignnormalvec$111", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ".", 
                 "\[Eta]", ".", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}],
                "]"}]}], "/.", " ", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ".", 
                    RowBox[{"DiagonalMatrix", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1"}], "}"}],
                     "]"}], ".", "#"}], "&"}], "/@", 
                   RowBox[{"edgevec", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], ")"}], "==", 
                 "0"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}]}],
             "//", "Flatten"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", ">", "0"}], ",", 
              RowBox[{"b", ">", "0"}], ",", 
              RowBox[{"c", ">", "0"}], ",", 
              RowBox[{"d", ">", "0"}]}], "}"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "edgevec"}]}], "}"}]}], "]"}], "//", 
       "Quiet"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"centers", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Total", "[", "#", "]"}], "/", 
          RowBox[{"Length", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
       RowBox[{"Subsets", "[", 
        RowBox[{"bdypoints", ",", 
         RowBox[{"{", "4", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"randompoints", "=", 
      RowBox[{"centers", "+", 
       RowBox[{"0.0001", "*", "unsignnormalvec$111"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"randompoints1", "=", 
      RowBox[{"centers", "-", 
       RowBox[{"0.0001", "*", "unsignnormalvec$111"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"randompoinsall", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"randompoints", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"randompoints1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "randompoints"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"pos", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"solntest", "=", 
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Thread", "[", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "a1", ",", "a2", ",", "a3", ",", "a4", ",", "a5"}], "}"}],
                     "*", "bdypoints"}], "]"}], "==", 
                  RowBox[{"randompoinsall", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"a1", "+", "a2", "+", "a3", "+", "a4", "+", "a5"}], 
                  "==", "1"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4", ",", "a5"}], 
               "}"}]}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"And", "@@", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4", ",", "a5"}],
                    "}"}], "/.", 
                  RowBox[{"solntest", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ">=", "0"}], 
               "]"}]}], ",", 
             RowBox[{"Unevaluated", "[", 
              RowBox[{"Sequence", "[", "]"}], "]"}], ",", "j"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "randompoinsall"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"sign", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "==", "2"}], ",", 
          RowBox[{"-", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "pos"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"type", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", ".", "\[Eta]", ".", "#"}], "&"}], "/@", 
       "unsignnormalvec$111"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sign", "*", "unsignnormalvec$111"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.912807410792058*^9, 3.912807417347025*^9}, {
   3.912812345349688*^9, 3.912812369692253*^9}, {3.913604093565385*^9, 
   3.913604101934951*^9}, {3.913604560649394*^9, 3.913604708501981*^9}, {
   3.913787162284253*^9, 3.9137872891095333`*^9}, {3.9141238332569637`*^9, 
   3.91412400101606*^9}, {3.914124356257942*^9, 3.9141244507795677`*^9}, {
   3.914124512878413*^9, 3.914124517981678*^9}, 3.9179707190567217`*^9, 
   3.918031775154646*^9, {3.918573738694489*^9, 3.918573761414425*^9}, {
   3.918574041181594*^9, 3.918574042004663*^9}},
 CellLabel->
  "In[507]:=",ExpressionUUID->"a663f5bd-7cac-4814-85dd-f853c40ca3b9"]
}, Closed]],

Cell[CellGroupData[{

Cell["compute area square", "Subsection",
 CellChangeTimes->{{3.912460104040395*^9, 3.9124601104388638`*^9}, {
  3.9124601960605927`*^9, 3.91246020001915*^9}, {3.9126282251270533`*^9, 
  3.912628235953496*^9}},ExpressionUUID->"689c27db-9127-4471-a209-\
675c52a6038c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Area", " ", "Square", " ", "of", " ", "Triangle"}], ",", 
   RowBox[{"ls", " ", "is", " ", "length", " ", "square"}]}], "*)"}]], "Input",\

 CellChangeTimes->{{3.9124609205563183`*^9, 3.912460923272711*^9}},
 CellLabel->
  "In[508]:=",ExpressionUUID->"68a76143-e71e-4f42-bf29-d3c1f0e67136"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CM2D", "[", 
   RowBox[{"{", 
    RowBox[{"ls12_", ",", "ls13_", ",", "ls23_"}], "}"}], "]"}], ":=", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "ls12", "ls13", "1"},
      {"ls12", "0", "ls23", "1"},
      {"ls13", "ls23", "0", "1"},
      {"1", "1", "1", "0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V2sq", "[", 
   RowBox[{"{", 
    RowBox[{"ls12_", ",", "ls13_", ",", "ls23_"}], "}"}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{"2", "+", "1"}]], 
    RowBox[{
     SuperscriptBox["2", "2"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "!"}], ")"}], "2"]}]], 
   RowBox[{"Det", "[", 
    RowBox[{"CM2D", "[", 
     RowBox[{"{", 
      RowBox[{"ls12", ",", "ls13", ",", "ls23"}], "}"}], "]"}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.83493532569634*^9, 3.834935375331972*^9}, {
  3.8475612616293163`*^9, 3.847561262036572*^9}, {3.852808632298923*^9, 
  3.85280868672825*^9}, {3.854126313276414*^9, 3.8541263170007467`*^9}, {
  3.8550600168487873`*^9, 3.855060024310048*^9}},
 CellLabel->
  "In[509]:=",ExpressionUUID->"a2ca764f-781f-4db5-b677-8e785f1facaf"]
}, Closed]],

Cell[CellGroupData[{

Cell["define dihedral angles", "Subsection",
 CellChangeTimes->{{3.912460104040395*^9, 3.9124601104388638`*^9}, {
  3.9124601960605927`*^9, 
  3.91246020001915*^9}},ExpressionUUID->"994ce7da-b7c6-462e-a662-\
1247c0d8e0c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["\[Theta]", "ab"], "[", 
   RowBox[{"Na_", ",", "Nb_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "normals4d", ",", "Na2", ",", "Nb2", ",", "Nab", ",", "LorentzianAngles",
       ",", "EucleanAngles", ",", "dihedrals", ",", "allangles"}], "}"}], ",",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Na2", "=", 
      RowBox[{"Na", ".", "\[Eta]", ".", "Na"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Nb2", "=", 
      RowBox[{"Nb", ".", "\[Eta]", ".", "Nb"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Nab", "=", 
      RowBox[{"Na", ".", "\[Eta]", ".", "Nb"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"LorentzianAngles", "=", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Na2", "*", "Nb2"}], "<", "0"}], ",", 
        RowBox[{"-", 
         RowBox[{"ArcSinh", "[", 
          RowBox[{"Na", ".", "\[Eta]", ".", "Nb"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Na2", "<", "0"}], "&&", 
         RowBox[{"Nb2", "<", "0"}]}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Nab", "<", "0"}], ",", 
          RowBox[{"-", 
           RowBox[{"ArcCosh", "[", 
            RowBox[{"-", 
             RowBox[{"Na", ".", "\[Eta]", ".", "Nb"}]}], "]"}]}], ",", 
          RowBox[{"ArcCosh", "[", 
           RowBox[{"Na", ".", "\[Eta]", ".", "Nb"}], "]"}]}], "]"}], ",", 
        "True", ",", 
        RowBox[{"Unevaluated", "[", 
         RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"EucleanAngles", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"Na", ".", "Nb"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"allangles", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Na2", ">", "0"}], "&&", 
         RowBox[{"Nb2", ">", "0"}]}], ",", "EucleanAngles", ",", 
        "LorentzianAngles"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "allangles"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.918034035931973*^9, 3.9180340664490423`*^9}, {
   3.918034100464746*^9, 3.9180341398174343`*^9}, 3.9186467331409903`*^9, {
   3.918653948562315*^9, 3.918653950533804*^9}},
 CellLabel->
  "In[511]:=",ExpressionUUID->"89e90888-b160-4de6-9f9d-19784d934775"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute SO (1,3) group element", "Subsection",
 CellChangeTimes->{{3.912485264037408*^9, 
  3.912485275318316*^9}},ExpressionUUID->"0abec264-c9f3-4e15-9238-\
7136059ab9b5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"define", " ", "wedge", " ", "product"}], "*)"}]], "Input",
 CellChangeTimes->{{3.912551939394368*^9, 3.912551951680327*^9}},
 CellLabel->
  "In[512]:=",ExpressionUUID->"fdf7ed59-ab0d-4a69-ac99-69c59229c03d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wedge", "[", 
   RowBox[{"a_List", ",", "b_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{"b", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"b", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{"a", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ".", 
   "\[Eta]"}]}]], "Input",
 CellChangeTimes->{{3.912486755017147*^9, 3.912486766932124*^9}, {
  3.91262831389065*^9, 3.912628314180993*^9}, {3.912628349905116*^9, 
  3.912628353412549*^9}},
 CellLabel->
  "In[513]:=",ExpressionUUID->"b35bef18-65f7-4bef-9016-7ae27e97e016"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"To", " ", "get", " ", "SO", 
    RowBox[{"(", 
     RowBox[{"1", ",", "3"}], ")"}], " ", "solutions", " ", "in", " ", 
    "Spinfoam"}], ",", " ", 
   RowBox[{
   "the", " ", "input", " ", "is", " ", "the", " ", "4", "d", " ", "normals", 
    " ", "of", " ", "the", " ", "tetradedron"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.912551957267763*^9, 3.912552007109911*^9}},
 CellLabel->
  "In[514]:=",ExpressionUUID->"6213babd-71ed-49a9-9f5e-1250423ee970"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getso13", "[", "Na_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ref", ",", 
      RowBox[{"Nasign", "=", 
       RowBox[{"Round", "[", 
        RowBox[{"Na", ".", "\[Eta]", ".", "Na"}], "]"}]}], ",", "dihedrals", 
      ",", "bivec", ",", "dualbivec1Norm", ",", "so13soln"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ref", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Nasign", "===", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Na", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"so13soln", "=", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Na", "==", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "||", 
         RowBox[{"Na", "==", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "||", 
         RowBox[{"Na", "==", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}]}]}], 
        ",", 
        RowBox[{"IdentityMatrix", "[", "4", "]"}], ",", 
        RowBox[{"Na", "==", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], ",", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"dihedrals", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Nasign", "===", 
             RowBox[{"-", "1"}]}], ",", 
            RowBox[{"Abs", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "ab"], "[", 
              RowBox[{"ref", ",", "Na"}], "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{
              SubscriptBox["\[Theta]", "ab"], "[", 
              RowBox[{"ref", ",", "Na"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bivec", "=", 
          RowBox[{"wedge", "[", 
           RowBox[{"ref", ",", "Na"}], "]"}]}], ";", 
         RowBox[{"dualbivec1Norm", "=", 
          RowBox[{"bivec", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"1", "/", "2"}], 
              RowBox[{"Tr", "[", 
               RowBox[{"bivec", ".", "bivec"}], "]"}]}], "]"}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"MatrixExp", "[", 
          RowBox[{"dihedrals", "*", "dualbivec1Norm"}], "]"}]}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{3.913610706103444*^9},
 CellLabel->
  "In[515]:=",ExpressionUUID->"04d22bea-f5d6-48f4-b7ad-109b9ca51e9f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute SL(2,C) group element", "Subsection",
 CellChangeTimes->{{3.912460104040395*^9, 3.9124601104388638`*^9}, {
  3.9124601960605927`*^9, 3.91246020001915*^9}, {3.912474552144562*^9, 
  3.9124745607061872`*^9}},ExpressionUUID->"26454666-9b23-4a7f-b54d-\
7e2f89c218df"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Convert", " ", "a", " ", "4", " ", "by", " ", "4", " ", "matrix", " ", 
   "in", " ", "vector", " ", "representation", " ", "to", " ", "a", " ", "2", 
   " ", "by", " ", "2", " ", "complex", " ", "matrix", " ", "in", " ", 
   "spinor", " ", "representation"}], "*)"}]], "Input",
 CellChangeTimes->{{3.912552024913177*^9, 3.912552080107342*^9}},
 CellLabel->
  "In[516]:=",ExpressionUUID->"93b3473b-d845-42ee-ad26-1f348e6ca697"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bivec1tohalf", "[", "bivec_", "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{"bivec", ".", 
          RowBox[{"Jvec", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Tr", "[", 
          RowBox[{"bivec", ".", 
           RowBox[{"Jvec", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "4", ",", "6"}], "}"}]}], "]"}]}]}], "]"}], "*", 
    "jjvec"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9124771263053837`*^9, 3.9124771357983913`*^9}},
 CellLabel->
  "In[517]:=",ExpressionUUID->"7b810fd4-d29b-4fd0-a033-1ae9e7aeb1cb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"To", " ", "get", " ", "SL", 
    RowBox[{"(", 
     RowBox[{"2", ",", "C"}], ")"}], " ", "solutions", " ", "in", " ", 
    "Spinfoam"}], ",", " ", 
   RowBox[{
   "the", " ", "input", " ", "is", " ", "the", " ", "4", "d", " ", "normals", 
    " ", "of", " ", "the", " ", "tetradedron"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9125520174687347`*^9, 3.912552022322442*^9}},
 CellLabel->
  "In[518]:=",ExpressionUUID->"c45c33bc-53b7-45af-a7c8-6553bda46f74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getsl2c", "[", "Na_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ref", ",", 
      RowBox[{"Nasign", "=", 
       RowBox[{"Round", "[", 
        RowBox[{"Na", ".", "\[Eta]", ".", "Na"}], "]"}]}], ",", "dihedrals", 
      ",", "bivec", ",", "dualbivec1Norm", ",", "sl2csoln"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ref", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Nasign", "===", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Na", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"sl2csoln", "=", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Na", "==", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "||", 
         RowBox[{"Na", "==", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "||", 
         RowBox[{"Na", "==", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}]}]}], 
        ",", 
        RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
        RowBox[{"Na", "==", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], ",", 
        RowBox[{"I", "*", 
         RowBox[{"PauliMatrix", "[", "1", "]"}]}], ",", "True", ",", 
        RowBox[{
         RowBox[{"dihedrals", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Nasign", "===", 
             RowBox[{"-", "1"}]}], ",", 
            RowBox[{"Abs", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "ab"], "[", 
              RowBox[{"ref", ",", "Na"}], "]"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{
              SubscriptBox["\[Theta]", "ab"], "[", 
              RowBox[{"ref", ",", "Na"}], "]"}]}]}], "]"}]}], ";", 
         RowBox[{"bivec", "=", 
          RowBox[{"wedge", "[", 
           RowBox[{"ref", ",", "Na"}], "]"}]}], ";", 
         RowBox[{"dualbivec1Norm", "=", 
          RowBox[{"bivec", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"1", "/", "2"}], 
              RowBox[{"Tr", "[", 
               RowBox[{"bivec", ".", "bivec"}], "]"}]}], "]"}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"MatrixExp", "[", 
          RowBox[{"dihedrals", "*", 
           RowBox[{"bivec1tohalf", "[", "dualbivec1Norm", "]"}]}], "]"}]}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.912630015002988*^9, 3.912630059299903*^9}, 
   3.912630114228037*^9, {3.912630242734819*^9, 3.91263024446237*^9}, {
   3.9126302893512506`*^9, 3.91263030464042*^9}, {3.912630346416396*^9, 
   3.9126303657223053`*^9}, {3.912631882530876*^9, 3.912631979263629*^9}, 
   3.912632377185104*^9, {3.912633810291057*^9, 3.91263385599762*^9}, {
   3.912633890514735*^9, 3.912633910395425*^9}, {3.91263395316426*^9, 
   3.912633969959413*^9}, {3.912634429019952*^9, 3.912634429441826*^9}, {
   3.9126345304100323`*^9, 3.912634533124353*^9}, {3.9126346140798264`*^9, 
   3.912634676144763*^9}, {3.912634725128529*^9, 3.9126347275362787`*^9}, {
   3.912634818129078*^9, 3.9126348219520683`*^9}, {3.912634902674048*^9, 
   3.9126349137190037`*^9}, 3.912635087508821*^9, 3.912682980912747*^9, {
   3.912721667561998*^9, 3.912721670630354*^9}, {3.912721723096734*^9, 
   3.912721725059143*^9}, {3.912721872548065*^9, 3.9127219214519463`*^9}, 
   3.9127222068427687`*^9, {3.9127401529778547`*^9, 3.912740153266674*^9}, {
   3.912742585509302*^9, 3.912742585730879*^9}, {3.9127430015335283`*^9, 
   3.912743001948925*^9}, {3.912743519147334*^9, 3.912743519370672*^9}, 
   3.912744376028122*^9, {3.912807818663022*^9, 3.9128078252962933`*^9}, 
   3.912815964488103*^9, {3.9128225506504583`*^9, 3.9128225508935432`*^9}, 
   3.912823490301272*^9, 3.912824429181835*^9, 3.9128249062840843`*^9, {
   3.912825056254429*^9, 3.912825056667444*^9}, 3.91282516289828*^9, 
   3.912825708264538*^9, 3.9136107285382557`*^9},
 CellLabel->
  "In[519]:=",ExpressionUUID->"d4e73489-c2c8-4f3f-b5be-16b69128b530"]
}, Closed]],

Cell[CellGroupData[{

Cell["Get 3d edge vector and bivector of each face", "Subsection",
 CellChangeTimes->{{3.913692735793851*^9, 3.9136927617716312`*^9}, 
   3.913693250096222*^9},ExpressionUUID->"f09de286-1ed5-4523-b5dd-\
e31c47923b04"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Convert", " ", "4", "d", " ", "edge", " ", "vector", " ", "to", " ", "3", 
    "d", " ", "edge", " ", "vector", " ", "inside", " ", "each", " ", 
    "tetrahedron"}], ",", " ", 
   RowBox[{
   "the", " ", "zero", " ", "components", " ", "decide", " ", "the", " ", 
    "type", " ", "of", " ", "the", " ", 
    RowBox[{"tetrehedron", ".", " ", "Input"}], " ", "is", " ", "the", " ", 
    "4", "d", " ", "edge", " ", "vectors", " ", "and", " ", "SO", 
    RowBox[{"(", 
     RowBox[{"1", ",", "3"}], ")"}], " ", "solutions"}], ",", " ", 
   RowBox[{
   "and", " ", "output", " ", "is", " ", "the", " ", "3", "d", " ", "edge", 
    " ", "vectors", " ", "and", " ", "the", " ", "position", " ", "of", " ", 
    "0", " ", 
    RowBox[{"component", ".", " ", "Position"}], " ", "1", " ", "means", " ", 
    "spacelike", " ", "tetrahedron", " ", "and", " ", "4", " ", "means", " ", 
    "timelike", " ", 
    RowBox[{"tetrahedron", "."}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9125608075696573`*^9, 3.912561008749234*^9}},
 CellLabel->
  "In[520]:=",ExpressionUUID->"e37a33d6-cd9a-4fca-9f1a-1bee725ffbf8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"get3dtet", "[", 
   RowBox[{"tetlenthvec_", ",", "tetsol13_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tet3dvec$111", ",", "zeropos"}], "}"}], ",", 
    RowBox[{
     RowBox[{"tet3dvec$111", "=", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Inverse", "[", "tetsol13", "]"}], ".", "#"}], "&"}], "/@", 
        "tetlenthvec"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"zeropos", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"Chop", "@", 
          RowBox[{"Total", "[", 
           RowBox[{"Abs", "[", 
            RowBox[{"tet3dvec$111", "//", "N"}], "]"}], "]"}]}], ",", "0"}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "zeropos", "]"}], "===", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Drop", "[", "\[IndentingNewLine]", 
            RowBox[{"#", ",", "zeropos"}], "]"}], "&"}], "/@", 
          "tet3dvec$111"}], ",", "zeropos"}], "}"}], ",", "tet3dvec$111"}], 
      "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.912488323709654*^9, 3.91248842860709*^9, {3.912551894647078*^9, 
   3.912551895458172*^9}, 3.912635166071217*^9},
 CellLabel->
  "In[521]:=",ExpressionUUID->"ab3edbcb-efc2-4fa0-9441-c9909c65a896"],

Cell[BoxData[
 RowBox[{
  RowBox[{"get3dvec", "[", 
   RowBox[{"tetlenthvec_", ",", "tetsol13_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tet3dvec$111", ",", "zeropos"}], "}"}], ",", 
    RowBox[{
     RowBox[{"tet3dvec$111", "=", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Inverse", "[", "tetsol13", "]"}], ".", "#"}], "&"}], "/@", 
        "tetlenthvec"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "tet3dvec$111"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9137523886238003`*^9, 3.913752450766036*^9}, {
  3.913752489428727*^9, 3.913752490034945*^9}},
 CellLabel->
  "In[522]:=",ExpressionUUID->"b0065fcd-5728-4df0-b37d-b47edd488cc8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"threetofour", "[", 
   RowBox[{"n_", ",", "sgndet1_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sgndet1", ">", "0"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", "n"}], "]"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{"n", ",", 
      RowBox[{"{", "0", "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[523]:=",ExpressionUUID->"1b6fb8cf-213c-4f02-921b-f49194e31240"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getbivec", "[", 
   RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"1", "/", "2"}], " ", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"LeviCivitaTensor", "[", "4", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Eta]", ".", "n1"}], ")"}], "[", 
          RowBox[{"[", "k", "]"}], "]"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Eta]", ".", "n2"}], ")"}], "[", 
          RowBox[{"[", "l", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ".", 
    "\[Eta]"}]}]}]], "Input",
 CellChangeTimes->{{3.887041714754881*^9, 3.887041714757712*^9}},
 CellLabel->
  "In[524]:=",ExpressionUUID->"abb98497-aa98-4bb1-b2cd-95aedf866e7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getbivec2d", "[", 
   RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bivect4d", ",", "bdybivec55"}], "}"}], ",", 
    RowBox[{
     RowBox[{"bivect4d", "=", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"LeviCivitaTensor", "[", "4", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Eta]", ".", "n1"}], ")"}], "[", 
              RowBox[{"[", "k", "]"}], "]"}], " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Eta]", ".", "n2"}], ")"}], "[", 
              RowBox[{"[", "l", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ".", 
        "\[Eta]"}]}]}], ";", 
     RowBox[{"bdybivec55", "=", 
      RowBox[{"bivect4d", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", 
          RowBox[{"Tr", "[", 
           RowBox[{"bivect4d", ".", "bivect4d"}], "]"}]}], "]"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"bivec1tohalf", "[", "bdybivec55", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.913755976637484*^9, 3.913756000410068*^9}, {
  3.913756036090371*^9, 3.91375609133147*^9}},
 CellLabel->
  "In[525]:=",ExpressionUUID->"27eeaa4a-7cdd-4fa4-891b-2d5f98c4aefc"]
}, Closed]],

Cell[CellGroupData[{

Cell["SU(2) solution", "Subsection",
 CellChangeTimes->{{3.912575820443112*^9, 
  3.912575832698098*^9}},ExpressionUUID->"a6296958-32d9-4b6f-aa49-\
c26ef71b9613"],

Cell[BoxData[
 RowBox[{
  RowBox[{"soleqssu2", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Su2", ",", "a1", ",", "a2", ",", "b1", ",", "b2", ",", "eqns1", ",", 
       "eqns2", ",", "solnAll", ",", "solnAll2", ",", "a1sol"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Su2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a1", ",", 
           RowBox[{
            RowBox[{"-", "b1"}], "+", 
            RowBox[{"I", " ", "b2"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"b1", "+", 
            RowBox[{"I", " ", "b2"}]}], ",", "a1"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"eqns1", "=", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], ",", 
              RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"ExpandAll", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Su2", ".", 
                RowBox[{"PauliMatrix", "[", "3", "]"}], ".", 
                RowBox[{"Inverse", "[", "Su2", "]"}]}], "-", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"ee", ",", "ff", ",", "gg"}], "}"}], "*", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"PauliMatrix", "[", "i", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
                "]"}]}], "/.", 
              RowBox[{
               RowBox[{"Det", "[", "Su2", "]"}], "->", "1"}]}], "]"}], 
            "]"}]}], ",", 
          RowBox[{"_", "\[Element]", "Reals"}]}], "]"}], "//", "Flatten"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"solnAll", "=", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Simplify", "[", 
              RowBox[{"Thread", "[", 
               RowBox[{"eqns1", "==", "0"}], "]"}], "]"}], "]"}], ",", 
            "True"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"a1", ",", "b1", ",", "b2"}], "}"}]}], "]"}], "//", 
        "Quiet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solnAll2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"solnAll", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"FullSimplify", "[", 
                 RowBox[{
                  RowBox[{"Det", "[", "Su2", "]"}], "/.", "#"}], "]"}], "/.", 
                
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["ee", "2"], "+", 
                   SuperscriptBox["ff", "2"], "+", 
                   SuperscriptBox["gg", "2"]}], "->", "1"}], ")"}]}], ")"}], "==",
               "1"}], ")"}], "&"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["ee", "2"], "+", 
           SuperscriptBox["ff", "2"], "+", 
           SuperscriptBox["gg", "2"]}], "->", "1"}], ")"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9179686135323133`*^9, 3.917968625096169*^9}, {
   3.917968659793709*^9, 3.917968765222598*^9}, 3.9179688511486692`*^9},
 CellLabel->
  "In[526]:=",ExpressionUUID->"63291a80-32df-4db9-8c1e-67e8168abee3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getsu2frombivec", "[", 
   RowBox[{"bivec_", ",", "sgndet_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"normals3d", ",", "su2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"normals3d", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ee", ",", "ff", ",", "gg"}], "}"}], "->", 
        RowBox[{"Re", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Tr", "[", 
            RowBox[{"bivec", ".", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"PauliMatrix", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"su2", "=", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Chop", "@", 
          RowBox[{"N", "[", 
           RowBox[{"(", 
            RowBox[{"gg", "/.", " ", "normals3d"}], ")"}], "]"}]}], "==", 
         "1"}], ",", 
        RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
        RowBox[{
         RowBox[{"Chop", "@", 
          RowBox[{"N", "[", 
           RowBox[{"(", 
            RowBox[{"gg", "/.", " ", "normals3d"}], ")"}], "]"}]}], "==", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"I", "*", 
         RowBox[{"PauliMatrix", "[", "2", "]"}]}], ",", "True", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a1", ",", 
             RowBox[{
              RowBox[{"-", "b1"}], "+", 
              RowBox[{"I", " ", "b2"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"b1", "+", 
              RowBox[{"I", " ", "b2"}]}], ",", "a1"}], "}"}]}], "}"}], "/.", 
         RowBox[{"(", 
          RowBox[{"soleqssu2", "/.", "normals3d"}], ")"}]}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.887041728976067*^9, 3.8870417289788094`*^9}, {
   3.91257500879088*^9, 3.91257501189751*^9}, {3.912575065253553*^9, 
   3.912575233090907*^9}, {3.9125753681812477`*^9, 3.912575381689077*^9}, {
   3.912575423336088*^9, 3.912575502543325*^9}, {3.912575554594562*^9, 
   3.912575628282737*^9}, {3.9127433802199*^9, 3.912743419978079*^9}, {
   3.9127434616929407`*^9, 3.912743463332294*^9}, {3.917968865864416*^9, 
   3.917968868426937*^9}, 3.917970388248678*^9},
 CellLabel->
  "In[527]:=",ExpressionUUID->"17d05ce5-41fc-454f-aa06-be9bf29ec20e"]
}, Closed]],

Cell[CellGroupData[{

Cell["SU(1,1) solution to spacelike face", "Subsection",
 CellChangeTimes->{{3.912575820443112*^9, 
  3.912575862024135*^9}},ExpressionUUID->"aa84edbf-57ea-4960-a7c1-\
05be3704ce5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"soleqssu11", "[", "xisign_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Su11", ",", "a1", ",", "a2", ",", "b1", ",", "b2", ",", "eqns1", ",", 
      "eqns2", ",", "solnAll", ",", "solnAll2", ",", "a1sol"}], "}"}], ",", 
    RowBox[{
     RowBox[{"Su11", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a1", ",", 
          RowBox[{"b1", "+", 
           RowBox[{"I", " ", "b2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"b1", "-", 
           RowBox[{"I", " ", "b2"}]}], ",", "a1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqns1", "=", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Re", "[", "#", "]"}], ",", 
             RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"ExpandAll", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Su11", ".", 
               RowBox[{"PauliMatrix", "[", "3", "]"}], ".", 
               RowBox[{"Inverse", "[", "Su11", "]"}]}], "-", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ee", ",", "ff", ",", "gg"}], "}"}], "*", "xisign", 
                "*", "su11sigma"}], "]"}]}], "/.", 
             RowBox[{
              RowBox[{"Det", "[", "Su11", "]"}], "->", "1"}]}], "]"}], 
           "]"}]}], ",", 
         RowBox[{"_", "\[Element]", "Reals"}]}], "]"}], "//", "Flatten"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"solnAll", "=", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Simplify", "[", 
             RowBox[{"Thread", "[", 
              RowBox[{"eqns1", "==", "0"}], "]"}], "]"}], "]"}], ",", 
           "True"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"a1", ",", "b1", ",", "b2"}], "}"}]}], "]"}], "//", 
       "Quiet"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"solnAll2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"solnAll", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"FullSimplify", "[", 
               RowBox[{
                RowBox[{"Det", "[", "Su11", "]"}], "/.", "#"}], "]"}], "/.", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["gg", "2"], "->", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", 
                 SuperscriptBox["ff", "2"], "+", 
                 SuperscriptBox["ee", "2"]}]}], ")"}]}], ")"}], "==", "1"}], 
           "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "/.", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["ee", "2"], "-", 
          SuperscriptBox["ff", "2"], "-", 
          SuperscriptBox["gg", "2"]}], "->", "1"}], ")"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.912565874324044*^9, 3.9125661025785522`*^9}, {
   3.912566153966275*^9, 3.91256624058572*^9}, {3.912568438989175*^9, 
   3.9125684521346684`*^9}, {3.912568847524167*^9, 3.912568850004766*^9}, {
   3.9125689093921223`*^9, 3.912568959837235*^9}, 3.912569008563364*^9, {
   3.912569102267418*^9, 3.912569146498353*^9}, {3.912569195123001*^9, 
   3.9125692021823187`*^9}, 3.912569255603835*^9, {3.912569291055154*^9, 
   3.91256949285316*^9}, {3.912569541083088*^9, 3.912569688273484*^9}, {
   3.912569830476606*^9, 3.9125698774806633`*^9}, {3.912569927037668*^9, 
   3.912569995367104*^9}, {3.912570104840706*^9, 3.912570140158474*^9}, {
   3.912570180865185*^9, 3.912570213808887*^9}, {3.9125702902847*^9, 
   3.912570342574086*^9}, {3.912570693532545*^9, 3.9125707904653378`*^9}, {
   3.912570856596939*^9, 3.9125709065389423`*^9}, {3.912570954808618*^9, 
   3.912571013829187*^9}, {3.912571123073306*^9, 3.912571202603201*^9}, {
   3.912571249313224*^9, 3.9125712899101553`*^9}, {3.91257136388277*^9, 
   3.9125714793788853`*^9}, {3.912571520978621*^9, 3.912571592617115*^9}, {
   3.912571782713852*^9, 3.9125718109377947`*^9}, {3.912571874268615*^9, 
   3.912571880675563*^9}, {3.912571931010309*^9, 3.91257202524657*^9}, {
   3.912572347183832*^9, 3.912572382614678*^9}, {3.912572837317424*^9, 
   3.912572845326089*^9}, {3.9125752705426693`*^9, 3.9125753249549427`*^9}, 
   3.9125758066784267`*^9, {3.9125758663942137`*^9, 3.9125759156559277`*^9}, {
   3.912576047628824*^9, 3.912576134276772*^9}, {3.912576166706217*^9, 
   3.912576231103031*^9}, {3.912576376182724*^9, 3.912576396916342*^9}, {
   3.9125764337183857`*^9, 3.9125764461621923`*^9}, {3.91257652036226*^9, 
   3.9125765479832277`*^9}, 3.912577073544414*^9, {3.912578200944716*^9, 
   3.9125782020022097`*^9}, {3.912578407321582*^9, 3.9125784546390047`*^9}, {
   3.917968945700494*^9, 3.917969039588876*^9}, 3.917969097206401*^9, {
   3.9179693075297527`*^9, 3.9179693099609833`*^9}},
 CellLabel->
  "In[528]:=",ExpressionUUID->"a139b93c-590c-400d-be35-d89a5f8743b9"]
}, Closed]],

Cell[CellGroupData[{

Cell["SU(1,1) solution to timelike face", "Subsection",
 CellChangeTimes->{{3.912575820443112*^9, 3.912575862024135*^9}, {
  3.91257904854494*^9, 
  3.9125790489934187`*^9}},ExpressionUUID->"9a23a412-000a-4e42-8f59-\
67652ad5d5e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"soleqtsu11", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Su11", ",", "a1", ",", "a2", ",", "b1", ",", "b2", ",", "eqns1", ",", 
       "eqns2", ",", "solnAll", ",", "solnAll2", ",", "a1sol"}], "}"}], ",", 
     RowBox[{
      RowBox[{"Su11", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a1", "+", 
            RowBox[{"I", " ", "a2"}]}], ",", 
           RowBox[{"I", " ", "b2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "I"}], " ", "b2"}], ",", 
           RowBox[{"a1", "-", 
            RowBox[{"I", " ", "a2"}]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eqns1", "=", 
       RowBox[{
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Re", "[", "#", "]"}], ",", 
              RowBox[{"Im", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"ExpandAll", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Su11", ".", 
                RowBox[{"(", 
                 RowBox[{"I", "*", 
                  RowBox[{"PauliMatrix", "[", "1", "]"}]}], ")"}], ".", 
                RowBox[{"Inverse", "[", "Su11", "]"}]}], "-", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"ee", ",", "ff", ",", "gg"}], "}"}], "*", 
                 "su11sigma"}], "]"}]}], "/.", 
              RowBox[{
               RowBox[{"Det", "[", "Su11", "]"}], "->", "1"}]}], "]"}], 
            "]"}]}], ",", 
          RowBox[{"_", "\[Element]", "Reals"}]}], "]"}], "//", "Flatten"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"solnAll", "=", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Simplify", "[", 
              RowBox[{"Thread", "[", 
               RowBox[{"eqns1", "==", "0"}], "]"}], "]"}], "]"}], ",", 
            "True"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"a1", ",", "a2", ",", "b2"}], "}"}]}], "]"}], "//", 
        "Quiet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solnAll2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"solnAll", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"FullSimplify", "[", 
                RowBox[{
                 RowBox[{"Det", "[", "Su11", "]"}], "/.", "#"}], "]"}], "/.", 
               
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["ee", "2"], "->", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["ff", "2"], "+", 
                  SuperscriptBox["gg", "2"]}]}], ")"}]}], ")"}], "==", "1"}], 
            "&"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["ee", "2"]}], "+", 
           SuperscriptBox["ff", "2"], "+", 
           SuperscriptBox["gg", "2"]}], "->", "1"}], ")"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9179693986769753`*^9, 3.9179694377177277`*^9}, {
  3.917969475965274*^9, 3.917969477583968*^9}},
 CellLabel->
  "In[529]:=",ExpressionUUID->"42253e32-a5df-434b-86dc-2d8a2d175084"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getsu11frombivec", "[", 
   RowBox[{"bivec_", ",", "tetareasign_", ",", "tetn0sign_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"soleqs", ",", "soleqt", ",", "normals3d"}], "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"tetareasign", ">", "0"}], ",", 
        RowBox[{"soleqs", "=", 
         RowBox[{"soleqssu11", "[", "tetn0sign", "]"}]}], ",", 
        RowBox[{"soleqt", "=", "soleqtsu11"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"normals3d", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ee", ",", "ff", ",", "gg"}], "}"}], "->", 
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Tr", "[", 
             RowBox[{"bivec", ".", "#"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PauliMatrix", "[", "3", "]"}], ",", 
             RowBox[{
              RowBox[{"-", "I"}], "*", 
              RowBox[{"PauliMatrix", "[", "1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "I"}], "*", 
              RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], "}"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"tetareasign", ">", "0"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Chop", "@", 
            RowBox[{"N", "[", 
             RowBox[{"(", 
              RowBox[{"ee", "/.", "normals3d"}], ")"}], "]"}]}], "==", 
           "tetn0sign"}], ",", 
          RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a1", ",", 
               RowBox[{"b1", "+", 
                RowBox[{"I", " ", "b2"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"b1", "-", 
                RowBox[{"I", " ", "b2"}]}], ",", "a1"}], "}"}]}], "}"}], "/.",
            " ", 
           RowBox[{"(", 
            RowBox[{"soleqs", "/.", "normals3d"}], " ", ")"}]}]}], "]"}], ",", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Chop", "@", 
            RowBox[{"N", "[", 
             RowBox[{"(", 
              RowBox[{"ff", "/.", "normals3d"}], ")"}], "]"}]}], "==", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{"I", "*", 
           RowBox[{"PauliMatrix", "[", "3", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Chop", "@", 
            RowBox[{"N", "[", 
             RowBox[{"(", 
              RowBox[{"ff", "/.", "normals3d"}], ")"}], "]"}]}], "==", "1"}], 
          ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "-", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "gg"}], "2"]}], ",", 
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "ee"}], "2"]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "ee"}], "2"], ",", 
               RowBox[{"1", "+", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "gg"}], "2"]}]}], "}"}]}], 
            "}"}], "/.", "normals3d"}], " ", ",", "True", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"a1", "+", 
                RowBox[{"I", " ", "a2"}]}], ",", 
               RowBox[{"I", " ", "b2"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "I"}], " ", "b2"}], ",", 
               RowBox[{"a1", "-", 
                RowBox[{"I", " ", "a2"}]}]}], "}"}]}], "}"}], "/.", " ", 
           RowBox[{"(", 
            RowBox[{"soleqt", "/.", "normals3d"}], " ", ")"}]}]}], "]"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.91257681864852*^9, 3.912576913309266*^9}, {
   3.912576947510675*^9, 3.912577012816457*^9}, {3.912577106802128*^9, 
   3.912577110066409*^9}, {3.912577195622929*^9, 3.912577223339163*^9}, {
   3.91257728749341*^9, 3.912577461634322*^9}, {3.912578209785211*^9, 
   3.912578250157999*^9}, {3.9125785029105883`*^9, 3.912578511279516*^9}, {
   3.9125785455407143`*^9, 3.912578555120366*^9}, {3.9125785887600937`*^9, 
   3.9125786444506283`*^9}, {3.912578797411187*^9, 3.9125788048409357`*^9}, {
   3.9125789378998833`*^9, 3.9125789426361103`*^9}, {3.9125834879388123`*^9, 
   3.912583504620996*^9}, {3.912583542214549*^9, 3.912583581952179*^9}, {
   3.912584060020699*^9, 3.9125840857515297`*^9}, 3.9125843360904427`*^9, 
   3.912584559097149*^9, {3.9127422255906773`*^9, 3.912742305851346*^9}, {
   3.9127424322609463`*^9, 3.912742434186421*^9}, {3.9127438853886137`*^9, 
   3.912743892413322*^9}, 3.912743975577271*^9, {3.912744058016158*^9, 
   3.912744058259163*^9}, {3.912744100360608*^9, 3.912744115080934*^9}, {
   3.912809958797604*^9, 3.912809966362883*^9}, {3.912812170784347*^9, 
   3.912812183588037*^9}, {3.912812541777052*^9, 3.912812544936578*^9}, {
   3.917969495948824*^9, 3.9179695077376833`*^9}},
 CellLabel->
  "In[530]:=",ExpressionUUID->"ad124562-c0e8-4ed2-8c16-a6513a76dee2"]
}, Closed]],

Cell[CellGroupData[{

Cell["boundary SU matrix", "Subsection",
 CellChangeTimes->{{3.912637905262457*^9, 3.9126379103290663`*^9}, 
   3.9126380310883417`*^9, {3.9136691366038933`*^9, 3.913669138980564*^9}, {
   3.918049535744689*^9, 
   3.9180495497642107`*^9}},ExpressionUUID->"c3792b50-7537-4d87-b1c2-\
92db99c9dcc6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getsufrombivec", "[", 
   RowBox[{"bivec_", ",", "sgndet_", ",", "tetareasign_", ",", "tetn0sign_"}],
    "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sgndet", ">", "0"}], ",", 
    RowBox[{"getsu2frombivec", "[", 
     RowBox[{"bivec", ",", "sgndet"}], "]"}], ",", 
    RowBox[{"getsu11frombivec", "[", 
     RowBox[{"bivec", ",", "tetareasign", ",", "tetn0sign"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9125635377986917`*^9, 3.9125635529155293`*^9}, 
   3.9125637071909943`*^9, {3.9125846929701242`*^9, 3.912584757926693*^9}, 
   3.912584836950274*^9},
 CellLabel->
  "In[531]:=",ExpressionUUID->"fd5684e4-afd7-4892-ba1c-2f598a6df4ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getxifromsu", "[", 
   RowBox[{"hsu_", ",", "sgndet_", ",", "facesign_", ",", "tetsign0_"}], 
   "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sgndet", ">", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"hsu", ".", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ",", 
      RowBox[{"hsu", ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"facesign", ">", "0"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"tetsign0", ">", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"hsu", ".", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ",", 
          RowBox[{"hsu", ".", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"hsu", ".", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], ",", 
          RowBox[{"hsu", ".", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"hsu", ".", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], 
         SqrtBox["2"]], ",", 
        FractionBox[
         RowBox[{"hsu", ".", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], 
         SqrtBox["2"]]}], "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9125849923196383`*^9, 3.9125850868424683`*^9}, {
  3.9126559186211*^9, 3.912655957220346*^9}},
 CellLabel->
  "In[532]:=",ExpressionUUID->"34f77bf4-2a3f-4f16-b9d0-0efeb8b90048"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getnabfrombivec", "[", 
   RowBox[{"bivec_", ",", "sgndet_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sgndet", "==", "1"}], ",", 
    RowBox[{"Re", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"bivec", ".", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"Re", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"bivec", ".", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", 
        RowBox[{
         RowBox[{"-", "I"}], "*", 
         RowBox[{"PauliMatrix", "[", "1", "]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "I"}], "*", 
         RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9126379206285343`*^9, 3.912637946433258*^9}, {
   3.9126379925279016`*^9, 3.912638025105229*^9}, {3.912638082965016*^9, 
   3.912638087831596*^9}, {3.912638133454974*^9, 3.912638151379293*^9}, {
   3.914124852570891*^9, 3.914124852799799*^9}, 3.9141260330125732`*^9},
 CellLabel->
  "In[533]:=",ExpressionUUID->"6d6b2e42-3253-47da-b7fa-99722b16c4a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["boundary outgoing face normals", "Subsection",
 CellChangeTimes->{{3.912637905262457*^9, 3.9126379103290663`*^9}, 
   3.9126380310883417`*^9, {3.914038880655052*^9, 3.914038883065309*^9}, {
   3.9180495434984703`*^9, 
   3.918049544825921*^9}},ExpressionUUID->"8bbf9c70-fe4d-4871-891b-\
2c1270967f2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getvertices3d", "[", 
   RowBox[{"tetpoints_", ",", "tetsol13_", ",", "sgndet_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"TetPoints4d", ",", "TetPoints"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TetPoints4d", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Inverse", "[", "tetsol13", "]"}], ".", "#"}], "&"}], "/@", 
       "tetpoints"}]}], ";", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"sgndet", "==", "1"}], ",", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"FullSimplify", "[", "#", "]"}], ",", "1"}], "]"}], ",", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"FullSimplify", "[", "#", "]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], "]"}], "&"}], "/@", 
      "TetPoints4d"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.913923910679748*^9, 3.913924045315235*^9}, {
   3.9140284437103777`*^9, 3.914028513595098*^9}, {3.91402875169433*^9, 
   3.914028756111732*^9}, {3.9140288347789173`*^9, 3.9140289104222307`*^9}, {
   3.914028947093068*^9, 3.9140289744328337`*^9}, {3.9140290143095417`*^9, 
   3.914029057029937*^9}, {3.914033302278017*^9, 3.91403332161305*^9}, {
   3.914033479688076*^9, 3.914033480097864*^9}, 3.914033510115162*^9, {
   3.914033557842154*^9, 3.91403355903156*^9}, {3.914033604415831*^9, 
   3.9140336443745947`*^9}, 3.9140336819845457`*^9, {3.914034046652459*^9, 
   3.914034054112628*^9}, 3.914034123324985*^9, {3.9140351204994993`*^9, 
   3.914035123987549*^9}, {3.914035928832425*^9, 3.914035933233951*^9}, 
   3.91403600476468*^9},
 CellLabel->
  "In[534]:=",ExpressionUUID->"9cc1778a-0d30-4cea-9a35-ea5c5d243b9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getnabout", "[", 
   RowBox[{"Tetbdypoints_", ",", "sgndet_", ",", "so13soln_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "edgeor", ",", "edgevec", ",", "metric", ",", "unsignnormalvec$111", ",",
       "tetareasign", ",", "vertices3d", ",", "centers", ",", "randompoints", 
      ",", "randompoints1", ",", "randomvec", ",", "lineareqns", ",", 
      "solntest", ",", "pos", ",", "sign", ",", "a1", ",", "a2", ",", "a3", 
      ",", "a4", ",", "randompoinsall"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vertices3d", "=", 
      RowBox[{"getvertices3d", "[", 
       RowBox[{"Tetbdypoints", ",", "so13soln", ",", "sgndet"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"edgeor", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"faceor", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"faceor", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edgevec", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"vertices3d", "[", 
             RowBox[{"[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
            RowBox[{"vertices3d", "[", 
             RowBox[{"[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
         RowBox[{"edgeor", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "@", "edgeor"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"metric", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sgndet", "==", "1"}], ",", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "edgeor"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"unsignnormalvec$111", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "b", ",", "c"}], "}"}], "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b", ",", "c"}], "}"}], ".", 
                 RowBox[{"metric", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], "]"}]}], 
             "/.", " ", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"a", ",", "b", ",", "c"}], "}"}], ".", 
                    RowBox[{"metric", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ".", "#"}], "&"}], "/@", 
                   RowBox[{"edgevec", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ")"}], "==", 
                 "0"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}]}], "//", 
            "Flatten"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", ">", "0"}], ",", 
              RowBox[{"b", ">", "0"}], ",", 
              RowBox[{"c", ">", "0"}]}], "}"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "edgevec"}]}], "}"}]}], "]"}], "//", 
       "Quiet"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tetareasign", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"unsignnormalvec$111", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ".", 
          RowBox[{"metric", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ".", 
          RowBox[{"unsignnormalvec$111", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "unsignnormalvec$111"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"centers", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Total", "[", "#", "]"}], "/", 
          RowBox[{"Length", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
       RowBox[{"Subsets", "[", 
        RowBox[{"vertices3d", ",", 
         RowBox[{"{", "3", "}"}]}], "]"}]}]}], ";", 
     RowBox[{"randompoints", "=", 
      RowBox[{"centers", "+", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "2"}]], "*", "unsignnormalvec$111"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"randompoints1", "=", 
      RowBox[{"centers", "-", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "2"}]], "*", "unsignnormalvec$111"}]}]}], ";", 
     RowBox[{"randompoinsall", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"randompoints", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"randompoints1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "randompoints"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pos", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"solntest", "=", 
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Thread", "[", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], 
                    "*", "vertices3d"}], "]"}], "==", 
                  RowBox[{"randompoinsall", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"a1", "+", "a2", "+", "a3", "+", "a4"}], "==", 
                  "1"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}]}], 
             "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"And", "@@", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], "/.", 
                  RowBox[{"solntest", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ">=", "0"}], 
               "]"}]}], ",", 
             RowBox[{"Unevaluated", "[", 
              RowBox[{"Sequence", "[", "]"}], "]"}], ",", "j"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "randompoinsall"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"sign", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "==", "2"}], ",", 
          RowBox[{"-", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "pos"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"sign", "*", "unsignnormalvec$111"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9140636828455343`*^9, 3.914063685695695*^9}, {
   3.9140637642349157`*^9, 3.9140637904797792`*^9}, 3.914063829380743*^9, 
   3.9141044388575163`*^9, {3.914104688655499*^9, 3.914104748002933*^9}, {
   3.9141049295700912`*^9, 3.914104939550742*^9}, {3.914105897713976*^9, 
   3.914105903662757*^9}, 3.914106313566566*^9, {3.914106594403096*^9, 
   3.914106597792745*^9}, {3.914106640309793*^9, 3.914106808972028*^9}, {
   3.914106840128025*^9, 3.914106968291666*^9}, {3.914107280677762*^9, 
   3.914107285313633*^9}, 3.914124858878208*^9, 3.9141249553658333`*^9, {
   3.914125040337455*^9, 3.914125091137412*^9}, {3.9141251551301622`*^9, 
   3.9141251795396633`*^9}, {3.9141253823059797`*^9, 3.914125505605804*^9}, 
   3.918392683764069*^9, {3.91839315031066*^9, 3.9183931514617662`*^9}, {
   3.918393276092169*^9, 3.918393276430615*^9}},
 CellLabel->
  "In[535]:=",ExpressionUUID->"dfa6c960-0ef1-4dba-a5f0-6679c1b692c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getnabfrombivec", "[", 
   RowBox[{"bivec_", ",", "sgndet_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sgndet", "==", "1"}], ",", 
    RowBox[{"Re", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"bivec", ".", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"Re", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"bivec", ".", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PauliMatrix", "[", "3", "]"}], ",", 
        RowBox[{"I", "*", 
         RowBox[{"PauliMatrix", "[", "2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "I"}], "*", 
         RowBox[{"PauliMatrix", "[", "1", "]"}]}]}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9126379206285343`*^9, 3.912637946433258*^9}, {
   3.9126379925279016`*^9, 3.912638025105229*^9}, {3.912638082965016*^9, 
   3.912638087831596*^9}, {3.912638133454974*^9, 3.912638151379293*^9}, {
   3.914124852570891*^9, 3.914124852799799*^9}, 3.9141260330125732`*^9, {
   3.914127173069153*^9, 3.914127182987349*^9}, {3.914127793497933*^9, 
   3.914127824994742*^9}, {3.914127938054015*^9, 3.914127985663249*^9}},
 CellLabel->
  "In[536]:=",ExpressionUUID->"8e96711a-94e9-4572-8113-1ae11693f52a"]
}, Closed]],

Cell[CellGroupData[{

Cell["main functions", "Subsection",
 CellChangeTimes->{{3.912575820443112*^9, 3.912575862024135*^9}, {
  3.91257904854494*^9, 3.9125790489934187`*^9}, {3.9126369360718813`*^9, 
  3.912636962916209*^9}, {3.914132335268897*^9, 
  3.9141323388901463`*^9}},ExpressionUUID->"545a340a-5527-427c-988a-\
b9cc8a7be66d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getsolution", "[", "bdypoints_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ll$111", "=", 
       RowBox[{"Length", "[", "bdypoints", "]"}]}], ",", "edgevec", ",", 
      "tetnormalvec", ",", "solgsl2c", ",", "solgso13", ",", "threededgevec", 
      ",", "sgndet", ",", "areasquare", ",", "triangleV", ",", "ls", ",", 
      "threeto4dedgevec", ",", "bdybivec", ",", "bdybivec55", ",", 
      "bdybivec55s", ",", "nabfrombivec", ",", "tetareasign", ",", 
      "tetn0sign", ",", "bdysu", ",", "bdyxi", ",", "Tetbdypoints", ",", 
      "nabout", ",", "areas", ",", "sgn", ",", "kappatest1", ",", "kappa", 
      ",", "kappatest2", ",", "threeto4dtetfacenormal"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"edgevec", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"bdypoints", "[", 
             RowBox[{"[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "-", 
            RowBox[{"bdypoints", "[", 
             RowBox[{"[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
         RowBox[{"edgeor", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tetnormalvec", "=", 
      RowBox[{"get4dnormal", "[", "bdypoints", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"solgso13", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"getso13", "[", 
         RowBox[{"tetnormalvec", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solgsl2c", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"getsl2c", "[", 
         RowBox[{"tetnormalvec", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"threededgevec", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"get3dtet", "[", 
           RowBox[{
            RowBox[{"edgevec", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"solgso13", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sgndet", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"get3dtet", "[", 
               RowBox[{
                RowBox[{"edgevec", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"solgso13", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ")"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}], "==", "4"}], ",", 
          
          RowBox[{"-", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"areasquare", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "==", "j"}], ",", "0", ",", 
          RowBox[{
           RowBox[{"triangleV", "=", 
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"edgeor", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"edgeor", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
           RowBox[{"ls", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"DistanceSquare", "[", 
               RowBox[{
                RowBox[{"bdypoints", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"bdypoints", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
              "&"}], "/@", "triangleV"}]}], ";", 
           RowBox[{"V2sq", "[", "ls", "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "bdypoints"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "@", "bdypoints"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tetareasign", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sgndet", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "==", "1"}], ",", "1", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"areasquare", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "k"}], "]"}], "]"}], "<", "0"}], ",", 
              RowBox[{"-", "1"}], ",", "1"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "ll$111"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"areas", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Abs", "[", "areasquare", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"threeto4dedgevec", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"threetofour", "[", 
           RowBox[{"#", ",", 
            RowBox[{"sgndet", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"threededgevec", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bdybivec", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"getbivec", "[", 
           RowBox[{
            RowBox[{"threeto4dedgevec", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"threeto4dedgevec", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
          "&"}], "/@", "etof"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bdybivec55", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"1", "/", "2"}], " ", 
                RowBox[{"Tr", "[", 
                 RowBox[{"#", ".", "#"}], "]"}]}], "]"}], "]"}]}], "&"}], "/@", 
           RowBox[{"bdybivec", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Jvec", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bdybivec55s", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"bivec1tohalf", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"bdybivec55", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"nabfrombivec", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"getnabfrombivec", "[", 
            RowBox[{"#", ",", 
             RowBox[{"sgndet", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"bdybivec55s", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "ll$111"}], "}"}]}], "]"}], "//", 
       "FullSimplify"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"tetn0sign", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sgndet", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "==", "1"}], ",", "1", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"tetareasign", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "==", 
             RowBox[{"-", "1"}]}], ",", "1", ",", 
            RowBox[{"Sign", "[", 
             RowBox[{"Chop", "[", 
              RowBox[{"N", "[", 
               RowBox[{"Tr", "[", 
                RowBox[{
                 RowBox[{"bdybivec55s", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], ".", 
                 RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}], "]"}], 
              "]"}], "]"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll$111"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bdysu", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"getsufrombivec", "[", 
         RowBox[{
          RowBox[{"bdybivec55s", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"sgndet", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"tetareasign", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"tetn0sign", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll$111"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bdyxi", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"getxifromsu", "[", 
         RowBox[{
          RowBox[{"bdysu", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"sgndet", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"tetareasign", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"tetn0sign", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll$111"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Tetbdypoints", "=", 
      RowBox[{"Subsets", "[", 
       RowBox[{"bdypoints", ",", 
        RowBox[{"{", "4", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nabout", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Insert", "[", 
          RowBox[{
           RowBox[{"getnabout", "[", 
            RowBox[{
             RowBox[{"Tetbdypoints", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"sgndet", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"solgso13", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "k"}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"k", ",", "ll$111"}], "}"}]}], "]"}], "//", 
       "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"threeto4dtetfacenormal", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"threetofour", "[", 
           RowBox[{"#", ",", 
            RowBox[{"sgndet", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "&"}], "/@", 
         RowBox[{"nabout", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"kappatest1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "==", "i"}], ",", "0", ",", 
          RowBox[{
           RowBox[{"Sign", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"tetareasign", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", "i"}], "]"}], "]"}], "*", 
                 RowBox[{"nabout", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", "i"}], "]"}], "]"}]}], "//", "Chop"}], 
               ",", "0"}], "]"}], "/", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nabfrombivec", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "i"}], "]"}], "]"}], "//", "Chop"}], ",", 
               "0"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "ll$111"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ll$111"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"kappa", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"kappatest1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"kappatest1", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kappatest1", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "/", 
             RowBox[{"kappatest1", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", "ll$111"}], "}"}]}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "solgsl2c", ",", "bdyxi", ",", "bdysu", ",", "bdybivec55s", ",", 
       "areas", ",", "kappa", ",", "nabout", ",", "solgso13", ",", 
       "threeto4dtetfacenormal", ",", "tetnormalvec", ",", "edgevec", ",", 
       "bdybivec55", ",", "nabfrombivec", ",", "sgndet", ",", "tetn0sign", 
       ",", "tetareasign"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9125516302036667`*^9, 3.91255181880506*^9}, {
   3.912551857132135*^9, 3.91255185796084*^9}, {3.9125607965644283`*^9, 
   3.912560797721815*^9}, {3.912561048421623*^9, 3.91256106423313*^9}, {
   3.91256133661734*^9, 3.912561429580164*^9}, {3.9125633348137217`*^9, 
   3.912563355021326*^9}, {3.912563395251088*^9, 3.912563422870075*^9}, {
   3.912563478097875*^9, 3.912563510295629*^9}, {3.912563713188054*^9, 
   3.912563740652287*^9}, {3.9125637789615793`*^9, 3.9125638449643173`*^9}, {
   3.912563947404388*^9, 3.912563953009391*^9}, {3.912563999476039*^9, 
   3.912564070961602*^9}, {3.912564105210853*^9, 3.912564134992941*^9}, 
   3.912565328262726*^9, 3.912565361611086*^9, {3.91256540406413*^9, 
   3.91256547824543*^9}, {3.9125655104665956`*^9, 3.912565567293481*^9}, {
   3.912565603989973*^9, 3.9125656094798594`*^9}, {3.912565652367138*^9, 
   3.912565657121285*^9}, {3.9125657127557087`*^9, 3.912565724479187*^9}, {
   3.912567445443645*^9, 3.912567446006105*^9}, {3.912567489659355*^9, 
   3.912567490921423*^9}, 3.912568135204174*^9, {3.9125682299378643`*^9, 
   3.912568232550359*^9}, {3.912577488744338*^9, 3.912577499353734*^9}, {
   3.91257788935037*^9, 3.9125780037790937`*^9}, {3.9125780402929983`*^9, 
   3.9125780897795477`*^9}, {3.912584644947152*^9, 3.912584646069643*^9}, {
   3.91258477332292*^9, 3.912584788250437*^9}, {3.912584851918065*^9, 
   3.912584872684071*^9}, {3.912585107615402*^9, 3.912585122082734*^9}, {
   3.912586875288859*^9, 3.912586875744381*^9}, {3.9125918245224667`*^9, 
   3.91259183284165*^9}, {3.912636498374503*^9, 3.9126365160139503`*^9}, {
   3.9126365767755013`*^9, 3.9126366400903473`*^9}, {3.912637388467959*^9, 
   3.912637429687633*^9}, {3.912637882949695*^9, 3.912637895085332*^9}, {
   3.9126381666301813`*^9, 3.912638302265975*^9}, {3.912638417184616*^9, 
   3.912638457435504*^9}, {3.9126384988170137`*^9, 3.912638610975223*^9}, {
   3.912647880192276*^9, 3.912647944724547*^9}, {3.912648664176649*^9, 
   3.912648671399425*^9}, {3.9126487014412117`*^9, 3.912648756514988*^9}, {
   3.9126488809510593`*^9, 3.912648972167165*^9}, {3.912649024301876*^9, 
   3.912649027885689*^9}, {3.9126490680172787`*^9, 3.912649068941*^9}, {
   3.912649099548194*^9, 3.9126491975240107`*^9}, {3.912649324831661*^9, 
   3.9126495397299757`*^9}, {3.9126496101734257`*^9, 3.912649632000442*^9}, {
   3.912649740468911*^9, 3.912649765129652*^9}, {3.9126498136147346`*^9, 
   3.912649963699877*^9}, {3.912650123333153*^9, 3.912650125365539*^9}, 
   3.91265115363972*^9, {3.912651654697596*^9, 3.912651717477448*^9}, {
   3.912651803939149*^9, 3.912651916597042*^9}, {3.912652031796956*^9, 
   3.9126520343705378`*^9}, 3.912722650894059*^9, 3.912722990312393*^9, {
   3.912723349235421*^9, 3.9127233514820747`*^9}, {3.9127305699320297`*^9, 
   3.91273057546555*^9}, {3.912739484409297*^9, 3.9127394863193483`*^9}, {
   3.914125660541527*^9, 3.914125847629472*^9}, {3.914125984983276*^9, 
   3.91412598981306*^9}, {3.914128009500907*^9, 3.914128119063426*^9}, {
   3.914128198899617*^9, 3.914128201957835*^9}, {3.914128243967594*^9, 
   3.914128310576219*^9}, {3.914128342704989*^9, 3.914128367426299*^9}, {
   3.914128458189102*^9, 3.914128534380869*^9}, {3.91412856735955*^9, 
   3.914128578156703*^9}, {3.914128611136736*^9, 3.91412861278659*^9}, {
   3.914128799472711*^9, 3.914128970687592*^9}, {3.914129004520692*^9, 
   3.914129006364624*^9}, 3.914129057262961*^9, {3.9145108645871277`*^9, 
   3.914510866790299*^9}, 3.9145173137866583`*^9, 3.9145173477298183`*^9, {
   3.9145173871150293`*^9, 3.914517420682969*^9}, {3.9183932536653013`*^9, 
   3.918393264729244*^9}, {3.918513120538479*^9, 3.918513134640472*^9}},
 CellLabel->
  "In[537]:=",ExpressionUUID->"ad9daf91-2a58-4121-8f03-88039b4fbf99"]
}, Closed]],

Cell[CellGroupData[{

Cell["Get solutions and bdry data", "Subsection",
 CellChangeTimes->{{3.887041801503776*^9, 
  3.887041809211557*^9}},ExpressionUUID->"d1d6f3d4-b12a-403d-b041-\
9db0f6b8f6f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FourSimplices", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "$$3", ",", "4", ",", "5"}], "}"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9188112974107437`*^9, 3.91881135121076*^9}, {
  3.918816393840466*^9, 3.9188163970895576`*^9}},
 CellLabel->
  "In[538]:=",ExpressionUUID->"79e47f20-e180-4740-83b3-14f50fcaa641"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bdypoints", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "2"], ",", "1", ",", "1", ",", "1"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "2"], ",", "1", ",", "1", ",", "1"}], "}"}]}], 
      "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.88704183817304*^9, 3.887041838175847*^9}, {
   3.888401082161255*^9, 3.888401083745371*^9}, {3.888507622761053*^9, 
   3.888507624578384*^9}, {3.8892041133505297`*^9, 3.889204142680027*^9}, {
   3.889543300516427*^9, 3.889543305178829*^9}, {3.889638629174312*^9, 
   3.889638635421357*^9}, {3.890150503802108*^9, 3.890150504734561*^9}, 
   3.891535015769556*^9, 3.891535130226141*^9, {3.891535296789948*^9, 
   3.891535335304637*^9}, {3.894657353158551*^9, 3.894657381651123*^9}, {
   3.895034287721427*^9, 3.89503429016847*^9}, {3.895285473530746*^9, 
   3.895285488538761*^9}, {3.895285529953569*^9, 3.895285531858346*^9}, 
   3.895475085336854*^9, {3.895609836492337*^9, 3.895609840468461*^9}, {
   3.896748602369289*^9, 3.896748606045391*^9}, {3.901247915356477*^9, 
   3.9012479177402067`*^9}, {3.909268510131579*^9, 3.909268514161853*^9}, 
   3.912729433559486*^9, {3.912729483718327*^9, 3.912729484113946*^9}, {
   3.9127353992896843`*^9, 3.912735399559018*^9}, {3.912736331805656*^9, 
   3.912736332126204*^9}, {3.912736382869697*^9, 3.9127363830967417`*^9}, {
   3.912736488225128*^9, 3.912736488536004*^9}, {3.9127426351054296`*^9, 
   3.9127426619793386`*^9}, 3.9127444275731783`*^9, 3.912744466241242*^9, 
   3.912744512849231*^9, {3.912744640536148*^9, 3.912744652905593*^9}, {
   3.912744688426972*^9, 3.912744697045128*^9}, {3.9127447273730297`*^9, 
   3.912744727560433*^9}, {3.9127447603423433`*^9, 3.912744760668099*^9}, {
   3.912744793462594*^9, 3.912744794822797*^9}, {3.91274490186432*^9, 
   3.9127449023612633`*^9}, {3.912744942351138*^9, 3.912744942512455*^9}, {
   3.9127449848019533`*^9, 3.912744985024764*^9}, {3.912745092447042*^9, 
   3.9127450925675583`*^9}, 3.9127648535806437`*^9, {3.912821628061481*^9, 
   3.912821628192717*^9}, {3.9128217482678843`*^9, 3.912821748427906*^9}, {
   3.912822629888761*^9, 3.9128226300317717`*^9}, 3.912825487873427*^9, 
   3.912826353831608*^9, 3.912827436988772*^9, 3.912827734808103*^9, 
   3.9128860662247*^9, 3.9128863984832497`*^9, {3.912886797475095*^9, 
   3.912886812775502*^9}, {3.9145105742534447`*^9, 3.914510595190427*^9}, 
   3.918811234140236*^9, 3.91881638125775*^9},
 CellLabel->
  "In[539]:=",ExpressionUUID->"88316e5b-4886-4e78-a448-3ffdeb6526d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bdydata", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"getsolution", "[", "#", "]"}], "&"}], "/@", "bdypoints"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9127234409882517`*^9, 3.9127234465942087`*^9}, {
   3.912886828250643*^9, 3.912886832818787*^9}, 3.914517320989038*^9, {
   3.914517395144928*^9, 3.914517396593196*^9}, 3.914517439527807*^9},
 CellLabel->
  "In[540]:=",ExpressionUUID->"7a9dbe2c-49cb-4300-a9a5-9656503cf110"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bdydataAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bdydata", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "i"}], "]"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", 
        RowBox[{"bdydata", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{
        RowBox[{"bdydataAll", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", 
        RowBox[{"bdydata", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "@", 
         RowBox[{"bdydata", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", 
      RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.912886966152726*^9, 3.912886989505013*^9}, {
  3.912887038369533*^9, 3.912887097667412*^9}, {3.912887128106133*^9, 
  3.9128871330664167`*^9}, {3.912887297551957*^9, 3.912887321552075*^9}, {
  3.912887428141876*^9, 3.912887429540818*^9}, {3.91288747093797*^9, 
  3.912887503745686*^9}, {3.914510656977952*^9, 3.914510686772594*^9}},
 CellLabel->
  "In[541]:=",ExpressionUUID->"01b611dc-9ebc-4458-849d-36db35724206"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "sl2ctest", ",", "bdyxi", ",", "bdysutest", ",", "bdybivec55stest", ",", 
     "area", ",", "fullkappa", ",", "nabtest", ",", "solgso13test", ",", 
     "nabtest4d", ",", "tetnormalvec", ",", "edgevec", ",", "bivec4d", ",", 
     "nabfrombivec", ",", "sgndet", ",", "tetn0sign", ",", "tetareasign"}], 
    "}"}], "=", "bdydataAll"}], ";"}]], "Input",
 CellChangeTimes->{{3.9128875124461393`*^9, 3.912887512904451*^9}, {
   3.912887867386282*^9, 3.912887868029132*^9}, {3.914510620024149*^9, 
   3.91451064023132*^9}, {3.914512256273785*^9, 3.9145122583393717`*^9}, 
   3.914512397095531*^9},
 CellLabel->
  "In[543]:=",ExpressionUUID->"b8eb227b-21c8-4ca6-90ac-5f42bc145a0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kappa", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fullkappa", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"fullkappa", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.912887832505328*^9, 3.912887834841977*^9}, {
   3.912887879558322*^9, 3.912887890160363*^9}, 3.914512403730976*^9, {
   3.9188173188768044`*^9, 3.91881731951562*^9}},
 CellLabel->
  "In[544]:=",ExpressionUUID->"b9fc31d5-3bd8-4e1c-9f3d-5f2e1901fe0a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check parallel transport and closure condition", "Subsection",
 CellChangeTimes->{{3.887041868500998*^9, 3.8870418800633183`*^9}, 
   3.918811477453233*^9},ExpressionUUID->"8a280100-5ebb-444b-ab94-\
8e32d418bdc4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"sl2ctest", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "i"}], "]"}], "]"}], ".", 
           RowBox[{"bdybivec55stest", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{"sl2ctest", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"sl2ctest", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "j"}], "]"}], "]"}], ".", 
           RowBox[{"bdybivec55stest", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "j", ",", "i"}], "]"}], "]"}], ".", 
           RowBox[{"Inverse", "[", 
            RowBox[{"sl2ctest", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "j"}], "]"}], "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "5"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], "//", 
     "FullSimplify"}], "//", "Chop"}], "//", "Flatten"}], "//", 
  "DeleteDuplicates"}]], "Input",
 CellChangeTimes->{{3.887041898390943*^9, 3.887041898394053*^9}, 
   3.893130770808818*^9, {3.912722943152101*^9, 3.9127229590750933`*^9}, {
   3.91272359586473*^9, 3.912723609817218*^9}, {3.912742691561942*^9, 
   3.912742692522602*^9}, {3.912887552630599*^9, 3.9128876135157537`*^9}},
 CellLabel->
  "In[545]:=",ExpressionUUID->"17193056-af62-42af-9a14-d585b21ff230"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.8931307713562527`*^9, 3.8931340960216312`*^9, 3.893134202706087*^9, 
   3.9126519535926123`*^9, 3.9126520395481863`*^9, 3.912654643427773*^9, 
   3.9126552227406597`*^9, 3.912655971574377*^9, 3.912656232109745*^9, 
   3.912659680266428*^9, 3.912659930329677*^9, 3.912661419125018*^9, 
   3.912661715634807*^9, 3.912661788176543*^9, 3.912663302019215*^9, 
   3.9126819808802547`*^9, 3.91268302824052*^9, 3.9127226161711063`*^9, 
   3.912722660223095*^9, 3.912722789658036*^9, 3.912722961031536*^9, 
   3.912723001849382*^9, 3.9127232402021713`*^9, 3.9127233625199537`*^9, 
   3.91272361028407*^9, 3.912723744371513*^9, 3.912727896895727*^9, 
   3.912728076883322*^9, 3.912729310234582*^9, 3.912729497621784*^9, 
   3.912729833660943*^9, 3.912730602983343*^9, 3.912730769267297*^9, 
   3.912735416731848*^9, 3.9127355166060247`*^9, 3.9127355843645477`*^9, 
   3.912735844676194*^9, 3.912736411609577*^9, 3.912736509217349*^9, 
   3.912736705301364*^9, 3.9127383450052423`*^9, 3.912738973362062*^9, 
   3.912739004209491*^9, 3.912739121060729*^9, 3.912739492390492*^9, 
   3.9127396445886793`*^9, 3.9127402656211157`*^9, 3.912742325584322*^9, 
   3.912742469203965*^9, 3.912742595241508*^9, {3.9127426451674023`*^9, 
   3.912742693231605*^9}, 3.912743010642891*^9, 3.9127434308951063`*^9, 
   3.912743471365975*^9, 3.9127435340559263`*^9, 3.91274413980027*^9, 
   3.912744199209671*^9, 3.9127443871991587`*^9, 3.912744433949836*^9, 
   3.9127444723084307`*^9, 3.91274451842317*^9, 3.912744603256536*^9, 
   3.912744659895426*^9, 3.912744702282873*^9, 3.9127447324487658`*^9, 
   3.912744766466144*^9, 3.912744800703948*^9, 3.912744907948504*^9, 
   3.9127449476355124`*^9, 3.9127449909448843`*^9, 3.912745098453904*^9, 
   3.9127678753753233`*^9, 3.9128124394234257`*^9, 3.912812578837405*^9, 
   3.912814937402918*^9, 3.9128159855603237`*^9, 3.912821319817593*^9, 
   3.9128216374764557`*^9, 3.912821753334466*^9, 3.9128225570579557`*^9, 
   3.912822635174403*^9, 3.912823504158402*^9, 3.912824436306419*^9, 
   3.9128247068880777`*^9, 3.912824944468601*^9, 3.912825082992833*^9, 
   3.9128251789371223`*^9, 3.912825351301157*^9, 3.9128254964441853`*^9, 
   3.9128257210367126`*^9, {3.912825809017943*^9, 3.912825833711648*^9}, 
   3.912825886120363*^9, 3.912825976302533*^9, 3.9128263677482853`*^9, 
   3.9128273875286713`*^9, 3.9128274485246773`*^9, 3.9128276882900476`*^9, 
   3.9128277556523542`*^9, 3.912828053748024*^9, 3.912828360022004*^9, 
   3.9128860783618813`*^9, {3.912887606873847*^9, 3.912887613893937*^9}, 
   3.912892202159198*^9, 3.9128952084493923`*^9, 3.912895251927788*^9, 
   3.912895293791305*^9, 3.912896285848928*^9, 3.9128965207124157`*^9, 
   3.912904870770731*^9, 3.9145122970580053`*^9, 3.91451460057344*^9, 
   3.914517198839137*^9, 3.9145174533939457`*^9, 3.914518079508295*^9, 
   3.9145813536403427`*^9, 3.9145832963593073`*^9, 3.914583921254911*^9, 
   3.9145999590994377`*^9, 3.9184020709250174`*^9, 3.918402149214467*^9, 
   3.9184024226656446`*^9, 3.918647936488703*^9, 3.918648543672677*^9, 
   3.918649078202436*^9, 3.918649111844163*^9, 3.918649145878457*^9, 
   3.918654451589149*^9, 3.918654871954945*^9, 3.918655459383835*^9, 
   3.918663008495782*^9, 3.9188088442887278`*^9, 3.918809422188908*^9, 
   3.918810219232147*^9, 3.9188113639643993`*^9, 3.918813356808094*^9, 
   3.918813629313202*^9, 3.918816569742907*^9, 3.9188175164333076`*^9, 
   3.918819343356637*^9, 3.918819720531323*^9, 3.918820025659945*^9, 
   3.918820238372011*^9, 3.91882041184899*^9, 3.91882063361491*^9, 
   3.918820763326655*^9, 3.9188210837692823`*^9, 3.918821362074597*^9, 
   3.918923765018146*^9},
 CellLabel->
  "Out[545]=",ExpressionUUID->"501489c7-853e-4c5a-bf2e-687a91cbe212"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"kappa", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "*", 
            RowBox[{"area", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "*", 
            RowBox[{"bdybivec55stest", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], "//", 
     "FullSimplify"}], "//", "Chop"}], "//", "Flatten"}], "//", 
  "DeleteDuplicates"}]], "Input",
 CellChangeTimes->{{3.88704190366236*^9, 3.887041903665422*^9}, 
   3.893130773287896*^9, {3.912651957640833*^9, 3.912651968764062*^9}, {
   3.9127236162536907`*^9, 3.9127236223708076`*^9}, {3.912887624235964*^9, 
   3.912887658079362*^9}},
 CellLabel->
  "In[546]:=",ExpressionUUID->"cc5097e5-3bcb-43c4-b60c-446c0f336f08"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.8931307738103*^9, 3.89313409602812*^9, 3.893134202717669*^9, {
   3.912651953597534*^9, 3.9126519692864733`*^9}, 3.912652039560549*^9, 
   3.912654643436159*^9, 3.912655222753286*^9, 3.91265597158564*^9, 
   3.912656232122981*^9, 3.9126596802798777`*^9, 3.912659930336876*^9, 
   3.9126614191366*^9, 3.912661715688106*^9, 3.9126617881829443`*^9, 
   3.912663302033688*^9, 3.912681980913273*^9, 3.912683030275312*^9, 
   3.912722616193516*^9, 3.9127226602265167`*^9, 3.9127227896809053`*^9, 
   3.912723001861274*^9, 3.912723240230998*^9, 3.912723362523295*^9, 
   3.91272362277253*^9, 3.912723744376058*^9, 3.9127278969062223`*^9, 
   3.912728076889529*^9, 3.912729310242735*^9, 3.912729497634879*^9, 
   3.912729833674779*^9, 3.9127306029873333`*^9, 3.912730769277728*^9, 
   3.912735416742877*^9, 3.9127355166189327`*^9, 3.912735584376555*^9, 
   3.912735844681988*^9, 3.912736411627117*^9, 3.9127365092497473`*^9, 
   3.912736705315583*^9, 3.9127383450182734`*^9, 3.912738973374529*^9, 
   3.912739004222028*^9, 3.912739121073941*^9, 3.912739492402451*^9, 
   3.912739644601904*^9, 3.9127402656364603`*^9, 3.912742325598468*^9, 
   3.912742469215703*^9, 3.912742595253696*^9, {3.912742645173575*^9, 
   3.912742670724448*^9}, 3.912743010656372*^9, 3.912743430908482*^9, 
   3.912743471375021*^9, 3.912743534069552*^9, 3.912744139813916*^9, 
   3.9127443872131767`*^9, 3.912744433963025*^9, 3.912744472314958*^9, 
   3.912744518432537*^9, 3.912744603265883*^9, 3.9127446599019547`*^9, 
   3.9127447022893953`*^9, 3.9127447324551907`*^9, 3.912744766477923*^9, 
   3.912744800710601*^9, 3.912744907961357*^9, 3.9127449476480827`*^9, 
   3.9127449909521513`*^9, 3.912745098466999*^9, 3.912767875384953*^9, 
   3.9128124431179533`*^9, 3.912812578864963*^9, 3.912814937434779*^9, 
   3.912815985599041*^9, 3.9128213198229523`*^9, 3.912821637486972*^9, 
   3.9128217533411617`*^9, 3.9128225570641127`*^9, 3.912822635180738*^9, 
   3.9128235041658373`*^9, 3.9128244363133087`*^9, 3.9128247068947783`*^9, 
   3.912824944475092*^9, 3.9128250830060987`*^9, 3.912825178951354*^9, 
   3.91282535130788*^9, 3.912825496450691*^9, 3.9128257210743637`*^9, {
   3.9128258090630817`*^9, 3.912825833763633*^9}, 3.912825886133914*^9, 
   3.9128259763140497`*^9, 3.9128263677603693`*^9, 3.91282738756691*^9, 
   3.912827448533177*^9, 3.912827688301384*^9, 3.912827755665945*^9, 
   3.912828053756906*^9, 3.9128283600336246`*^9, 3.912886078369192*^9, {
   3.912887651373658*^9, 3.912887658373508*^9}, 3.912892202173072*^9, 
   3.912895208462562*^9, 3.91289525194569*^9, 3.9128952938205338`*^9, 
   3.912896285865321*^9, 3.9128965207296047`*^9, 3.912904870787195*^9, 
   3.914512297082143*^9, 3.914514600579043*^9, 3.9145171988762007`*^9, 
   3.914517453431019*^9, 3.9145180795264053`*^9, 3.914581353662855*^9, 
   3.914583296368848*^9, 3.914583921267148*^9, 3.9145999591100082`*^9, 
   3.918402070935709*^9, 3.9184021492522573`*^9, 3.918402422669957*^9, 
   3.918647936498514*^9, 3.9186485436788597`*^9, 3.9186490782137547`*^9, 
   3.918649111857218*^9, 3.918649145890802*^9, 3.918654451599927*^9, 
   3.918654871957796*^9, 3.918655459394167*^9, 3.9186630085092363`*^9, 
   3.91880884430138*^9, 3.918809422201552*^9, 3.9188102192431707`*^9, 
   3.918811363979759*^9, 3.918813356814117*^9, 3.918813629317835*^9, 
   3.918816569757873*^9, 3.9188175164473763`*^9, 3.918819343368285*^9, 
   3.9188197205438433`*^9, 3.918820025671747*^9, 3.918820238389097*^9, 
   3.9188204118643227`*^9, 3.918820633628751*^9, 3.918820763339775*^9, 
   3.918821083781425*^9, 3.918821362089632*^9, 3.9189237650297747`*^9},
 CellLabel->
  "Out[546]=",ExpressionUUID->"7b0d2035-c607-4f14-8754-69e8a79f738e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tetareasign", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "*", 
            RowBox[{"area", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "*", 
            RowBox[{"nabtest4d", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], "//", 
     "FullSimplify"}], "//", "Chop"}], "//", "Flatten"}], "//", 
  "DeleteDuplicates"}]], "Input",
 CellChangeTimes->{{3.9128953089984493`*^9, 3.912895314197237*^9}, {
   3.91840207636479*^9, 3.918402085895805*^9}, 3.9184021460760393`*^9},
 CellLabel->
  "In[547]:=",ExpressionUUID->"39cd7503-604b-4deb-8a49-3b06f1743982"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.912895316730233*^9, 3.912896285882145*^9, 3.912896520739422*^9, 
   3.912904870803959*^9, 3.914512297107935*^9, 3.914514600608707*^9, 
   3.91451719893888*^9, 3.914517453494618*^9, 3.914518079541355*^9, 
   3.914581353720221*^9, 3.9145832963910427`*^9, 3.9145839212888536`*^9, 
   3.914599959130845*^9, {3.9184020709483767`*^9, 3.918402086407144*^9}, {
   3.918402146678775*^9, 3.91840214925705*^9}, 3.918402422672719*^9, 
   3.918647936502754*^9, 3.918648543689495*^9, 3.9186490782350607`*^9, 
   3.918649111882476*^9, 3.9186491458945923`*^9, 3.918654451603558*^9, 
   3.918654871960149*^9, 3.918655459397567*^9, 3.918663008513164*^9, 
   3.918808844305667*^9, 3.9188094222076397`*^9, 3.918810219249179*^9, 
   3.918811363985262*^9, 3.918813356832205*^9, 3.918813629333252*^9, 
   3.9188165697801027`*^9, 3.918817516469864*^9, 3.918819343390999*^9, 
   3.918819720563735*^9, 3.9188200256896763`*^9, 3.918820238405798*^9, 
   3.9188204118882933`*^9, 3.9188206336423893`*^9, 3.9188207633624287`*^9, 
   3.918821083805759*^9, 3.918821362113065*^9, 3.918923765051095*^9},
 CellLabel->
  "Out[547]=",ExpressionUUID->"2d9659ba-9d2d-4c29-a3e7-6a0ce349078b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"solgso13test", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "i"}], "]"}], "]"}], ".", 
           RowBox[{"bivec4d", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], ".", "\[Eta]", 
           ".", 
           RowBox[{"(", 
            RowBox[{"Transpose", "[", 
             RowBox[{"solgso13test", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"solgso13test", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "j"}], "]"}], "]"}], ".", 
           RowBox[{"bivec4d", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "j", ",", "i"}], "]"}], "]"}], ".", "\[Eta]", 
           ".", 
           RowBox[{"Transpose", "[", 
            RowBox[{"solgso13test", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "j"}], "]"}], "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "5"}], "}"}]}], "]"}], "//", 
       "FullSimplify"}], "//", "Chop"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}], "//", "DeleteDuplicates"}]], "Input",
 CellChangeTimes->{{3.895386066946887*^9, 3.8953862157992373`*^9}, {
   3.895386305024335*^9, 3.895386349623452*^9}, {3.8953863901625643`*^9, 
   3.8953864588251343`*^9}, 3.896300696770589*^9, {3.912681986344337*^9, 
   3.912681988476733*^9}, {3.9127236299314547`*^9, 3.912723647364184*^9}, {
   3.912887663143688*^9, 3.91288770583454*^9}},
 CellLabel->
  "In[548]:=",ExpressionUUID->"aed04b56-aa51-41a4-bb91-bc0fae0298b6"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{{3.912681980931512*^9, 3.9126819890375643`*^9}, 
   3.912683032826446*^9, 3.9127226162885447`*^9, 3.912722660231122*^9, 
   3.9127227896855183`*^9, 3.912723001864592*^9, 3.912723240235993*^9, 
   3.912723362535639*^9, {3.9127236423561993`*^9, 3.912723647774212*^9}, 
   3.912723744390094*^9, 3.912727896947957*^9, 3.9127280769044037`*^9, 
   3.9127293102473707`*^9, 3.912729497719008*^9, 3.9127298337623463`*^9, 
   3.912730603000011*^9, 3.9127307693638287`*^9, 3.9127354167479773`*^9, 
   3.9127355166254396`*^9, 3.912735584382471*^9, 3.9127358446939793`*^9, 
   3.912736411632975*^9, 3.912736509335235*^9, 3.912736705386496*^9, 
   3.912738345200013*^9, 3.9127389734387827`*^9, 3.912739004268107*^9, 
   3.912739121150364*^9, 3.9127394924604473`*^9, 3.9127396446764402`*^9, 
   3.912740265725327*^9, 3.912742325684547*^9, 3.912742469282852*^9, 
   3.9127425952813673`*^9, {3.912742645235491*^9, 3.912742670776237*^9}, 
   3.91274301070617*^9, 3.9127434309518137`*^9, 3.912743471415909*^9, 
   3.9127435341597633`*^9, 3.91274413990315*^9, 3.9127443872574587`*^9, 
   3.9127444340075808`*^9, 3.9127444723905077`*^9, 3.912744518485642*^9, 
   3.912744603353052*^9, 3.912744659957185*^9, 3.912744702340144*^9, 
   3.912744732468445*^9, 3.912744766485468*^9, 3.912744800723445*^9, 
   3.912744907974329*^9, 3.9127449476554728`*^9, 3.912744990963966*^9, 
   3.912745098478492*^9, 3.91276787539153*^9, 3.912812443166217*^9, 
   3.912812578870975*^9, 3.91281493744072*^9, 3.912815985608129*^9, 
   3.912821319831316*^9, 3.912821637492998*^9, 3.912821753356512*^9, 
   3.9128225570774727`*^9, 3.912822635194729*^9, 3.9128235041809464`*^9, 
   3.9128244363261423`*^9, 3.912824706907455*^9, 3.91282494449085*^9, 
   3.9128250830188417`*^9, 3.9128251789590797`*^9, 3.9128253513233213`*^9, 
   3.912825496462945*^9, 3.91282572111452*^9, {3.912825809110053*^9, 
   3.91282583381761*^9}, 3.9128258861537457`*^9, 3.912825976328101*^9, 
   3.9128263677744713`*^9, 3.91282738757584*^9, 3.912827448549726*^9, 
   3.912827688320404*^9, 3.912827755683312*^9, 3.912828053774434*^9, 
   3.9128283600515757`*^9, 3.912886078382655*^9, {3.912887699826833*^9, 
   3.912887706197103*^9}, 3.912892202265348*^9, 3.912895208553*^9, 
   3.912895252035306*^9, 3.912895293837511*^9, 3.912896285899445*^9, 
   3.912896520831594*^9, 3.9129048708980913`*^9, 3.914512297149159*^9, 
   3.914514600707609*^9, 3.914517199497424*^9, 3.914517454056487*^9, 
   3.914518079638505*^9, 3.914581354264471*^9, 3.9145832965035553`*^9, 
   3.914583921386291*^9, 3.9145999592285624`*^9, 3.918402071014346*^9, 
   3.918402149269493*^9, 3.918402422683652*^9, 3.918647936618718*^9, 
   3.9186485437038507`*^9, 3.91864907825478*^9, 3.9186491119975853`*^9, 
   3.9186491459224586`*^9, 3.9186544517198057`*^9, 3.9186548719669657`*^9, 
   3.918655459515588*^9, 3.918663008625146*^9, 3.918808844409758*^9, 
   3.918809422325212*^9, 3.918810219368403*^9, 3.918811364103059*^9, 
   3.918813356851474*^9, 3.918813629348342*^9, 3.918816569867868*^9, 
   3.9188175165576477`*^9, 3.918819343479742*^9, 3.918819720621318*^9, 
   3.9188200257512093`*^9, 3.918820238465838*^9, 3.9188204119805593`*^9, 
   3.918820633692976*^9, 3.918820763450377*^9, 3.9188210838944597`*^9, 
   3.918821362202714*^9, 3.9189237650708237`*^9},
 CellLabel->
  "Out[548]=",ExpressionUUID->"bfeaef6f-43fa-4430-b8cb-b985bebd9d98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SymmetricMatrixQ", "[", 
    RowBox[{"#", "//", "FullSimplify"}], "]"}], "&"}], "/@", 
  "area"}]], "Input",
 CellChangeTimes->{{3.912723089709721*^9, 3.912723091292078*^9}, {
  3.9127236660299053`*^9, 3.91272367091686*^9}, {3.912887715038137*^9, 
  3.912887720192647*^9}},
 CellLabel->
  "In[549]:=",ExpressionUUID->"2c73614d-62dc-4cbf-a0df-ebd6023d7624"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{
  3.912723091600539*^9, 3.9127232402526817`*^9, 3.912723362550255*^9, 
   3.9127236717603197`*^9, 3.912723744406843*^9, 3.9127278969670277`*^9, 
   3.91272808513881*^9, 3.912729310259083*^9, 3.912729497736566*^9, 
   3.9127298337813063`*^9, 3.9127306030174932`*^9, 3.912730769384025*^9, 
   3.9127354167639027`*^9, 3.912735516643064*^9, 3.912735584403368*^9, 
   3.912735844712137*^9, 3.9127364116501207`*^9, 3.912736509355516*^9, 
   3.912736705398446*^9, 3.9127383452152157`*^9, 3.912738973451282*^9, 
   3.912739004277145*^9, 3.912739121164526*^9, 3.9127394924738293`*^9, 
   3.912739644690645*^9, 3.9127402657423067`*^9, 3.912742325701124*^9, 
   3.912742469299035*^9, 3.912742595293706*^9, {3.9127426452497873`*^9, 
   3.912742670789535*^9}, 3.912743010718766*^9, 3.912743430964961*^9, 
   3.912743471425025*^9, 3.9127435341806517`*^9, 3.912744139920422*^9, 
   3.912744387271222*^9, 3.912744434016282*^9, 3.9127444724032793`*^9, 
   3.912744518499655*^9, 3.912744603377514*^9, 3.9127446599767103`*^9, 
   3.9127447023490973`*^9, 3.912744732474722*^9, 3.9127447664971333`*^9, 
   3.9127448007322617`*^9, 3.91274490802337*^9, 3.91274494766831*^9, 
   3.9127449909711227`*^9, 3.9127450984924173`*^9, 3.912767875417716*^9, {
   3.9128159856527443`*^9, 3.9128159970013037`*^9}, 3.91282131984195*^9, 
   3.9128216375035458`*^9, 3.9128217533632927`*^9, 3.91282255708337*^9, 
   3.912822635202072*^9, 3.912823504188096*^9, 3.912824436332663*^9, 
   3.912824706913957*^9, 3.912824944496851*^9, 3.9128250830253*^9, 
   3.912825178975367*^9, 3.91282535133211*^9, 3.9128254964694977`*^9, 
   3.912825721123011*^9, {3.912825809119673*^9, 3.9128258338285437`*^9}, 
   3.912825886166306*^9, 3.912825976336341*^9, 3.912826367782832*^9, 
   3.912827387590826*^9, 3.9128274485580053`*^9, 3.912827688356001*^9, 
   3.912827755691719*^9, 3.9128280537840157`*^9, 3.912828360060957*^9, 
   3.912886078389106*^9, 3.912887720621496*^9, 3.912892202284374*^9, 
   3.912895208571876*^9, 3.912895252054925*^9, 3.912895293854258*^9, 
   3.91289628591569*^9, 3.912896520851276*^9, 3.9129048709194727`*^9, 
   3.9145122971591043`*^9, 3.914514600721068*^9, 3.914517199541642*^9, 
   3.914517454082274*^9, 3.914518079650424*^9, 3.914581354317521*^9, 
   3.914583296519465*^9, 3.914583921402833*^9, 3.914599959242201*^9, 
   3.9184020710193367`*^9, 3.918402149274227*^9, 3.918402422688959*^9, 
   3.9186479366344757`*^9, 3.918648543711101*^9, 3.9186490782663794`*^9, 
   3.918649112015025*^9, 3.918649145934134*^9, 3.918654451735409*^9, 
   3.918654871977153*^9, 3.918655459535995*^9, 3.918663008640815*^9, 
   3.918808844425181*^9, 3.91880942234186*^9, 3.918810219387198*^9, 
   3.9188113641205378`*^9, 3.918813356869179*^9, 3.918813629362953*^9, 
   3.918816569883238*^9, 3.918817516572688*^9, 3.918819343496217*^9, 
   3.918819720633915*^9, 3.9188200257630863`*^9, 3.9188202384827423`*^9, 
   3.918820411995406*^9, 3.918820633708907*^9, 3.9188207634654493`*^9, 
   3.918821083910379*^9, 3.918821362218285*^9, 3.918923765080068*^9},
 CellLabel->
  "Out[549]=",ExpressionUUID->"b7baf589-9123-4131-9b98-7b0e1cb130f6"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Label 4-simplices and Tetrahedra", "Section",
 CellChangeTimes->{{3.890150279792844*^9, 
  3.890150307251395*^9}},ExpressionUUID->"a9c141ba-8519-4b49-85c6-\
9baa527a44f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tets", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Subsets", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", "4", "}"}]}], "]"}], "&"}], "/@", 
   "FourSimplices"}]}]], "Input",
 CellChangeTimes->{{3.890150460019247*^9, 3.890150479727688*^9}, 
   3.891425331887828*^9, 3.912887923076748*^9, 3.91451260260528*^9, {
   3.9188195775156727`*^9, 3.918819580100132*^9}},
 CellLabel->
  "In[550]:=",ExpressionUUID->"7171acee-803e-444b-b3c8-b5d5d647b567"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "$$3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "$$3", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "$$3", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "$$3", ",", "4", ",", "5"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.891425332454805*^9, {3.8914260325091457`*^9, 3.891426035689765*^9}, 
   3.8914262771144753`*^9, 3.8914265429889793`*^9, 3.891426825265828*^9, 
   3.893218005910087*^9, 3.8932191278126173`*^9, 3.893219733434503*^9, 
   3.912887926232882*^9, 3.9128922022997923`*^9, 3.91289506686329*^9, 
   3.912895208588366*^9, 3.912895563384364*^9, 3.912896296499836*^9, 
   3.9128967706404247`*^9, 3.9129048709373007`*^9, 3.9145124252352867`*^9, 
   3.914512606400386*^9, 3.91451460073484*^9, 3.914517459095516*^9, 
   3.9145180796562843`*^9, 3.9145813543278008`*^9, 3.9145832965306673`*^9, 
   3.9145839214084797`*^9, 3.914599959248703*^9, 3.918402071030986*^9, 
   3.9184021518813553`*^9, 3.918402422700316*^9, 3.918647936638299*^9, 
   3.918648543722622*^9, 3.918649078270347*^9, 3.918649112019845*^9, 
   3.918649145938092*^9, 3.918654451742064*^9, 3.918654871980083*^9, 
   3.9186554595395947`*^9, 3.918663008644992*^9, 3.918808920924674*^9, 
   3.918809422347742*^9, 3.918810219395915*^9, {3.9188113697960463`*^9, 
   3.918811373420403*^9}, 3.9188133568747673`*^9, 3.9188136293671293`*^9, 
   3.918816574265718*^9, 3.918817516581143*^9, 3.9188193435019627`*^9, 
   3.9188197206412983`*^9, 3.9188200257682133`*^9, 3.918820238488048*^9, 
   3.918820412000621*^9, 3.918820633713451*^9, 3.918820763469933*^9, 
   3.918821083919301*^9, 3.918821362226141*^9, 3.9189237650834827`*^9},
 CellLabel->
  "Out[550]=",ExpressionUUID->"30a3be11-52f5-4cd2-8762-fc0be1c3364b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TetFaces0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Subsets", "[", 
      RowBox[{
       RowBox[{"Tets", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
       RowBox[{"{", "3", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "Tets", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"Tets", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TetFaces", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{"TetFaces0", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "@", 
          RowBox[{"TetFaces0", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "Tets", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.912887955675173*^9, 3.912887961941758*^9}},
 CellLabel->
  "In[551]:=",ExpressionUUID->"84d3efc7-023d-4218-8384-e1aac8e96f87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Triangles", "=", 
   RowBox[{"DeleteDuplicates", "@", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Tets", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "Tets"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"Tets", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", "2"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.882699102861356*^9, 3.8826992146790237`*^9}},
 CellLabel->
  "In[553]:=",ExpressionUUID->"b1db5281-929e-4d97-bb73-a8bf27f0a238"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FacePosition", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"TetFaces", ",", "#"}], "]"}], "&"}], "/@", "Triangles"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8744137915766*^9, 3.8744137960418787`*^9}, {
  3.874414401720312*^9, 3.874414408504546*^9}, {3.874416650216373*^9, 
  3.8744166728615637`*^9}, {3.874416979937531*^9, 3.874417024310158*^9}, {
  3.874417067984956*^9, 3.87441711199632*^9}, {3.8744186169426107`*^9, 
  3.874418654036375*^9}},
 CellLabel->
  "In[554]:=",ExpressionUUID->"de9b5445-4358-44f0-b901-21403aa22caf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BDFaces", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"pos0", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Tets", "[", 
          RowBox[{"[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "2"}], "]"}], "]"}], ")"}]}], "]"}], "]"}], 
         "&"}], "/@", 
        RowBox[{"FacePosition", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pp1", "=", 
       RowBox[{"DeleteDuplicates", "@", "pos0"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "pp1", "]"}], ">", 
         RowBox[{
          RowBox[{"Length", "[", "pos0", "]"}], "/", "2"}]}], ",", 
        RowBox[{"Triangles", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"Unevaluated", "[", 
         RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "FacePosition"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.874421624826501*^9, 3.874421686963834*^9}, {
   3.8744222047396584`*^9, 3.874422220831237*^9}, 3.8744224555719213`*^9, 
   3.890151707055265*^9},
 CellLabel->
  "In[555]:=",ExpressionUUID->"8e4930e2-6f5a-49f0-9289-e06f0b5f9ecb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BDFacesPosition", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"TetFaces", ",", "#"}], "]"}], "&"}], "/@", "BDFaces"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.874422530641279*^9, 3.874422584858521*^9}, 
   3.890151272981298*^9, 3.890151408695485*^9},
 CellLabel->
  "In[556]:=",ExpressionUUID->"12b78450-1da4-4d9a-84e9-540c84e438c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BulkFaces", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"pos0", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Tets", "[", 
          RowBox[{"[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "2"}], "]"}], "]"}], ")"}]}], "]"}], "]"}], 
         "&"}], "/@", 
        RowBox[{"FacePosition", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pp1", "=", 
       RowBox[{"DeleteDuplicates", "@", "pos0"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "pp1", "]"}], "==", 
         RowBox[{
          RowBox[{"Length", "[", "pos0", "]"}], "/", "2"}]}], ",", 
        RowBox[{"Triangles", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"Unevaluated", "[", 
         RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "FacePosition"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8901517244205513`*^9, 3.890151729291849*^9}},
 CellLabel->
  "In[557]:=",ExpressionUUID->"381e6d30-0182-48ea-a19c-dc4060a475aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BulkFacesPosition", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"TetFaces", ",", "#"}], "]"}], "&"}], "/@", "BulkFaces"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.890151737181992*^9, 3.890151737186417*^9}},
 CellLabel->
  "In[558]:=",ExpressionUUID->"095c6809-4c03-4250-bf5a-fbcf2eb3f31e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sharedTets", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Intersection", "[", 
        RowBox[{
         RowBox[{"Tets", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"Tets", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "Tets"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"i", "+", "1"}], ",", 
         RowBox[{"Length", "@", "Tets"}]}], "}"}]}], "]"}], ",", "2"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{"sharedTetsPos", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{"Tets", ",", "#"}], "]"}], "&"}], "/@", 
   "sharedTets"}]}]}], "Input",
 CellChangeTimes->{{3.8901517549481688`*^9, 3.890151759029138*^9}, 
   3.890227842717255*^9, {3.912887986533901*^9, 3.912888001141946*^9}},
 CellLabel->
  "In[559]:=",ExpressionUUID->"e5c02916-5d63-4fde-b9c6-99a9c0cab218"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.890227843236927*^9, 3.890227891221222*^9, 3.8902436738279953`*^9, 
   3.890306183367036*^9, 3.890317510955749*^9, 3.890317615415118*^9, 
   3.890317705172036*^9, 3.890319498992116*^9, 3.890324881193138*^9, 
   3.890401296352784*^9, 3.890401339417185*^9, 3.8904117631338387`*^9, 
   3.890413696039425*^9, 3.8904142549132557`*^9, 3.8904159127223988`*^9, 
   3.8904178971102858`*^9, 3.8904736028646593`*^9, 3.8904741729368963`*^9, 
   3.8904749280295877`*^9, 3.890475917879848*^9, 3.890476004378228*^9, 
   3.890575785975849*^9, 3.8905779571002293`*^9, 3.890578559384572*^9, 
   3.890578673866578*^9, 3.89057927068388*^9, 3.8907520208507233`*^9, 
   3.890819944275814*^9, 3.890835766067442*^9, 3.89085008170975*^9, 
   3.8910960142647552`*^9, 3.891167117083187*^9, 3.891180087546566*^9, 
   3.891182160471737*^9, 3.891184712215312*^9, 3.891191968202798*^9, 
   3.8911920357658653`*^9, 3.891194693905278*^9, 3.8913518756493196`*^9, 
   3.891424217343348*^9, 3.891425378101426*^9, 3.8914260357353086`*^9, 
   3.891426277139287*^9, 3.891426548184017*^9, 3.891426825288747*^9, 
   3.893218005958034*^9, 3.8932191278370657`*^9, 3.8932197334544477`*^9, {
   3.912887980250564*^9, 3.9128880022038603`*^9}, 3.912892202342752*^9, 
   3.912895066913487*^9, 3.912895208629304*^9, 3.912895563430917*^9, 
   3.9128962965548363`*^9, 3.912896770782424*^9, 3.912904870975071*^9, 
   3.914512425280304*^9, 3.914512606442607*^9, 3.9145146007571507`*^9, 
   3.91451745914474*^9, 3.914518079682693*^9, 3.914581354350618*^9, 
   3.914583296556579*^9, 3.914583921438747*^9, 3.914599959276105*^9, 
   3.918402071069046*^9, 3.9184021519685583`*^9, 3.91840242272873*^9, 
   3.918647936669894*^9, 3.918648543754115*^9, 3.9186490782994347`*^9, 
   3.918649112059669*^9, 3.9186491459775877`*^9, 3.918654451769956*^9, 
   3.9186548720056267`*^9, 3.918655459568959*^9, 3.9186630086994123`*^9, 
   3.91880892107582*^9, 3.918809422387492*^9, 3.918810219446966*^9, 
   3.9188113734907513`*^9, 3.918813356924179*^9, 3.9188136294174967`*^9, 
   3.918816574435185*^9, 3.918817516606804*^9, 3.918819343529888*^9, 
   3.918819720670723*^9, 3.918820025796792*^9, 3.918820238558642*^9, 
   3.9188204120333023`*^9, 3.918820633781419*^9, 3.918820763500568*^9, 
   3.918821083961033*^9, 3.918821362270711*^9, 3.918923765113398*^9},
 CellLabel->
  "Out[560]=",ExpressionUUID->"ff75c0e1-a051-42f7-a05e-e6aac703dcd7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"orderBulk", "[", 
   RowBox[{"FacesPosition_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "selectlinks", ",", "templist", ",", "pos", ",", "pos2", ",", "test2", 
      ",", "templist2", ",", "testkappa", ",", "tempfaces", ",", "posnew"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"selectlinks", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"sharedTetsPos", ",", "#"}], "]"}], ",", "#", ",", 
          RowBox[{"Unevaluated", "[", 
           RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"Subsets", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"FacesPosition", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "All", ",", 
             RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"templist", "=", 
      RowBox[{"selectlinks", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Length", "@", "templist"}], ")"}], "<", 
        RowBox[{"(", 
         RowBox[{"Length", "@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"selectlinks", ",", "1"}], "]"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"pos", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "==", "1"}], ",", "#", ",", 
             
             RowBox[{"Unevaluated", "[", 
              RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Position", "[", 
           RowBox[{"selectlinks", ",", 
            RowBox[{"templist", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"templist", ",", 
              RowBox[{"selectlinks", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
            ",", 
            RowBox[{"Unevaluated", "[", 
             RowBox[{"Sequence", "[", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"templist", ",", 
               RowBox[{"selectlinks", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
             ";", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"templist", ",", 
               RowBox[{"selectlinks", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}]}]}], "]"}],
                 "]"}]}], "]"}]}]}], "]"}], "&"}], "/@", "pos"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"tempfaces", "=", 
      RowBox[{"FacesPosition", "[", 
       RowBox[{"[", 
        RowBox[{"k", ",", "All", ",", 
         RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posnew", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"tempfaces", ",", "#"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], "/@", "templist"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"FacesPosition", "[", 
        RowBox[{"[", 
         RowBox[{"k", ",", "#"}], "]"}], "]"}], "&"}], "/@", "posnew"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{3.89015177043431*^9},
 CellLabel->
  "In[561]:=",ExpressionUUID->"f4892534-b283-48f4-b1af-4592d49a94f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"orderBDry", "[", 
   RowBox[{"FacesPosition_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"innerorder", ",", "comp"}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"(", 
         RowBox[{"FacesPosition", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ")"}]}], "==", "2"}], ",", 
      RowBox[{"FacesPosition", "[", 
       RowBox[{"[", "k", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"innerorder", "=", 
        RowBox[{"orderBulk", "[", 
         RowBox[{"FacesPosition", ",", "k"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"comp", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"FacesPosition", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", "innerorder"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"comp", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "==", 
          RowBox[{"innerorder", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"comp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "innerorder", ",", 
           RowBox[{"{", 
            RowBox[{"comp", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"comp", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", "innerorder", ",", 
           RowBox[{"{", 
            RowBox[{"comp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.890151376854207*^9, 3.89015143570779*^9, 
  3.890151797315365*^9},
 CellLabel->
  "In[562]:=",ExpressionUUID->"62c8938a-a58f-4d53-ac8b-5ef4d0058544"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OrderBulkFacestest1", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"orderBulk", "[", 
       RowBox[{"BulkFacesPosition", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "@", "BulkFacesPosition"}]}], "}"}]}], "]"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OrderBDryFacestest1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"orderBDry", "[", 
      RowBox[{"BDFacesPosition", ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "BDFacesPosition", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.890151807405429*^9, 3.890151807407804*^9}},
 CellLabel->
  "In[563]:=",ExpressionUUID->"db678403-e4e6-412d-9838-ad5544d16bc6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OrderBDryFaces", "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "test1", "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"test1", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"kappa", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"OrderBDryFacestest1", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"test1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", "1"}], ",", 
           RowBox[{"OrderBDryFacestest1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"Reverse", "[", 
            RowBox[{"OrderBDryFacestest1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "OrderBDryFacestest1"}]}], "}"}]}], "]"}]}], 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OrderBulkFaces", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "test1", "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"test1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"kappa", "[", 
            RowBox[{"[", 
             RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"OrderBulkFacestest1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"test1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{"OrderBulkFacestest1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"Reverse", "[", 
           RowBox[{"OrderBulkFacestest1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "OrderBulkFacestest1"}]}], "}"}]}], "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.890151821822483*^9, 3.8901518218267927`*^9}, {
  3.891426037460335*^9, 3.891426040769945*^9}},
 CellLabel->
  "In[565]:=",ExpressionUUID->"7a054ed2-5030-4e08-85fb-d29914dfe64a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"kappa", "[", 
      RowBox[{"[", 
       RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"OrderBDryFaces", "[", 
     RowBox[{"[", "i", "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "@", "OrderBDryFaces"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.912888030230986*^9, 3.9128880582268343`*^9}},
 CellLabel->
  "In[567]:=",ExpressionUUID->"1e1f08bb-5552-4822-a6c0-ab69f163bb18"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", "1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", "1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", "1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", "1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQB+KOqUH3bdXfOgrt935qD6RVuOO8HYG0ML9oLIhmnJrX
CaJrVgs9BdEpzyIVnIC04N/7Im5AOqdDkzVc663jh9vnpEH0pBMSohFA+lRs
alUkkI7q/XYcRKtd915bAaTnlwotqATSMpf13oHoN60vDzUC6WXmj50OGb51
LLz23wdEc+2/ngeisz+JBlgZvXV0WPxzNoh+ZXfqHojed5PpMYiOZHd4DqKb
nlbW2QJpvg6GzSD64/GiPyA6q018jSOQNipVft0BpDO8zmp2Aunc3vxeEL1k
8QbZLiBt+2ieaDeQPvF4nTmIzjh/bnkPkL4pPkW2F0ivXvKRsQ9IX7cXMwTR
zrpW4SCaq+ByIYi+eruxHUSL3bVcDKLN7xdsBtEpp+tvg2jmLZ7/QHROzpJ/
B4A0ACmOtGg=
  "],
 CellLabel->
  "Out[567]=",ExpressionUUID->"6610d3c2-6e5f-4dce-9356-7a707043f77e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Match faces and Gauge fixing ", "Section",
 CellChangeTimes->{{3.914583227429459*^9, 3.914583245005979*^9}, {
  3.9149304443639927`*^9, 
  3.914930457829183*^9}},ExpressionUUID->"fdf6a17b-845c-40dd-99dd-\
458087b41466"],

Cell[CellGroupData[{

Cell["Match face \[Xi]", "Subsection",
 CellChangeTimes->{
  3.887041932407886*^9, {3.8892872011394463`*^9, 3.889287215388069*^9}, {
   3.889522774102745*^9, 
   3.8895227859116287`*^9}},ExpressionUUID->"6e7047fe-0eab-44fe-84f5-\
117f1d33e0f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tetchange", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"sharedTetsPos", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "sharedTetsPos"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[568]:=",ExpressionUUID->"d6899ffb-f89c-4b15-86cc-8dae5eaad5c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getSO12", "[", 
   RowBox[{"nabchange_", ",", "nabref_", ",", "sgndet_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "variables", ",", "varias", ",", "eta", ",", "soln", ",", "somatrix", 
      ",", "condition1", ",", "condition2", ",", "condition3"}], "}"}], ",", 
    RowBox[{
     RowBox[{"variables", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<x\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", 
          RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"varias", "=", 
      RowBox[{"Flatten", "[", "variables", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eta", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"sgndet", "==", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"soln", "=", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"variables", ".", 
                RowBox[{"nabchange", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "==", 
               RowBox[{"nabref", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "4"}], "}"}]}], "]"}], ",", "1"}], "]"}], ",",
          "varias"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"somatrix", "=", 
      RowBox[{"variables", "/.", "soln"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"condition1", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "somatrix", "]"}], ".", "eta", ".", 
         "somatrix"}], "-", "eta"}], "//", "FullSimplify"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"condition3", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"somatrix", ".", 
         RowBox[{"nabchange", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "-", 
        RowBox[{"nabref", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], "//", "FullSimplify"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"Total", "[", 
           RowBox[{"condition1", ",", "2"}], "]"}], "]"}], "==", "0"}], "&&", 
        
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"Total", "[", 
           RowBox[{"condition3", ",", "2"}], "]"}], "]"}], "==", "0"}]}], ",",
        "somatrix", ",", "\"\<Wrong normals\>\""}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9128883585406637`*^9, 3.9128884069096737`*^9}, {
   3.9128884508659782`*^9, 3.9128884550519733`*^9}, {3.912888496883873*^9, 
   3.912888522068325*^9}, {3.912888559434184*^9, 3.912888585282814*^9}, {
   3.912888674801949*^9, 3.912888714289279*^9}, {3.9128887551190157`*^9, 
   3.9128887920656567`*^9}, 3.912891101469089*^9, {3.912895407272757*^9, 
   3.9128954885681477`*^9}, {3.912899010303334*^9, 3.912899089717561*^9}, 
   3.912899220061768*^9, 3.912924527744697*^9, 3.912925142533092*^9, {
   3.914592450171195*^9, 3.9145924843362293`*^9}, {3.914600556166317*^9, 
   3.914600568866695*^9}, 3.914601341163712*^9},
 CellLabel->
  "In[569]:=",ExpressionUUID->"415aa5c4-3a5c-4423-90f2-cdbf2ea032f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SOmatrix3dTest", "=", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "pos", "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"Tetchange", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"pos", "=", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"Tetchange", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"getSO12", "[", 
            RowBox[{
             RowBox[{"nabtest", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
             RowBox[{"nabtest", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"sharedTetsPos", "[", 
                 RowBox[{"[", 
                  RowBox[{"pos", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"sharedTetsPos", "[", 
                 RowBox[{"[", 
                  RowBox[{"pos", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
              "]"}], ",", 
             RowBox[{"sgndet", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9129243919627037`*^9, 3.912924399331794*^9}, 
   3.912924534826027*^9, {3.9129251518338213`*^9, 3.912925153246119*^9}, {
   3.9145924956066217`*^9, 3.914592497542864*^9}, 3.914600574834021*^9, 
   3.914601353865726*^9},
 CellLabel->
  "In[570]:=",ExpressionUUID->"201ea1b3-645d-4fd2-a4bf-2c79ea99619b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TetsReflection", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Det", "@", 
          RowBox[{"SOmatrix3dTest", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "==", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}], ",", 
        RowBox[{"Unevaluated", "[", 
         RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", "1"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.912924407302705*^9, 3.912924407495884*^9}, {
   3.912924541915743*^9, 3.912924545735032*^9}, 3.912925161228866*^9, {
   3.912925238378619*^9, 3.912925239218598*^9}},
 CellLabel->
  "In[571]:=",ExpressionUUID->"467cd5b9-6e7f-4b32-8901-8dea4329113a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.91292440786233*^9, 3.912924545981448*^9, 3.912924930283567*^9, 
   3.9129251617939777`*^9, 3.912925239626655*^9, 3.9129254325278788`*^9, 
   3.9129255525740843`*^9, {3.912925648352088*^9, 3.912925676908785*^9}, {
   3.912925836447382*^9, 3.9129258596961727`*^9}, 3.912926194787862*^9, {
   3.914592441069611*^9, 3.914592501622635*^9}, 3.9145997259562597`*^9, 
   3.914600544931059*^9, 3.914929688147097*^9, 3.914929726422124*^9, 
   3.914940414969123*^9, 3.9149414287969923`*^9, 3.91494213938062*^9, 
   3.9183206290236483`*^9, 3.918337997257362*^9, 3.918382254581148*^9, 
   3.918393403173232*^9, 3.9184019281512527`*^9, 3.918817928057035*^9, 
   3.9188193437196836`*^9, 3.918819379207193*^9, 3.918819720741501*^9, 
   3.918819923764233*^9, 3.918820025867362*^9, 3.918820238679944*^9, 
   3.918820412128483*^9, 3.9188206338327923`*^9, 3.918820763596962*^9, 
   3.9188210840567827`*^9, 3.918821362369997*^9, 3.9189237652017813`*^9},
 CellLabel->
  "Out[571]=",ExpressionUUID->"8046e151-c011-446c-bf63-a8dc997e64f7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nabtest4d0", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "R", "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"Tetchange", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "&&", 
          RowBox[{
           RowBox[{"sgndet", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "==", 
           RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"-", 
          RowBox[{"nabtest4d", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"nabtest4d", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.889277782154912*^9, {3.8892778444631767`*^9, 3.889277886300559*^9}, {
   3.889522513544841*^9, 3.889522553064991*^9}, 3.892005610742289*^9, 
   3.893226250973897*^9, {3.912925791132375*^9, 3.912925792280723*^9}},
 CellLabel->
  "In[572]:=",ExpressionUUID->"13130738-1649-4fa1-bdf0-db7e08d09deb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fourtothree", "[", 
   RowBox[{"n_", ",", "sgndet1_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"sgndet1", ">", "0"}], ",", 
    RowBox[{"Drop", "[", 
     RowBox[{"n", ",", "1"}], "]"}], ",", 
    RowBox[{"Drop", "[", 
     RowBox[{"n", ",", 
      RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nabtest0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"fourtothree", "[", 
        RowBox[{"#", ",", 
         RowBox[{"sgndet", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
      RowBox[{"nabtest4d0", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9129258007326593`*^9, 3.9129258058175287`*^9}},
 CellLabel->
  "In[573]:=",ExpressionUUID->"a2f80fb3-3351-4e93-bcc1-26b5791c3d4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SOmatrix3d", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "pos", "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"Tetchange", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"pos", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"Tetchange", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"getSO12", "[", 
           RowBox[{
            RowBox[{"nabtest0", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"nabtest0", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"sharedTetsPos", "[", 
                RowBox[{"[", 
                 RowBox[{"pos", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"sharedTetsPos", "[", 
                RowBox[{"[", 
                 RowBox[{"pos", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], 
             "]"}], ",", 
            RowBox[{"sgndet", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9129262160490313`*^9, 3.912926217578203*^9}, 
   3.914929699527957*^9},
 CellLabel->
  "In[575]:=",ExpressionUUID->"a81658cf-ad43-4ed3-8ebd-9815baf2429b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SO4d", "[", 
   RowBox[{"SO_", ",", "sgndet_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "SO4", "}"}], ",", 
    RowBox[{
     RowBox[{"SO4", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"sgndet", ">", "0"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Insert", "[", 
             RowBox[{"#", ",", "0", ",", "1"}], "]"}], "&"}], "/@", "SO"}]}], 
         "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Insert", "[", 
             RowBox[{"#", ",", "0", ",", 
              RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", "SO"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SO4", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ">", "0"}], ",", "SO4", ",", 
       
       RowBox[{"-", "SO4"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.889289750485375*^9, 3.889289750488207*^9}, {
  3.889289784241877*^9, 3.889289788892338*^9}, {3.8892899353573503`*^9, 
  3.889289936006608*^9}, {3.914592582634153*^9, 3.9145925999215927`*^9}},
 CellLabel->
  "In[576]:=",ExpressionUUID->"9d18ab4f-de7d-4634-8491-274d0a6f0a34"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SOmatrix4d", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SO4d", "[", 
       RowBox[{
        RowBox[{"SOmatrix3d", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"sgndet", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "5"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.889289969007093*^9, 3.889290021952251*^9}, {
  3.889290091511056*^9, 3.889290092679631*^9}, {3.88929145813617*^9, 
  3.8892914618649387`*^9}, {3.88929182443608*^9, 3.889291826766333*^9}, {
  3.895354305413848*^9, 3.895354306046891*^9}, {3.896732694517623*^9, 
  3.8967327045693207`*^9}, {3.9145925135206203`*^9, 3.914592536991308*^9}},
 CellLabel->
  "In[577]:=",ExpressionUUID->"411dde82-7e1b-4b38-b04b-9751d5f0349b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solgso13test0", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "R", "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"TetsReflection", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"-", 
          RowBox[{"solgso13test", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"solgso13test", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.88928387802666*^9, 3.889283879234851*^9}, {
   3.889522642597453*^9, 3.889522689527788*^9}, 3.893484290037387*^9, {
   3.8952796913444977`*^9, 3.895279718258617*^9}, {3.8952816661472273`*^9, 
   3.895281686891614*^9}, 3.8952897326325703`*^9, 3.89529035591416*^9, 
   3.895290770194153*^9, 3.895354329911825*^9, {3.912925896115802*^9, 
   3.912925896525762*^9}},
 CellLabel->
  "In[578]:=",ExpressionUUID->"d429a0bf-e83a-4bbd-bdff-3431ae4a5a62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solgso13test1", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "R", "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"Tetchange", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"solgso13test0", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ".", 
          RowBox[{"SOmatrix4d", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"solgso13test0", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.889522814443791*^9, 3.889522852961232*^9}, {
  3.8895229591101418`*^9, 3.889523055525381*^9}, {3.893484907886806*^9, 
  3.893484908713642*^9}, {3.894656656982377*^9, 3.8946566710249863`*^9}, {
  3.895289287809668*^9, 3.895289292758061*^9}, {3.8952894404039288`*^9, 
  3.8952894424860992`*^9}, {3.895359225892811*^9, 3.8953592356095867`*^9}, {
  3.895386666563551*^9, 3.895386684467483*^9}, {3.912925970354279*^9, 
  3.912925976947652*^9}},
 CellLabel->
  "In[579]:=",ExpressionUUID->"53bf9186-cce3-48bf-93c5-b9ee0d2693b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getsl2cfromso13", "[", "so13_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sl2cg", ",", "a1", ",", "a2", ",", "b1", ",", "b2", ",", "c1", ",", 
      "c2", ",", "d1", ",", "d2", ",", "so13fromsl2c", ",", "eqns", ",", 
      "solns1", ",", "solns"}], "}"}], ",", 
    RowBox[{
     RowBox[{"sl2cg", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a1", "+", 
           RowBox[{"I", " ", "a2"}]}], ",", 
          RowBox[{"b1", "+", 
           RowBox[{"I", " ", "b2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c1", "+", 
           RowBox[{"I", " ", "c2"}]}], ",", 
          RowBox[{"d1", "+", 
           RowBox[{"I", " ", "d2"}]}]}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"so13fromsl2c", "=", "\[IndentingNewLine]", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "2"}], " ", 
           RowBox[{"Tr", "[", 
            RowBox[{"sl2cg", ".", 
             RowBox[{"sigmabar4", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ".", 
             RowBox[{"ConjugateTranspose", "[", "sl2cg", "]"}], ".", 
             RowBox[{"sigmabar4", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a1", ",", "a2", ",", "b1", ",", "b2", ",", "c1", ",", "c2", ",", 
            "d1", ",", "d2"}], "}"}], "\[Element]", "Reals"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"eqns", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"so13fromsl2c", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
             RowBox[{
              RowBox[{"Inverse", "[", "so13", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "==", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ReIm", "[", 
              RowBox[{"Det", "@", "sl2cg"}], "]"}], "==", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], ",", 
            RowBox[{"Assumptions", "->", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "a1", ",", "a2", ",", "b1", ",", "b2", ",", "c1", ",", "c2", 
                ",", "d1", ",", "d2"}], "}"}], "\[Element]", "Reals"}]}]}], 
           "]"}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"solns1", "=", 
      RowBox[{"FindInstance", "[", 
       RowBox[{"eqns", ",", 
        RowBox[{"{", 
         RowBox[{
         "a1", ",", "a2", ",", "b1", ",", "b2", ",", "c1", ",", "c2", ",", 
          "d1", ",", "d2"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "solns1"}], "==", "0"}], ",", 
       RowBox[{"sl2cg", "/.", 
        RowBox[{
         RowBox[{"FindInstance", "[", 
          RowBox[{"eqns", ",", 
           RowBox[{"{", 
            RowBox[{
            "a1", ",", "a2", ",", "b1", ",", "b2", ",", "c1", ",", "c2", ",", 
             "d1", ",", "d2"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"sl2cg", "/.", 
        RowBox[{"solns1", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.912894377703849*^9, 3.9128945256499443`*^9}, {
   3.912899635732485*^9, 3.9128996745774107`*^9}, {3.9129001179625998`*^9, 
   3.9129001204924192`*^9}, 3.912925719057996*^9, {3.914592623165715*^9, 
   3.914592649686947*^9}},
 CellLabel->
  "In[580]:=",ExpressionUUID->"58d940c1-7152-4acd-9b4d-221074b0997e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sl2ctest1", "=", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "R", "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"Tetchange", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"-", 
           RowBox[{"getsl2cfromso13", "[", 
            RowBox[{"solgso13test1", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"sl2ctest", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8892838955329523`*^9, 3.889283912742174*^9}, {
   3.889523150792326*^9, 3.889523199005392*^9}, {3.889525387750545*^9, 
   3.889525388807693*^9}, {3.889812413685589*^9, 3.889812464061943*^9}, {
   3.889815240666211*^9, 3.889815256330332*^9}, 3.893484924460408*^9, {
   3.894655751756851*^9, 3.894655753215891*^9}, 3.907152384118629*^9, 
   3.907152648026381*^9, 3.907152853468629*^9, 3.9083554682096653`*^9, 
   3.9083554987824907`*^9, {3.912925998960861*^9, 3.912926005011075*^9}, {
   3.914592705153162*^9, 3.914592707011117*^9}},
 CellLabel->
  "In[581]:=",ExpressionUUID->"4b224eff-15d1-40a9-b411-85fd0f0a895a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sl2cchange", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Inverse", "[", 
       RowBox[{"sl2ctest", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ".", 
      RowBox[{"sl2ctest1", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.889289012120015*^9, 3.889289052842453*^9}, 
   3.889289090964367*^9, {3.8895233279467382`*^9, 3.8895233425161953`*^9}, {
   3.889523492779954*^9, 3.889523494914977*^9}, 3.889525435412792*^9, 
   3.88952548378609*^9, {3.889525537454844*^9, 3.889525565461247*^9}, {
   3.912926023742367*^9, 3.912926024448806*^9}},
 CellLabel->
  "In[582]:=",ExpressionUUID->"b3d97911-6808-4159-89a5-02fc9f4c851c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bdybivec55stest1", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Off", "[", 
        StyleBox[
         RowBox[{"N", "::", "meprec"}], "MessageName"], "]"}], ";", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{"sl2cchange", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ".", "#", ".", 
          RowBox[{"sl2cchange", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "&"}], "/@", 
        RowBox[{"bdybivec55stest", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "5"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.889289096131838*^9, 3.889289156013246*^9}, {
  3.88952359366396*^9, 3.889523610926903*^9}, {3.8895270357738857`*^9, 
  3.889527053413356*^9}, {3.889638936292755*^9, 3.889638945904848*^9}, {
  3.8925614267696323`*^9, 3.892561430642309*^9}, {3.896303229136896*^9, 
  3.8963032351936817`*^9}, {3.89673271532456*^9, 3.896732716650652*^9}, {
  3.912926051879142*^9, 3.912926053103527*^9}, {3.914592660181003*^9, 
  3.914592662036544*^9}, {3.914592696822846*^9, 3.914592698674*^9}},
 CellLabel->
  "In[583]:=",ExpressionUUID->"3a30565a-5643-4bf8-a192-f7159c59b32a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sl2ctest1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sgndet", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "==", "1"}], ",", 
         RowBox[{"Inverse", "[", 
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"sl2ctest1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"I", "*", 
          RowBox[{
           RowBox[{"Inverse", "[", 
            RowBox[{"ConjugateTranspose", "[", 
             RowBox[{"sl2ctest1", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], ".", 
           RowBox[{"PauliMatrix", "[", "3", "]"}]}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.9067568034387608`*^9, 3.906756821233796*^9}, 
   3.9071685514888363`*^9, {3.907168947130753*^9, 3.907168949733355*^9}, 
   3.909614979842779*^9, {3.9129260470747433`*^9, 3.91292604765481*^9}, {
   3.918648105312796*^9, 3.918648117099791*^9}},
 CellLabel->
  "In[584]:=",ExpressionUUID->"3bafd588-35fa-4784-b45d-c125c27ec105"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tetn0signtest1", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sgndet", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "i"}], "]"}], "]"}], "==", "1"}], ",", "1", 
            ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"tetareasign", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "==", 
               RowBox[{"-", "1"}]}], ",", "1", ",", 
              RowBox[{"Sign", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Tr", "[", 
                  RowBox[{
                   RowBox[{"bdybivec55stest1", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], ".", 
                   RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}], "//", 
                 "N"}], "//", "Chop"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"bdybivec55stest1", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "i"}], "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], "//", 
    "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.887041972380761*^9, 3.8870419723837433`*^9}, {
   3.889289236819891*^9, 3.889289254431449*^9}, {3.889523782232325*^9, 
   3.889523789851612*^9}, {3.8902150009286757`*^9, 3.890215002387211*^9}, 
   3.895288193068037*^9, {3.8952883369522*^9, 3.895288337458848*^9}, {
   3.912926063777102*^9, 3.9129260718132143`*^9}},
 CellLabel->
  "In[585]:=",ExpressionUUID->"a490e974-9ed2-4bb7-a4e1-ce013a00d4ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bdysutest1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"getsufrombivec", "[", 
        RowBox[{
         RowBox[{"bdybivec55stest1", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
         RowBox[{"sgndet", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"tetareasign", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
         RowBox[{"tetn0signtest1", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.887041979145692*^9, 3.8870419791486*^9}, {
   3.889289257000967*^9, 3.889289267892582*^9}, {3.889523794943407*^9, 
   3.8895238039351788`*^9}, {3.88952611143642*^9, 3.889526111623496*^9}, {
   3.8952841082869263`*^9, 3.8952841350872793`*^9}, 3.8954810620257063`*^9, {
   3.896301000718171*^9, 3.8963010017654467`*^9}, {3.896732729729971*^9, 
   3.8967327384778423`*^9}, {3.912926076210236*^9, 3.9129260786814413`*^9}, {
   3.9145926688654737`*^9, 3.91459267082277*^9}, {3.914931220004508*^9, 
   3.914931269478957*^9}},
 CellLabel->
  "In[586]:=",ExpressionUUID->"21224414-9bde-4864-9250-dc46179f1af2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bdyxitest1", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"getxifromsu", "[", 
         RowBox[{
          RowBox[{"bdysutest1", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"sgndet", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{"tetareasign", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"tetn0signtest1", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.895284112896763*^9, 3.895284116813086*^9}, 
   3.8952854337505627`*^9, {3.9129260825727587`*^9, 3.9129260871393433`*^9}, {
   3.9145926887105503`*^9, 3.9145926906085253`*^9}, 3.914931231593533*^9},
 CellLabel->
  "In[587]:=",ExpressionUUID->"10d4692d-9a82-4cff-a821-9b210c77c2d7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"bdybivec55stest1", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "i"}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "-", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"bdybivec55stest1", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "i"}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
      "sharedTetsPos"}], "//", "N"}], "//", "Chop"}], "//", "Flatten"}], "//",
   "DeleteDuplicates"}]], "Input",
 CellChangeTimes->{{3.887041908569714*^9, 3.887041908572901*^9}, {
   3.8892894009432793`*^9, 3.8892894208097973`*^9}, {3.889523844915847*^9, 
   3.8895238655205593`*^9}, 3.891426633137109*^9, 3.892561457184349*^9, {
   3.89256259244376*^9, 3.892562618108303*^9}, {3.892635303360684*^9, 
   3.89263535317588*^9}, {3.892635813647229*^9, 3.892635815602131*^9}, {
   3.892709937647935*^9, 3.892709943171893*^9}, {3.893430099632565*^9, 
   3.89343010416359*^9}, {3.893477388226556*^9, 3.8934773977821207`*^9}, {
   3.893477461210052*^9, 3.893477462732256*^9}, {3.893499586412842*^9, 
   3.8934995903853083`*^9}, {3.912926093978566*^9, 3.9129260996423397`*^9}, {
   3.914931235929865*^9, 3.914931237234226*^9}},
 CellLabel->
  "In[588]:=",ExpressionUUID->"1ae54e05-9edc-413b-8b43-0549e5dae5ec"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.893477463368235*^9, 3.893477730790008*^9, 3.893484364473575*^9, {
   3.893499577050631*^9, 3.8934995910512037`*^9}, 3.893500036115958*^9, 
   3.893683999694386*^9, 3.894078297493462*^9, 3.8940824629067802`*^9, 
   3.89459221476492*^9, 3.894592667828828*^9, 3.894593829766986*^9, 
   3.8945939408120937`*^9, 3.89465575746666*^9, {3.8946576498221292`*^9, 
   3.894657678284273*^9}, 3.895288514902605*^9, 3.8952899141144247`*^9, 
   3.89538334325495*^9, 3.8954396533903646`*^9, 3.89547306952248*^9, 
   3.895475250731638*^9, 3.89548195184046*^9, 3.8954840903073597`*^9, 
   3.8955705542485*^9, 3.895692822107522*^9, 3.895692934489789*^9, 
   3.895695485418068*^9, 3.895695939733041*^9, 3.8956962311769257`*^9, 
   3.895828710124238*^9, 3.895873581031019*^9, 3.8958736613034163`*^9, 
   3.89630072098074*^9, 3.8963009852542686`*^9, 3.896301654471457*^9, 
   3.896303345138905*^9, 3.896303932025681*^9, 3.896691896803544*^9, 
   3.896733023606032*^9, 3.8967367143894987`*^9, 3.896815907949546*^9, 
   3.896816727806417*^9, 3.896818068775958*^9, 3.896819467358691*^9, 
   3.896819918699792*^9, 3.896823569163292*^9, 3.896826748211589*^9, 
   3.8968356926410007`*^9, 3.896839834715987*^9, 3.896841407848847*^9, 
   3.896921450344989*^9, 3.897367439559897*^9, 3.898500134896926*^9, 
   3.898639317196748*^9, 3.898639621183029*^9, 3.898640196873042*^9, 
   3.898640302488976*^9, 3.898648131370212*^9, 3.898648216315604*^9, 
   3.8986483299246387`*^9, 3.898648570187764*^9, 3.898649295447659*^9, 
   3.898649433319628*^9, 3.8986495590342607`*^9, 3.898651881810133*^9, 
   3.8991558235776987`*^9, 3.899168316897112*^9, 3.8991685530105*^9, 
   3.899173091407694*^9, 3.899173931082005*^9, 3.8998010544192877`*^9, 
   3.902571354669736*^9, 3.903023771427067*^9, 3.903081088535733*^9, 
   3.903296703890237*^9, 3.907152262871117*^9, 3.907152404498983*^9, 
   3.907153445439237*^9, 3.9071539283923807`*^9, 3.907168599524193*^9, 
   3.907248750508938*^9, 3.907251231944397*^9, 3.908356462615529*^9, 
   3.908442924432641*^9, 3.909306568401828*^9, 3.909310462644191*^9, 
   3.90931197909142*^9, 3.909314467453364*^9, 3.909484508333498*^9, 
   3.909507610558434*^9, 3.909615044318521*^9, 3.9096941766155*^9, 
   3.909762276316882*^9, 3.909768383849489*^9, 3.909864305424643*^9, 
   3.911125118628789*^9, 3.9111253759017353`*^9, 3.911125586446926*^9, 
   3.911125714858775*^9, 3.911125788590639*^9, 3.9111258879075727`*^9, 
   3.911125987034851*^9, 3.911126099871512*^9, 3.911126183469842*^9, 
   3.9111272051300697`*^9, 3.911314082803791*^9, 3.911379025038664*^9, 
   3.91137907823806*^9, 3.911379478800706*^9, 3.911379567010374*^9, 
   3.9113802721364107`*^9, 3.911557480016954*^9, 3.911591213544674*^9, 
   3.911591499089334*^9, 3.9115917813140907`*^9, 3.911591902765292*^9, 
   3.911591992352806*^9, 3.911592192016275*^9, 3.9115924953270807`*^9, 
   3.9115928152468023`*^9, 3.91159302274118*^9, 3.911593210731639*^9, 
   3.911593508913596*^9, 3.9115963123958597`*^9, 3.911596981694236*^9, 
   3.9115971107335052`*^9, 3.911598974678689*^9, 3.9115990615834*^9, 
   3.911599174373926*^9, 3.911599246584297*^9, 3.911599519484189*^9, 
   3.911599662712716*^9, 3.911600226970742*^9, 3.9116006464464493`*^9, 
   3.911600787541514*^9, 3.911601038186932*^9, 3.911601159356963*^9, 
   3.9129257508117*^9, 3.912926101455784*^9, 3.9129262861414213`*^9, {
   3.9145924419666653`*^9, 3.914592492056439*^9}, 3.914592677587152*^9, 
   3.914599727385521*^9, 3.9146005463788958`*^9, 3.914929737501924*^9, 
   3.914931237704629*^9, 3.914931274873971*^9, 3.914940421138398*^9, 
   3.9149414350539637`*^9, 3.914942140443636*^9, 3.918320629650372*^9, 
   3.9183934190733433`*^9, 3.918401928715777*^9, 3.918817928636969*^9, 
   3.9188193503465357`*^9, 3.918819385749802*^9, 3.9188197273840027`*^9, 
   3.918819930394112*^9, 3.91882003253204*^9, 3.918820245355158*^9, 
   3.918820419599378*^9, 3.918820640421064*^9, 3.918820771010644*^9, 
   3.9188210913561296`*^9, 3.918821369801157*^9, 3.918923772743396*^9},
 CellLabel->
  "Out[588]=",ExpressionUUID->"50579ddd-f296-451a-9c91-82b8178bf5cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check parallel transport and closure condition", "Subsubsection",
 CellChangeTimes->{{3.887041868500998*^9, 3.8870418800633183`*^9}, 
   3.9184019551940317`*^9},ExpressionUUID->"e85f810f-a90a-4ea9-97a2-\
ac9aa0925e54"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sl2ctest1", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "i"}], "]"}], "]"}], ".", 
             RowBox[{"bdybivec55stest1", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{"sl2ctest1", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"sl2ctest1", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "j"}], "]"}], "]"}], ".", 
             RowBox[{"bdybivec55stest1", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "j", ",", "i"}], "]"}], "]"}], ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{"sl2ctest1", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "j"}], "]"}], "]"}], "]"}]}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], "//", 
     "FullSimplify"}], "//", "Chop"}], "//", "Flatten"}], "//", 
  "DeleteDuplicates"}]], "Input",
 CellChangeTimes->{{3.887041898390943*^9, 3.887041898394053*^9}, {
   3.889289360924999*^9, 3.889289380605569*^9}, {3.8895238088518457`*^9, 
   3.8895238320623217`*^9}, 3.891426628233611*^9, {3.912898261155478*^9, 
   3.912898271137733*^9}, {3.912927221880818*^9, 3.912927227486594*^9}},
 CellLabel->
  "In[589]:=",ExpressionUUID->"175176a2-c0ea-40cf-9bbd-1b7eb201b5c3"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.891426628721806*^9, 3.893218035964094*^9, 3.893219127909521*^9, 
   3.89321973353082*^9, 3.9128982718701553`*^9, 3.9129031951142263`*^9, 
   3.912904880121558*^9, 3.912927012057906*^9, {3.9129272188718653`*^9, 
   3.912927227977026*^9}, 3.9145924459508257`*^9, {3.9145924887069798`*^9, 
   3.914592499336179*^9}, 3.91459268086714*^9, 3.914592712313398*^9, 
   3.914600547373989*^9, 3.914930200754691*^9, 3.91493127692451*^9, 
   3.9149404213610973`*^9, 3.914941435278447*^9, 3.914942140457222*^9, 
   3.918320629669325*^9, 3.918393419089645*^9, 3.9184019287302713`*^9, 
   3.918817928652927*^9, 3.918819350626902*^9, 3.918819386026628*^9, 
   3.9188197276321363`*^9, 3.918819930653411*^9, 3.918820032781109*^9, 
   3.918820245620719*^9, 3.9188204199112053`*^9, 3.918820640652399*^9, 
   3.9188207713255033`*^9, 3.918821091675639*^9, 3.918821370134624*^9, 
   3.918923773078157*^9},
 CellLabel->
  "Out[589]=",ExpressionUUID->"350a80ab-e2e7-451a-a844-2deb9001086d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"kappa", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "*", 
            RowBox[{"area", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "*", 
            RowBox[{"bdybivec55stest1", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], "//", "Chop"}],
     "//", "FullSimplify"}], "//", "Flatten"}], "//", 
  "DeleteDuplicates"}]], "Input",
 CellChangeTimes->{{3.88704190366236*^9, 3.887041903665422*^9}, {
   3.8892893871263237`*^9, 3.8892893970031233`*^9}, {3.889523835441949*^9, 
   3.8895238415562153`*^9}, 3.8914266303022127`*^9, {3.912898274844475*^9, 
   3.912898302300837*^9}, {3.912927230480042*^9, 3.91292723496418*^9}},
 CellLabel->
  "In[590]:=",ExpressionUUID->"66bd0bca-9cd1-4dca-9df4-565f6ac5c982"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.891426630760272*^9, 3.8932180359705877`*^9, 3.8932191279444227`*^9, 
   3.893219733534079*^9, {3.912898275614347*^9, 3.912898302692358*^9}, 
   3.9129031951454*^9, 3.912904880133473*^9, 3.912927012075251*^9, 
   3.912927235358328*^9, 3.914592680906116*^9, 3.914592712349309*^9, 
   3.914600547469357*^9, 3.9149302007870827`*^9, 3.914931276956483*^9, 
   3.91494042138093*^9, 3.914941435298628*^9, 3.9149421404625053`*^9, 
   3.918320629681631*^9, 3.918393421942799*^9, 3.918401928734006*^9, 
   3.9188179286581583`*^9, 3.91881935065993*^9, 3.9188193860512257`*^9, 
   3.918819727661553*^9, 3.918819930679847*^9, 3.918820032809431*^9, 
   3.918820245649086*^9, 3.918820419940248*^9, 3.9188206406695843`*^9, 
   3.9188207713550797`*^9, 3.918821091705854*^9, 3.9188213701648273`*^9, 
   3.91892377310743*^9},
 CellLabel->
  "Out[590]=",ExpressionUUID->"69880995-ef5d-4098-9c74-8ea141b695e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sl2ctest1", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
             
             RowBox[{"bdybivec55stest1", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "i"}], "]"}], 
              "]"}], ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{"sl2ctest1", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "-", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sl2ctest1", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
             
             RowBox[{"bdybivec55stest1", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "i"}], "]"}], 
              "]"}], ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{"sl2ctest1", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
      "sharedTetsPos"}], "//", "N"}], "//", "Chop"}], "//", "Flatten"}], "//",
   "DeleteDuplicates"}]], "Input",
 CellChangeTimes->{{3.887041908569714*^9, 3.887041908572901*^9}, {
   3.8892894009432793`*^9, 3.8892894208097973`*^9}, {3.889523844915847*^9, 
   3.8895238655205593`*^9}, 3.891426633137109*^9, {3.912898305542966*^9, 
   3.912898316988737*^9}, {3.9129272379860973`*^9, 3.9129272416405582`*^9}},
 CellLabel->
  "In[591]:=",ExpressionUUID->"66d76a0b-96c5-4ad6-b144-c71a690c1faf"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{3.8914266336101303`*^9, 3.8932180359807243`*^9, 
  3.893219127948735*^9, 3.893219733538827*^9, 3.912898317532194*^9, 
  3.9129031951664333`*^9, 3.912904880151782*^9, 3.912927012079228*^9, 
  3.9129272419905167`*^9, 3.914592680918029*^9, 3.914592712354583*^9, 
  3.9146005474768543`*^9, 3.914930200797614*^9, 3.914931276961525*^9, 
  3.9149404213860903`*^9, 3.914941435309661*^9, 3.914942140474764*^9, 
  3.918320629698101*^9, 3.918393425445531*^9, 3.9184019287462378`*^9, 
  3.9188179286741247`*^9, 3.9188193506649837`*^9, 3.918819386059183*^9, 
  3.9188197276664886`*^9, 3.9188199306865587`*^9, 3.9188200328146467`*^9, 
  3.9188202456546288`*^9, 3.918820419945369*^9, 3.918820640674831*^9, 
  3.9188207713683367`*^9, 3.9188210917128963`*^9, 3.918821370179037*^9, 
  3.918923773112103*^9},
 CellLabel->
  "Out[591]=",ExpressionUUID->"e306c4ad-a5a8-43c3-8623-daa9a772a7d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Inverse", "[", 
              RowBox[{"sl2ctest1", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], 
              "]"}], ".", 
             RowBox[{"sl2ctest1", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
             
             RowBox[{"bdybivec55stest1", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "i"}], "]"}], 
              "]"}], ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{
               RowBox[{"Inverse", "[", 
                RowBox[{"sl2ctest1", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], 
                "]"}], ".", 
               RowBox[{"sl2ctest1", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "-", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"bdybivec55stest1", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "i"}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
      "sharedTetsPos"}], "//", "N"}], "//", "Chop"}], "//", "Flatten"}], "//",
   "DeleteDuplicates"}]], "Input",
 CellChangeTimes->{{3.887041917267618*^9, 3.8870419172707987`*^9}, {
   3.8892894239969*^9, 3.8892894450023403`*^9}, {3.8895240889246902`*^9, 
   3.889524115770965*^9}, {3.8896389784701843`*^9, 3.889638983757875*^9}, {
   3.8901507343353786`*^9, 3.890150736945355*^9}, {3.8901519179450617`*^9, 
   3.8901519206932373`*^9}, {3.891425422606263*^9, 3.891425425149048*^9}, 
   3.89142663466971*^9, {3.9128983197375402`*^9, 3.912898329346133*^9}, {
   3.912927243913034*^9, 3.91292724749996*^9}},
 CellLabel->
  "In[592]:=",ExpressionUUID->"2cff1d52-501d-47a7-b1de-f602616ba5c9"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{3.891426635230956*^9, 3.893218035986444*^9, 
  3.893219127960504*^9, 3.89321973354766*^9, 3.912898329755093*^9, 
  3.912903195186071*^9, 3.912904880169527*^9, 3.9129270120916357`*^9, 
  3.9129272478670883`*^9, 3.91459268092507*^9, 3.914592712368288*^9, 
  3.914600547485224*^9, 3.9149302008091993`*^9, 3.914931276972912*^9, 
  3.914940421397953*^9, 3.914941435316793*^9, 3.914942140481511*^9, 
  3.918320629709343*^9, 3.918393425481268*^9, 3.918401928752914*^9, 
  3.9188179286824512`*^9, 3.9188193506788597`*^9, 3.918819386073387*^9, 
  3.9188197276845284`*^9, 3.918819930697983*^9, 3.918820032832591*^9, 
  3.918820245671073*^9, 3.9188204199568663`*^9, 3.918820640687557*^9, 
  3.918820771376419*^9, 3.918821091725855*^9, 3.918821370186316*^9, 
  3.918923773121683*^9},
 CellLabel->
  "Out[592]=",ExpressionUUID->"71ac3e8f-1394-462e-86df-39150951c70e"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SU(1,1) gauge fix", "Subsection",
 CellChangeTimes->{
  3.887042320939084*^9, {3.890304471083496*^9, 3.8903044715317173`*^9}, {
   3.892539030580904*^9, 3.892539034249488*^9}, 3.9149308562733727`*^9, {
   3.918820269095978*^9, 
   3.918820271694633*^9}},ExpressionUUID->"c5f8b8f6-d571-4639-8698-\
17c825fec5a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Gaugespacelike", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "2"}], "}"}]}], "}"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8925267493028393`*^9, 3.892526790312441*^9}, {
   3.892527619197328*^9, 3.892527627237342*^9}, {3.8925641028528357`*^9, 
   3.8925641500357437`*^9}, 3.89256427451167*^9, {3.914933184475366*^9, 
   3.914933189237566*^9}},
 CellLabel->
  "In[593]:=",ExpressionUUID->"2153d7f3-93e3-4799-b8ea-a577d9318015"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Uinverse", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"sharedTetsPos", ",", "1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "i"}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"pos", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"sharedTetsPos", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "i"}], "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"Uinv", "=", 
         RowBox[{"Inverse", "[", 
          RowBox[{"bdysutest1", "[", 
           RowBox[{"[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Gaugespacelike", "[", 
              RowBox[{"[", 
               RowBox[{"pos", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
          "]"}]}]}], ",", 
       RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892526691934733*^9, 3.892526716400188*^9}, {
   3.8925268054299707`*^9, 3.892526866539854*^9}, {3.892526900995422*^9, 
   3.892527038702457*^9}, {3.892527081449835*^9, 3.8925271120046577`*^9}, 
   3.892527288070245*^9, 3.892527455029194*^9, {3.892527636172893*^9, 
   3.892527636544441*^9}, 3.892538950260713*^9, {3.912903991417164*^9, 
   3.9129039938814898`*^9}, {3.912904890274287*^9, 3.912904890482233*^9}},
 CellLabel->
  "In[594]:=",ExpressionUUID->"4a504094-0d1b-48d2-9585-f2d1106d97d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bdyxitest2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Uinverse", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], ".", 
        RowBox[{"bdyxitest1", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Uinverse", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], ".", 
        RowBox[{"bdyxitest1", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i", ",", "j", ",", "2"}], "]"}], "]"}]}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892527376534109*^9, 3.892527434807867*^9}, {
   3.892536654428886*^9, 3.892536686011688*^9}, {3.892538960471249*^9, 
   3.892538963964333*^9}, {3.8925646217409143`*^9, 3.892564631432498*^9}, {
   3.896303099279174*^9, 3.896303107061021*^9}, {3.896732805436442*^9, 
   3.896732807001432*^9}, {3.914930980850607*^9, 3.914930998648315*^9}, 
   3.914931482812305*^9, {3.914933577455968*^9, 3.914933587449732*^9}, {
   3.9149405865443974`*^9, 3.914940591045377*^9}},
 CellLabel->
  "In[595]:=",ExpressionUUID->"3c30d81c-97e4-4651-8048-b9d88386d607"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bdyxitest3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tetareasign", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "==", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"bdyxitest2", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j", ",", "1", ",", "2"}], "]"}], 
             "]"}], "/", 
            RowBox[{"bdyxitest2", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j", ",", "1", ",", "1"}], "]"}], 
             "]"}]}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"Conjugate", "[", 
           RowBox[{"bdyxitest2", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "i", ",", "j", ",", "1", ",", "1"}], "]"}], 
            "]"}], "]"}], "*", 
          RowBox[{"bdyxitest2", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "i", ",", "j", ",", "2"}], "]"}], "]"}]}]}], 
        "}"}], ",", 
       RowBox[{"bdyxitest2", "[", 
        RowBox[{"[", 
         RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892537100690342*^9, 3.892537127659259*^9}, {
  3.912904080390339*^9, 3.912904096434958*^9}, {3.9149405403403187`*^9, 
  3.914940550219068*^9}},
 CellLabel->
  "In[596]:=",ExpressionUUID->"f257b120-d769-4866-b943-d26bf3197e45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Gaugetimelike", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "}"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8925267493028393`*^9, 3.892526790312441*^9}, {
   3.892527619197328*^9, 3.892527627237342*^9}, {3.8925641028528357`*^9, 
   3.8925641500357437`*^9}, 3.89256427451167*^9, {3.892565237307395*^9, 
   3.892565259179222*^9}, 3.892565606496092*^9, 3.9149363978109283`*^9},
 CellLabel->
  "In[597]:=",ExpressionUUID->"238d879c-9233-4d36-bca2-8da894d0919f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"U2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"sharedTetsPos", ",", "1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "i"}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"pos", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"sharedTetsPos", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "i"}], "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"I", "*", 
              RowBox[{
               RowBox[{"Arg", "[", 
                RowBox[{"bdyxitest3", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Gaugetimelike", "[", 
                    RowBox[{"[", 
                    RowBox[{"pos", ",", "1"}], "]"}], "]"}]}], ",", "1", ",", 
                   "2"}], "]"}], "]"}], "]"}], "/", "2"}]}], "]"}], ",", 
            "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "I"}], "*", 
              RowBox[{
               RowBox[{"Arg", "[", 
                RowBox[{"bdyxitest3", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Gaugetimelike", "[", 
                    RowBox[{"[", 
                    RowBox[{"pos", ",", "1"}], "]"}], "]"}]}], ",", "1", ",", 
                   "2"}], "]"}], "]"}], "]"}], "/", "2"}]}], "]"}]}], "}"}]}],
          "}"}]}], ",", 
       RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.892537246437723*^9, {3.892537416898773*^9, 3.892537497714366*^9}, {
   3.892537560842216*^9, 3.8925375927182703`*^9}, 3.8925389392541027`*^9, {
   3.912904151797518*^9, 3.912904165166059*^9}, {3.914931402981742*^9, 
   3.914931404534215*^9}, {3.914940558186222*^9, 3.914940559895409*^9}},
 CellLabel->
  "In[598]:=",ExpressionUUID->"6f8075d8-f769-4238-9a63-1732d75ca222"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bdyxitest4", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"U2", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], ".", 
        RowBox[{"bdyxitest3", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"U2", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i"}], "]"}], "]"}], ".", 
        RowBox[{"bdyxitest3", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i", ",", "j", ",", "2"}], "]"}], "]"}]}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8925376209463663`*^9, 3.8925376492728024`*^9}, {
  3.892537756581531*^9, 3.892537773034597*^9}, {3.892537845986301*^9, 
  3.89253790821767*^9}, {3.8925389829415903`*^9, 3.892538985485497*^9}, {
  3.912904190053835*^9, 3.912904199356428*^9}, {3.914931511942358*^9, 
  3.914931520290584*^9}, {3.914940564260689*^9, 3.914940569162055*^9}},
 CellLabel->
  "In[599]:=",ExpressionUUID->"c1d7b40d-ee49-4220-99c1-8ea47bef519e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bdyxi", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tetareasign", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "==", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"bdyxitest4", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j", ",", "1", ",", "2"}], "]"}], 
             "]"}], "/", 
            RowBox[{"bdyxitest4", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j", ",", "1", ",", "1"}], "]"}], 
             "]"}]}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"Conjugate", "[", 
           RowBox[{"bdyxitest4", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "i", ",", "j", ",", "1", ",", "1"}], "]"}], 
            "]"}], "]"}], "*", 
          RowBox[{"bdyxitest4", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "i", ",", "j", ",", "2"}], "]"}], "]"}]}]}], 
        "}"}], ",", 
       RowBox[{"bdyxitest4", "[", 
        RowBox[{"[", 
         RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892537924998139*^9, 3.892537936706727*^9}, {
  3.8925379785089607`*^9, 3.892537978793737*^9}, {3.892538024838922*^9, 
  3.892538088743939*^9}, {3.892538118869507*^9, 3.8925381293004913`*^9}, {
  3.912904217535014*^9, 3.9129042311467237`*^9}, {3.9129043667706738`*^9, 
  3.912904376516185*^9}, {3.914931546125058*^9, 3.914931557705312*^9}, {
  3.914940572606285*^9, 3.91494057690399*^9}, {3.9149414154057217`*^9, 
  3.914941417292802*^9}, {3.9149419362930307`*^9, 3.9149419378657627`*^9}},
 CellLabel->
  "In[600]:=",ExpressionUUID->"ae17c9e7-3abe-470a-8482-61e43a87082c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sl2ctest2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sl2ctest1", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"Uinverse", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{"U2", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8925382760379543`*^9, 3.892538276399538*^9}, {
  3.892538737800584*^9, 3.89253874014571*^9}, {3.892538794858837*^9, 
  3.892538834551489*^9}, {3.8925388667138147`*^9, 3.892538887455544*^9}, {
  3.8932271729167213`*^9, 3.8932271824950237`*^9}, {3.9129042442958603`*^9, 
  3.9129042849125347`*^9}},
 CellLabel->
  "In[601]:=",ExpressionUUID->"acfa0575-dc90-4d20-a66d-db5a60d5293a"]
}, Closed]],

Cell[CellGroupData[{

Cell["define xi variables", "Subsection",
 CellChangeTimes->{
  3.887042320939084*^9, {3.890304471083496*^9, 
   3.8903044715317173`*^9}},ExpressionUUID->"8c583446-be8f-41c8-99b8-\
72d1cf73ad63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xisoln", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sgndet", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "==", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ArcSin", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"bdyxi", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "1"}], "]"}], 
            "]"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Arg", "[", 
           RowBox[{"bdyxi", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "2"}], "]"}], 
            "]"}], "]"}], "-", 
          RowBox[{"Arg", "[", 
           RowBox[{"bdyxi", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "1"}], "]"}], 
            "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tetareasign", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "==", "1"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"tetn0signtest1", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "==", "1"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ArcCosh", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{"bdyxi", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "1"}], "]"}],
                 "]"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Arg", "[", 
               RowBox[{"bdyxi", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "1"}], "]"}],
                 "]"}], "]"}], "-", 
              RowBox[{"Arg", "[", 
               RowBox[{"bdyxi", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "2"}], "]"}],
                 "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ArcCosh", "[", 
              RowBox[{"Abs", "[", 
               RowBox[{"bdyxi", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "1"}], "]"}],
                 "]"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Arg", "[", 
               RowBox[{"bdyxi", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "1"}], "]"}],
                 "]"}], "]"}], "-", 
              RowBox[{"Arg", "[", 
               RowBox[{"bdyxi", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k", ",", "2", ",", "2"}], "]"}],
                 "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Arg", "[", 
            RowBox[{
             RowBox[{"bdyxi", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "2"}], "]"}], 
              "]"}], "/", 
             RowBox[{"bdyxi", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "1"}], "]"}], 
              "]"}]}], "]"}], ",", 
           RowBox[{"bdyxi", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "1", ",", "1"}], "]"}], 
            "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.891424298642687*^9, 3.891424310790971*^9}, {
   3.893218390406304*^9, 3.8932183937547626`*^9}, {3.893219204898039*^9, 
   3.89321920527586*^9}, {3.912898626971828*^9, 3.9128986343939447`*^9}, {
   3.912904903687731*^9, 3.912904905045858*^9}, {3.9149419457036123`*^9, 
   3.9149419475694103`*^9}, 3.914942041547636*^9},
 CellLabel->
  "In[602]:=",ExpressionUUID->"7c04be06-3864-48bf-9a18-7d4a93c6dcc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zetabdryall", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "==", "j"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sgndet", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i"}], "]"}], "]"}], "==", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<zeta\>\"", "<>", 
                RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                
                RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<$\>\"", "<>", 
                
                RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<$a\>\""}], 
               "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"\"\<zeta\>\"", "<>", 
                 RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                 RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<$\>\"", "<>", 
                 RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<$a\>\""}], 
                "]"}], "]"}], "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", 
                RowBox[{"ToExpression", "[", 
                 RowBox[{"\"\<zeta\>\"", "<>", 
                  RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                  RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<$\>\"", "<>", 
                  RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<$b\>\""}], 
                 "]"}]}], "]"}]}]}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tetareasign", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "==", "1"}], 
             ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"tetn0signtest1", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "==", 
                "1"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cosh", "[", 
                  RowBox[{"ToExpression", "[", 
                   RowBox[{"\"\<zeta\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<$a\>\""}],
                    "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<zeta\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<$b\>\""}],
                     "]"}]}], "]"}], " ", "*", 
                  RowBox[{"Sinh", "[", 
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<zeta\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<$a\>\""}],
                     "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sinh", "[", 
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<zeta\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<$a\>\""}],
                     "]"}], "]"}], "*", 
                  RowBox[{"Exp", "[", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<zeta\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<$b\>\""}],
                     "]"}]}], "]"}]}], ",", 
                 RowBox[{"Cosh", "[", 
                  RowBox[{"ToExpression", "[", 
                   RowBox[{"\"\<zeta\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<$a\>\""}],
                    "]"}], "]"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{"\"\<zeta\>\"", "<>", 
                   RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                   RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<$\>\"", "<>", 
                   RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<$b\>\""}], 
                  "]"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.891422431421183*^9, 3.891422606753326*^9}, {
   3.891422679991036*^9, 3.891422682745875*^9}, 3.8914228111906013`*^9, {
   3.8914228671025887`*^9, 3.8914228768324537`*^9}, {3.891422958592609*^9, 
   3.891422963573786*^9}, {3.893218408794894*^9, 3.8932184123200197`*^9}, {
   3.8932192160174427`*^9, 3.8932192163542347`*^9}, {3.912898765714912*^9, 
   3.912898765926229*^9}, {3.912898798722*^9, 3.912898840908523*^9}, 
   3.912898876485036*^9, {3.91290491406413*^9, 3.912904914257066*^9}},
 CellLabel->
  "In[603]:=",ExpressionUUID->"07d3d6ea-d18b-44d5-9705-cca83c1c13a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zetavariables", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Flatten", "@", 
              RowBox[{"zetabdryall", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}]}], ",", 
             "_Symbol", ",", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "\[ExponentialE]"}], 
         "]"}], ",", "\[Pi]"}], "]"}], "//", "Sort"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.891424504017042*^9, 3.8914246241658983`*^9}, 
   3.893218452697147*^9, {3.912903270043847*^9, 3.912903271976089*^9}},
 CellLabel->
  "In[604]:=",ExpressionUUID->"bf4363b4-2f6a-4c27-8a3e-87fb81d9c82b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zetadata", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "==", "j"}], ",", 
        RowBox[{"Unevaluated", "[", 
         RowBox[{"Sequence", "[", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tetareasign", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "==", "1"}], 
          ",", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"zetavariables", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "->", 
            RowBox[{"xisoln", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"zetavariables", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "->", 
            RowBox[{"xisoln", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j", ",", "1"}], "]"}], "]"}]}], 
           "]"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.912903277759766*^9, 3.9129032821430883`*^9}},
 CellLabel->
  "In[605]:=",ExpressionUUID->"03507d32-3026-4253-a4ea-f6cc5decab6f"]
}, Closed]],

Cell[CellGroupData[{

Cell["define variables", "Subsection",
 CellChangeTimes->{
  3.887042320939084*^9},ExpressionUUID->"406dc209-f1f7-425c-992c-\
b4f6afc99697"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gdataof", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Inverse", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"sl2ctest2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getz", "[", 
    RowBox[{"gsl2c_", ",", "bdxi_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"N", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "==", "0"}], ",", 
       RowBox[{"#", "/", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], " ", ",", 
       RowBox[{"#", "/", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "]"}], "&"}], " ", "@", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Inverse", "[", 
       RowBox[{"Transpose", "[", "gsl2c", "]"}], "]"}], ".", "bdxi"}], 
     ")"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zdataf", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"kappa", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "==", "1"}], "&&", 
           RowBox[{"i", "!=", "j"}]}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"tetareasign", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], ">", "0"}], 
            ",", 
            RowBox[{"getz", "[", 
             RowBox[{
              RowBox[{"gdataof", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"bdyxi", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "i", ",", "j", ",", "1"}], "]"}], "]"}]}], 
             "]"}], ",", 
            RowBox[{"getz", "[", 
             RowBox[{
              RowBox[{"gdataof", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "i"}], "]"}], "]"}], ",", 
              RowBox[{"bdyxi", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "i", ",", "j", ",", "2"}], "]"}], "]"}]}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.887042330653789*^9, 3.887042330656917*^9}, 
   3.88705293124133*^9, 3.889647265104034*^9, {3.89015081821699*^9, 
   3.8901508287454567`*^9}, 3.8901510781807003`*^9, {3.890153225715033*^9, 
   3.890153228373019*^9}, {3.890241919812819*^9, 3.890241944265061*^9}, 
   3.890250369835322*^9, {3.89031801535091*^9, 3.890318029806596*^9}, {
   3.890416455365203*^9, 3.89041645632876*^9}, {3.890583147383873*^9, 
   3.890583167092977*^9}, {3.891097153153569*^9, 3.891097155907346*^9}, 
   3.891097349826651*^9, {3.891097471100054*^9, 3.891097484217012*^9}, {
   3.891183683037284*^9, 3.891183723756735*^9}, {3.891192099925296*^9, 
   3.891192101123149*^9}, {3.891424857284038*^9, 3.891424892993648*^9}, {
   3.893218501786561*^9, 3.8932185028176394`*^9}, {3.8932192470501347`*^9, 
   3.893219251620564*^9}, {3.9129033126214247`*^9, 3.912903319641787*^9}, {
   3.912903364204167*^9, 3.912903367500704*^9}, {3.912904947545046*^9, 
   3.912904947711061*^9}, {3.9149407689032707`*^9, 3.914940769892426*^9}, {
   3.914941395156502*^9, 3.9149413984919233`*^9}, 3.9188175344929323`*^9, 
   3.9188199720161533`*^9, {3.918820005350348*^9, 3.9188200066198606`*^9}, {
   3.918820226547336*^9, 3.9188202283377953`*^9}},
 CellLabel->
  "In[606]:=",ExpressionUUID->"02453a95-be21-44a5-b0dc-68d99a7c71c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GaugeTet", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.890242035066841*^9, 3.890242043121283*^9}, {
  3.890242113853209*^9, 3.890242114087358*^9}, {3.891425954974955*^9, 
  3.891425956255291*^9}, {3.893218061691824*^9, 3.8932180624293137`*^9}, {
  3.912903481587489*^9, 3.912903482784277*^9}},
 CellLabel->
  "In[609]:=",ExpressionUUID->"c438f1ce-c006-4961-a115-6cde4a584fb1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gspecialpos", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"GaugeTet", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "i"}], "}"}]}], "]"}], ",", 
        RowBox[{"Unevaluated", "[", 
         RowBox[{"Sequence", "[", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"gdataof", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "i", ",", "1", ",", "1"}], "]"}], "]"}], "==", 
           "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "i"}], "}"}], ",", 
          RowBox[{"Unevaluated", "[", 
           RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "@", "bdydata"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", "1"}], "]"}]}]], "Input",\

 CellLabel->
  "In[610]:=",ExpressionUUID->"75ac012e-0e5a-47d2-aae7-7bfe3dd3934d"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.8932185308222637`*^9, 3.8932194370021753`*^9, 
  3.893219733620475*^9, 3.9129034861880417`*^9, 3.912904598910261*^9, 
  3.912904880888566*^9, 3.912904953733506*^9, 3.9129273600663548`*^9, 
  3.914940646803108*^9, 3.914940786497258*^9, 3.914942140561585*^9, 
  3.918393435262735*^9, 3.918401928838323*^9, 3.918817928744244*^9, 
  3.9188199817296124`*^9, 3.918820035552919*^9, 3.918820248604*^9, 
  3.918820423693097*^9, 3.9188206438527603`*^9, 3.918820775109405*^9, 
  3.9188210953829517`*^9, 3.918821374143148*^9, 3.9189237770442543`*^9},
 CellLabel->
  "Out[610]=",ExpressionUUID->"1b0a50cb-b185-4745-a052-905aa1836396"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"gvariablesall", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "matrix", "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"GaugeTet", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "i"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"ToExpression", "[", 
                 RowBox[{"\"\<Ga\>\"", "<>", 
                  RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                  RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                RowBox[{"I", "*", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{"\"\<Gac\>\"", "<>", 
                   RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                   RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}], ",", 
               RowBox[{
                RowBox[{"ToExpression", "[", 
                 RowBox[{"\"\<Gb\>\"", "<>", 
                  RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                  RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                RowBox[{"I", "*", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{"\"\<Gbc\>\"", "<>", 
                   RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                   RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"ToExpression", "[", 
                 RowBox[{"\"\<Gc\>\"", "<>", 
                  RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                  RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                RowBox[{"I", " ", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{"\"\<Gcc\>\"", "<>", 
                   RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                   RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}], ",", 
               RowBox[{
                RowBox[{"ToExpression", "[", 
                 RowBox[{"\"\<Gd\>\"", "<>", 
                  RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                  RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                RowBox[{"I", " ", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{"\"\<Gdc\>\"", "<>", 
                   RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                   RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}]}], 
              "}"}]}], "}"}], ",", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"gspecialpos", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "i"}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"matrix", "=", 
             RowBox[{"(", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "+", 
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<ga\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                   RowBox[{"I", " ", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<gac\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}], ",", 
                  "d"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<gb\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                   RowBox[{"I", " ", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<gbc\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<gc\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                   RowBox[{"I", " ", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<gcc\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}]}], 
                 "}"}]}], "}"}], ")"}]}], ";", 
            RowBox[{"matrix", "/.", " ", 
             RowBox[{
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Det", "[", "matrix", "]"}], "==", "1"}], ",", "d"}],
                "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"GaugeFixUpperTriangle", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "i"}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"matrix", "=", 
             RowBox[{"(", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "+", 
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<ga\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], ",", 
                  "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<gc\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                   RowBox[{"I", " ", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<gcc\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}], ",", 
                  "d"}], "}"}]}], "}"}], ")"}]}], ";", "\[IndentingNewLine]", 
            
            RowBox[{"matrix", "/.", " ", 
             RowBox[{
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Det", "[", "matrix", "]"}], "==", "1"}], ",", "d"}],
                "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "True", ",", 
           RowBox[{
            RowBox[{"matrix", "=", 
             RowBox[{"(", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "+", 
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<ga\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                   RowBox[{"I", " ", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<gac\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<gb\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                   RowBox[{"I", " ", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<gbc\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}]}], "}"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<gc\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                   RowBox[{"I", " ", 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<gcc\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}], ",", 
                  "d"}], "}"}]}], "}"}], ")"}]}], ";", 
            RowBox[{"matrix", "/.", " ", 
             RowBox[{
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Det", "[", "matrix", "]"}], "==", "1"}], ",", "d"}],
                "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[611]:=",ExpressionUUID->"c2a592fc-4ee1-4831-b2b6-082b65a4708c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"zspecialPos", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"kappa", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "==", "1"}], 
             "&&", 
             RowBox[{"i", "!=", "j"}]}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Chop", "[", 
                RowBox[{"N", "@", 
                 RowBox[{"zdataf", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", "i", ",", "j", ",", "1"}], "]"}], 
                  "]"}]}], "]"}], "==", "1"}], ",", 
              RowBox[{"Unevaluated", "[", 
               RowBox[{"Sequence", "[", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "i", ",", "j"}], "}"}]}], "]"}], ",", 
            RowBox[{"Unevaluated", "[", 
             RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], ",", "2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.891182920433275*^9, 3.891182920552351*^9}, {
   3.8911831551091633`*^9, 3.8911831892867413`*^9}, 3.8932185649345922`*^9},
 CellLabel->
  "In[612]:=",ExpressionUUID->"10a34ec0-84d6-4981-aa31-7b15e4ba1e8e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"1", ",", "5", ",", "1"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.891183179415036*^9, 3.891183189704646*^9}, 
   3.8911833402506437`*^9, 3.891183582270475*^9, 3.891183758744432*^9, 
   3.8911922754768133`*^9, 3.891352787254055*^9, 3.891424930281191*^9, 
   3.891426106481138*^9, 3.891426277299377*^9, 3.8914270304917803`*^9, 
   3.893218565850423*^9, 3.893219517237365*^9, 3.893219733634076*^9, 
   3.912903556733382*^9, 3.9129045989327173`*^9, 3.912904881036517*^9, 
   3.9129049652647943`*^9, 3.912927360082713*^9, 3.9149406515287952`*^9, 
   3.914940786513735*^9, 3.914942140579754*^9, 3.918393435277853*^9, 
   3.918401928850914*^9, 3.9188179287608957`*^9, 3.9188199817473307`*^9, 
   3.9188200355770607`*^9, 3.918820248626524*^9, 3.91882042371074*^9, 
   3.9188206438704147`*^9, 3.9188207751274843`*^9, 3.918821095404965*^9, 
   3.918821374167676*^9, 3.918923777064364*^9},
 CellLabel->
  "Out[612]=",ExpressionUUID->"e5eb71c6-e18a-4e67-8585-50be3dd81f20"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"zvariablesall", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"kappa", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "==", "1"}], "&&", 
            RowBox[{"i", "!=", "j"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"zspecialPos", ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "i", ",", "j"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"ToExpression", "[", 
                 RowBox[{"\"\<z\>\"", "<>", 
                  RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                  RowBox[{"ToString", "[", "i", "]"}], "<>", 
                  RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "+", 
                RowBox[{"I", " ", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{"\"\<zc\>\"", "<>", 
                   RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                   RowBox[{"ToString", "[", "i", "]"}], "<>", 
                   RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}], ",", 
               "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{
                RowBox[{"ToExpression", "[", 
                 RowBox[{"\"\<z\>\"", "<>", 
                  RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                  RowBox[{"ToString", "[", "i", "]"}], "<>", 
                  RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "+", 
                RowBox[{"I", " ", 
                 RowBox[{"ToExpression", "[", 
                  RowBox[{"\"\<zc\>\"", "<>", 
                   RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                   RowBox[{"ToString", "[", "i", "]"}], "<>", 
                   RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}]}]}], 
              "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.8898066696571817`*^9, 3.889806674828793*^9}, {
   3.8898071789567966`*^9, 3.889807181708653*^9}, {3.889807254134067*^9, 
   3.8898073159423513`*^9}, {3.88980740674065*^9, 3.8898075245132427`*^9}, 
   3.890150957649757*^9, 3.890306073753777*^9, {3.891183397944895*^9, 
   3.891183413462035*^9}, {3.89118380126153*^9, 3.891183803294276*^9}, {
   3.891427007548559*^9, 3.891427011421644*^9}, 3.893218574435255*^9},
 CellLabel->
  "In[613]:=",ExpressionUUID->"35033052-bb44-4dd4-87a3-9de3690217c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gvarias", "=", 
  RowBox[{"DeleteDuplicates", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{"gvariablesall", ",", "_Symbol", ",", 
     RowBox[{"-", "1"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8910977679742737`*^9, 3.8910977727216787`*^9}, 
   3.8932185835377083`*^9},
 CellLabel->
  "In[614]:=",ExpressionUUID->"5c27dae1-ca9d-491a-aa19-eda113d40980"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Ga1$1", ",", "Gac1$1", ",", "Gb1$1", ",", "Gbc1$1", ",", "Gc1$1", ",", 
   "Gcc1$1", ",", "Gd1$1", ",", "Gdc1$1", ",", "ga1$2", ",", "gac1$2", ",", 
   "gb1$2", ",", "gbc1$2", ",", "gc1$2", ",", "gcc1$2", ",", "ga1$3", ",", 
   "gac1$3", ",", "gb1$3", ",", "gbc1$3", ",", "gc1$3", ",", "gcc1$3", ",", 
   "ga1$4", ",", "gac1$4", ",", "gb1$4", ",", "gbc1$4", ",", "gc1$4", ",", 
   "gcc1$4", ",", "ga1$5", ",", "gac1$5", ",", "gb1$5", ",", "gbc1$5", ",", 
   "gc1$5", ",", "gcc1$5", ",", "Ga2$1", ",", "Gac2$1", ",", "Gb2$1", ",", 
   "Gbc2$1", ",", "Gc2$1", ",", "Gcc2$1", ",", "Gd2$1", ",", "Gdc2$1", ",", 
   "ga2$2", ",", "gac2$2", ",", "gb2$2", ",", "gbc2$2", ",", "gc2$2", ",", 
   "gcc2$2", ",", "ga2$3", ",", "gac2$3", ",", "gb2$3", ",", "gbc2$3", ",", 
   "gc2$3", ",", "gcc2$3", ",", "ga2$4", ",", "gac2$4", ",", "gb2$4", ",", 
   "gbc2$4", ",", "gc2$4", ",", "gcc2$4", ",", "ga2$5", ",", "gac2$5", ",", 
   "gb2$5", ",", "gbc2$5", ",", "gc2$5", ",", "gcc2$5"}], "}"}]], "Output",
 CellChangeTimes->{3.893218584550116*^9, 3.893219526266079*^9, 
  3.8932197336405077`*^9, 3.912903571474448*^9, 3.91290460256785*^9, 
  3.912904881061096*^9, 3.912904968639085*^9, 3.912927360090485*^9, 
  3.914940654737987*^9, 3.914940786533578*^9, 3.914942140596664*^9, 
  3.918393435292605*^9, 3.918401928863953*^9, 3.918817928776298*^9, 
  3.918819981761943*^9, 3.9188200355965652`*^9, 3.9188202486444473`*^9, 
  3.9188204237272453`*^9, 3.918820643887149*^9, 3.918820775143899*^9, 
  3.9188210954235067`*^9, 3.918821374196745*^9, 3.9189237770798883`*^9},
 CellLabel->
  "Out[614]=",ExpressionUUID->"42a6399a-28a2-495a-93b7-afd92169845d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Gbdry", "=", 
   RowBox[{"DeleteDuplicates", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"GaugeTet", ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "i"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ToExpression", "[", 
                   RowBox[{"\"\<Ga\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                  RowBox[{"I", "*", 
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<Gac\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"ToExpression", "[", 
                   RowBox[{"\"\<Gb\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                  RowBox[{"I", "*", 
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<Gbc\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}]}], "}"}],
                ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ToExpression", "[", 
                   RowBox[{"\"\<Gc\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                  RowBox[{"I", " ", 
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<Gcc\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"ToExpression", "[", 
                   RowBox[{"\"\<Gd\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "+", 
                  RowBox[{"I", " ", 
                   RowBox[{"ToExpression", "[", 
                    RowBox[{"\"\<Gdc\>\"", "<>", 
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<$\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}]}], 
                "}"}]}], "}"}], ",", 
             RowBox[{"Unevaluated", "[", 
              RowBox[{"Sequence", "[", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], "//", 
       "Flatten"}], ",", "_Symbol", ",", 
      RowBox[{"-", "1"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9145844252457027`*^9, 3.914584483816696*^9}},
 CellLabel->
  "In[615]:=",ExpressionUUID->"851ec7c1-dd94-4090-afad-102f30ed8e6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gsoln", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Flatten", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"GaugeTet", ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "i"}], "}"}]}], "]"}], ",", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"FullSimplify", "[", 
                  RowBox[{
                   RowBox[{"FunctionExpand", "@", 
                    RowBox[{"Re", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"gvariablesall", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                   ",", 
                   RowBox[{"Assumptions", "\[Rule]", 
                    RowBox[{"_Symbol", "\[Element]", "Reals"}]}]}], "]"}], "==", 
                 RowBox[{"Re", "@", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"gdataof", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}]}]}], "]"}], 
               ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"gspecialpos", ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "i"}], "}"}]}], "]"}], ",", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"FullSimplify", "[", 
                  RowBox[{
                   RowBox[{"FunctionExpand", "@", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"gvariablesall", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3", ",", "4"}], "}"}], "]"}], "]"}], 
                    "]"}]}], ",", 
                   RowBox[{"Assumptions", "\[Rule]", 
                    RowBox[{"_Symbol", "\[Element]", "Reals"}]}]}], "]"}], "==", 
                 RowBox[{"Re", "@", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{"gdataof", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3", ",", "4"}], "}"}], "]"}], 
                   "]"}]}]}], "]"}], ",", "True", ",", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"FullSimplify", "[", 
                  RowBox[{
                   RowBox[{"FunctionExpand", "@", 
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"gvariablesall", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "3"}], "]"}], "]"}], "]"}]}], ",", 
                   RowBox[{"Assumptions", "\[Rule]", 
                    RowBox[{"_Symbol", "\[Element]", "Reals"}]}]}], "]"}], "==", 
                 RowBox[{"Re", "@", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{"gdataof", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ";;", "3"}], "]"}], "]"}]}]}], "]"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"GaugeTet", ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "i"}], "}"}]}], "]"}], ",", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"FullSimplify", "[", 
                  RowBox[{
                   RowBox[{"FunctionExpand", "@", 
                    RowBox[{"Im", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"gvariablesall", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                   ",", 
                   RowBox[{"Assumptions", "\[Rule]", 
                    RowBox[{"_Symbol", "\[Element]", "Reals"}]}]}], "]"}], "==", 
                 RowBox[{"Im", "@", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"gdataof", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}]}]}], "]"}], 
               ",", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"gspecialpos", ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "i"}], "}"}]}], "]"}], ",", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"FullSimplify", "[", 
                  RowBox[{
                   RowBox[{"FunctionExpand", "@", 
                    RowBox[{"Im", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"gvariablesall", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3", ",", "4"}], "}"}], "]"}], "]"}], 
                    "]"}]}], ",", 
                   RowBox[{"Assumptions", "\[Rule]", 
                    RowBox[{"_Symbol", "\[Element]", "Reals"}]}]}], "]"}], "==", 
                 RowBox[{"Im", "@", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{"gdataof", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3", ",", "4"}], "}"}], "]"}], 
                   "]"}]}]}], "]"}], ",", "True", ",", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"FullSimplify", "[", 
                  RowBox[{
                   RowBox[{"FunctionExpand", "@", 
                    RowBox[{"Im", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"gvariablesall", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "3"}], "]"}], "]"}], "]"}]}], ",", 
                   RowBox[{"Assumptions", "\[Rule]", 
                    RowBox[{"_Symbol", "\[Element]", "Reals"}]}]}], "]"}], "==", 
                 RowBox[{"Im", "@", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{"gdataof", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ";;", "3"}], "]"}], "]"}]}]}], "]"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}]}]}], "]"}], 
      ",", "gvarias", ",", "Reals"}], "]"}], "//", "Flatten"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.891096546130477*^9, 3.891096646655439*^9}, {
   3.8910967364675837`*^9, 3.891096786597151*^9}, {3.891097636960123*^9, 
   3.891097704036909*^9}, {3.89109775518821*^9, 3.891097801911216*^9}, 
   3.893218632515378*^9, {3.912903616317376*^9, 3.912903626675222*^9}, {
   3.914941362955802*^9, 3.914941384758039*^9}},
 CellLabel->
  "In[616]:=",ExpressionUUID->"26d6ea67-70a7-4fba-aa9c-aec2a1467ff4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"gvariablesall", "-", "gdataof"}], "/.", "gsoln"}], "//", "N"}],
     "//", "Chop"}], "//", "Flatten"}], "//", "DeleteDuplicates"}]], "Input",
 CellChangeTimes->{{3.89188569419016*^9, 3.8918857363167877`*^9}, {
   3.891885842958034*^9, 3.891885853693358*^9}, 3.9129036710009747`*^9},
 CellLabel->
  "In[617]:=",ExpressionUUID->"0494ae42-a03d-4794-9ab3-7fc0f6dfbb6e"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{3.912903632107585*^9, 3.9129036713247223`*^9, 
  3.9129046115576067`*^9, 3.912904881711246*^9, 3.912904978074337*^9, 
  3.912927360131811*^9, 3.91494066700383*^9, 3.914940788323203*^9, 
  3.914942140730158*^9, 3.918393435416439*^9, 3.918401928987458*^9, 
  3.918817928913123*^9, 3.918819983539469*^9, 3.9188200373948393`*^9, 
  3.918820250435554*^9, 3.918820425524509*^9, 3.9188206456413097`*^9, 
  3.918820776928812*^9, 3.918821097186389*^9, 3.918821376045512*^9, 
  3.918923778900179*^9},
 CellLabel->
  "Out[617]=",ExpressionUUID->"4c8d7009-a0b2-40b2-bbbc-bc21debed964"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"zvaria", "=", 
   RowBox[{"DeleteDuplicates", "@", 
    RowBox[{"Cases", "[", 
     RowBox[{"zvariablesall", ",", "_Symbol", ",", 
      RowBox[{"-", "1"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.891098158278124*^9, 3.891098180365041*^9}, 
   3.89321865265511*^9},
 CellLabel->
  "In[618]:=",ExpressionUUID->"3372287c-4b0e-4385-8941-07fde7549cf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zsoln", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"FullSimplify", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ReIm", "[", 
                    RowBox[{"zvariablesall", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "]"}], 
                    "-", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"zdataf", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "]"}]}], 
                   ",", 
                   RowBox[{"Assumptions", "\[Rule]", 
                    RowBox[{"zvaria", "\[Element]", "Reals"}]}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], "]"}], "==",
           "0"}], "]"}], ",", "False"}], "]"}], ",", "zvaria"}], "]"}], "//", 
    "Flatten"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.891097870962145*^9, 3.891097969373406*^9}, {
   3.8910980877745543`*^9, 3.891098200124782*^9}, {3.8911839612802057`*^9, 
   3.891183983950046*^9}, {3.912903645699201*^9, 3.912903648354916*^9}, 
   3.918820565015278*^9, 3.918820607421434*^9},
 CellLabel->
  "In[619]:=",ExpressionUUID->"98f3766b-1760-4bee-95f1-a927506d0f55"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"zvariablesall", "-", "zdataf"}], "/.", "zsoln"}], "//", "N"}], 
    "//", "Chop"}], "//", "Flatten"}], "//", "DeleteDuplicates"}]], "Input",
 CellChangeTimes->{{3.912903659331135*^9, 3.912903664474394*^9}},
 CellLabel->
  "In[620]:=",ExpressionUUID->"c9da7019-2f34-410e-9bf3-f264bb091583"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.893218673865735*^9, 3.893219591483666*^9, 3.893219733771495*^9, {
   3.9129036561597137`*^9, 3.912903664805749*^9}, 3.912904611604847*^9, 
   3.912904882743271*^9, 3.9129049824599457`*^9, 3.9129273601658707`*^9, 
   3.914940807263363*^9, 3.9149421407722588`*^9, 3.9183934354528303`*^9, 
   3.9184019290562563`*^9, 3.918817928969181*^9, 3.91881998397792*^9, 
   3.918820037783724*^9, 3.918820250813765*^9, 3.918820430125188*^9, 
   3.918820572306671*^9, 3.918820646195443*^9, 3.9188207775186167`*^9, 
   3.9188210978146152`*^9, 3.918821376605937*^9, 3.918923779436965*^9},
 CellLabel->
  "Out[620]=",ExpressionUUID->"2404d0d1-f9b1-43b8-9336-acec99ccd13d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["define area variables", "Subsection",
 CellChangeTimes->{
  3.887042320939084*^9, {3.890304471083496*^9, 3.8903044715317173`*^9}, {
   3.918399176054798*^9, 
   3.9183991768039703`*^9}},ExpressionUUID->"dcc6eac5-eeba-42d7-ab19-\
101c17266e8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"jlabels", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "matrix", "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "==", "j"}], ",", "0", ",", 
           RowBox[{
            RowBox[{"pos", "=", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"OrderBDryFaces", ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "i", ",", "j"}], "}"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<j\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"OrderBDryFaces", "[", 
                RowBox[{"[", 
                 RowBox[{"pos", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], 
              "<>", "\"\<$\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"OrderBDryFaces", "[", 
                RowBox[{"[", 
                 RowBox[{"pos", ",", "1", ",", "2"}], "]"}], "]"}], "]"}], 
              "<>", "\"\<$\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"OrderBDryFaces", "[", 
                RowBox[{"[", 
                 RowBox[{"pos", ",", "1", ",", "3"}], "]"}], "]"}], "]"}]}], 
             "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.918396605095108*^9, 3.918396617605583*^9}, {
   3.918399185070456*^9, 3.9183992137069397`*^9}, {3.918745170677416*^9, 
   3.91874517727162*^9}, {3.918745213761428*^9, 3.918745301675542*^9}, {
   3.918745396745438*^9, 3.91874541657202*^9}, {3.918745750692238*^9, 
   3.9187457597777233`*^9}, {3.918746868503294*^9, 3.91874687031704*^9}, {
   3.918752003845896*^9, 3.918752006702653*^9}, 3.918809308849907*^9},
 CellLabel->
  "In[621]:=",ExpressionUUID->"83f29ebf-2f3e-4471-a2ad-45dd7aa31412"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"jvaria", "=", 
  RowBox[{"DeleteDuplicates", "@", 
   RowBox[{"Cases", "[", 
    RowBox[{"jlabels", ",", "_Symbol", ",", 
     RowBox[{"-", "1"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.9183966315541267`*^9, {3.918399189681028*^9, 3.918399223848106*^9}, {
   3.918745329421709*^9, 3.918745342009328*^9}, 3.9187454278321657`*^9, {
   3.9187457645594177`*^9, 3.9187457717695503`*^9}, 3.9187468752207623`*^9},
 CellLabel->
  "In[622]:=",ExpressionUUID->"e8fb6775-9efe-4f20-885b-e7d0789631d0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "j1$1$2", ",", "j2$1$3", ",", "j1$1$4", ",", "j1$5$1", ",", "j1$2$3", ",", 
   "j1$4$2", ",", "j1$2$5", ",", "j2$4$3", ",", "j1$5$3", ",", "j1$4$5", ",", 
   "j2$2$1", ",", "j2$4$1", ",", "j2$1$5", ",", "j2$2$4", ",", "j2$5$2", ",", 
   "j2$5$4"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9183966319572563`*^9, 3.9183972316327972`*^9, 3.9183978900258083`*^9, 
   3.918398556080799*^9, 3.9183986098312197`*^9, 3.918399224325017*^9, 
   3.9183993049614677`*^9, 3.918399443683066*^9, 3.918401549912464*^9, 
   3.918401699209612*^9, 3.918401780993672*^9, 3.918487996218796*^9, 
   3.918490071135336*^9, 3.918510134077097*^9, 3.918510904660295*^9, 
   3.918510959927751*^9, 3.918511036631266*^9, 3.918513232967502*^9, 
   3.9185137923000793`*^9, 3.9185145674634438`*^9, 3.91857430473339*^9, 
   3.91857509794597*^9, 3.9185772793759336`*^9, 3.918578767091844*^9, 
   3.91857938348529*^9, 3.918580050556385*^9, 3.91863812451049*^9, 
   3.918638363300149*^9, 3.918643099049968*^9, 3.9186466966802073`*^9, 
   3.918653982547567*^9, 3.918658950443186*^9, 3.918659211660293*^9, 
   3.918662281144258*^9, 3.91866589319448*^9, 3.918666247693159*^9, 
   3.9186676629435177`*^9, 3.918734042281562*^9, 3.918735989861444*^9, 
   3.9187450372426147`*^9, 3.9187453209954576`*^9, {3.918745413937315*^9, 
   3.918745428253237*^9}, 3.918745482914463*^9, {3.918745767788416*^9, 
   3.918745772051701*^9}, 3.918746529788589*^9, 3.9187468818273087`*^9, 
   3.9187472668722687`*^9, 3.918748657577429*^9, 3.918752091072465*^9, 
   3.918809425337824*^9, 3.918809507118874*^9, 3.918810222236045*^9, 
   3.918811396419177*^9, 3.91881335909048*^9, 3.918813630790676*^9, 
   3.9188201220836077`*^9, 3.918820250830393*^9, 3.918820430147859*^9, 
   3.91882057231413*^9, 3.918820646209756*^9, 3.9188207775361156`*^9, 
   3.918821097831847*^9, 3.9188213766267033`*^9, 3.918923779451643*^9},
 CellLabel->
  "Out[622]=",ExpressionUUID->"310110e8-ab05-4c84-984a-44a86df775ba"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"jcrit", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"area", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "-", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tetareasign", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "==", 
                    "1"}], ",", 
                    RowBox[{"\[Gamma]", "*", 
                    RowBox[{"jlabels", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}]}], ",", 
                    RowBox[{"jlabels", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}]}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}], "]"}],
              "==", "0"}], "]"}], ",", "False"}], "]"}], ",", "True"}], "]"}],
        ",", "jvaria", ",", "Reals"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "Quiet"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.918396655715233*^9, 3.9183966618705482`*^9}, {
  3.918745445993412*^9, 3.9187455360734873`*^9}, {3.9187457750738163`*^9, 
  3.9187458104423857`*^9}, {3.918746877179736*^9, 3.918746878829637*^9}, {
  3.918809357343989*^9, 3.918809372017171*^9}, {3.918809533300477*^9, 
  3.918809548812518*^9}},
 CellLabel->
  "In[623]:=",ExpressionUUID->"3de79e43-3c0e-4643-93c3-748f959daeb2"]
}, Closed]],

Cell[CellGroupData[{

Cell["define actions", "Subsection",
 CellChangeTimes->{{3.912723160234763*^9, 
  3.912723167257756*^9}},ExpressionUUID->"c5afec6d-d936-415e-bb62-\
7d28526b0f42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfedgeactionXiZ", "[", 
   RowBox[{"xi_", ",", "z_", ",", "g_", ",", "\[Kappa]_", ",", "meta_", ",", 
    RowBox[{"signzz_", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"signzz", " ", 
        RowBox[{
         RowBox[{"Conjugate", "[", "xi", "]"}], ".", "meta", ".", 
         RowBox[{"Transpose", "[", "g", "]"}], ".", "z"}]}], ")"}], 
      RowBox[{"\[Kappa]", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"\[Kappa]", " ", 
           RowBox[{"Det", "[", "meta", "]"}]}]}], ")"}], "/", "2"}]}]], "*", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"signzz", " ", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "g", "]"}], ".", "z"}], "]"}], ".", 
         "meta", ".", "xi"}]}], ")"}], 
      RowBox[{"\[Kappa]", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"\[Kappa]", " ", 
           RowBox[{"Det", "[", "meta", "]"}]}]}], ")"}], "/", "2"}]}]]}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"_Symbol", "\[Element]", "Reals"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.889973216896858*^9, 3.889973242307929*^9}, {
   3.889973288130649*^9, 3.889973306504703*^9}, {3.890043176805431*^9, 
   3.890043206184434*^9}, 3.890043238834488*^9, {3.890043282193926*^9, 
   3.890043302691309*^9}, {3.8900435828526506`*^9, 3.8900435887878103`*^9}, {
   3.890314023953823*^9, 3.890314027986594*^9}, {3.890314331002645*^9, 
   3.890314332722046*^9}, {3.8903146985061607`*^9, 3.890314701123218*^9}, {
   3.8903152553805027`*^9, 3.890315257451666*^9}, {3.890319428094928*^9, 
   3.890319431564098*^9}, {3.890319477796877*^9, 3.890319482152363*^9}, {
   3.8903198351060133`*^9, 3.8903198400097446`*^9}, {3.8903202016417627`*^9, 
   3.890320203455982*^9}, {3.890756345606783*^9, 3.890756359370116*^9}, {
   3.890756742142942*^9, 3.890756743081799*^9}, {3.890843601110488*^9, 
   3.890843612808172*^9}, {3.890843717179682*^9, 3.890843738363591*^9}, {
   3.890843904704636*^9, 3.890843908868031*^9}, {3.890847501145957*^9, 
   3.890847516886169*^9}, {3.891260891898494*^9, 3.891260892111977*^9}, {
   3.891263643227006*^9, 3.891263643653577*^9}, {3.891423015787568*^9, 
   3.891423044631783*^9}},
 CellLabel->
  "In[624]:=",ExpressionUUID->"dcac8d7c-56bb-4f01-9cc6-a73222053280"],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfedgeactionZZ", "[", 
   RowBox[{"xi_", ",", "z_", ",", "g_", ",", "\[Kappa]_", ",", "meta_", ",", 
    RowBox[{"signzz_", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"\[Kappa]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"I", " ", "\[Gamma]"}], "-", 
     RowBox[{"\[Kappa]", " ", 
      RowBox[{"Det", "[", "meta", "]"}]}]}], ")"}], " ", 
   RowBox[{"Log", "[", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"signzz", " ", 
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "g", "]"}], ".", "z"}], "]"}], ".", 
        "meta", ".", 
        RowBox[{"Transpose", "[", "g", "]"}], ".", "z"}]}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"_Symbol", "\[Element]", "Reals"}]}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.891262798100288*^9, 3.8912628022554483`*^9}, {
  3.891263651293026*^9, 3.891263651583053*^9}, {3.891423054842084*^9, 
  3.89142307931852*^9}},
 CellLabel->
  "In[625]:=",ExpressionUUID->"32f46293-bbdb-479d-ae1c-e748cbf8a992"],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfedgeactiontXiZ", "[", 
   RowBox[{"xi_", ",", "z_", ",", "g_", ",", "\[Kappa]_", ",", "meta_", ",", 
    RowBox[{"signzz_", ":", "1"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"signzz", "*", 
          RowBox[{
           RowBox[{"Conjugate", "[", "xi", "]"}], ".", "meta", ".", 
           RowBox[{"Transpose", "[", "g", "]"}], ".", "z"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"signzz", "*", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "g", "]"}], ".", "z"}], "]"}], ".", 
           "meta", ".", "xi"}]}], ")"}]}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"_Symbol", "\[Element]", "Reals"}]}]}], "]"}], "]"}], ")"}], 
   "\[Kappa]"]}]], "Input",
 CellChangeTimes->{{3.891886287199686*^9, 3.891886333097952*^9}},
 CellLabel->
  "In[626]:=",ExpressionUUID->"eec844ae-c16f-4780-aebd-15d9889c5f79"],

Cell[BoxData[
 RowBox[{
  RowBox[{"halfedgeactiontZZ", "[", 
   RowBox[{"xi_", ",", "z_", ",", "g_", ",", "\[Kappa]_", ",", "meta_", ",", 
    RowBox[{"signzz_", ":", "1"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["I", "\[Gamma]"]}], "*", " ", "\[Kappa]", "*", 
   RowBox[{"Log", "[", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Conjugate", "[", "xi", "]"}], ".", "meta", ".", 
         RowBox[{"Transpose", "[", "g", "]"}], ".", "z"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "g", "]"}], ".", "z"}], "]"}], ".", 
         "meta", ".", "xi"}], ")"}]}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"_Symbol", "\[Element]", "Reals"}]}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8918863595118837`*^9, 3.891886382947226*^9}},
 CellLabel->
  "In[627]:=",ExpressionUUID->"d2409465-6f1e-4672-abf1-cbb7e4d0ca6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"faceactionXiZ", "[", 
   RowBox[{
   "xilist_", ",", "zlist_", ",", "glist_", ",", "\[Kappa]list_", ",", 
    "metalist_", ",", "sgndetlist_", ",", 
    RowBox[{"facesign_", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"facesign", ">", "0"}], ",", 
    RowBox[{
     RowBox[{"halfedgeactionXiZ", "[", 
      RowBox[{
       RowBox[{"xilist", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"zlist", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"glist", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"\[Kappa]list", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"metalist", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"metalist", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "*", 
     RowBox[{"Product", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"halfedgeactionXiZ", "[", 
         RowBox[{
          RowBox[{"xilist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"zlist", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
          RowBox[{"glist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"\[Kappa]list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"metalist", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"metalist", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], "*", 
        RowBox[{"halfedgeactionXiZ", "[", 
         RowBox[{
          RowBox[{"xilist", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
          RowBox[{"zlist", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
          RowBox[{"glist", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
          RowBox[{"\[Kappa]list", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
          RowBox[{"metalist", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"metalist", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{
          RowBox[{"Length", "@", "glist"}], "-", "1"}], ",", "2"}], "}"}]}], 
      "]"}], "*", 
     RowBox[{"halfedgeactionXiZ", "[", 
      RowBox[{
       RowBox[{"xilist", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", 
       RowBox[{"zlist", "[", 
        RowBox[{"[", 
         RowBox[{"-", "2"}], "]"}], "]"}], ",", 
       RowBox[{"glist", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", 
       RowBox[{"\[Kappa]list", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", 
       RowBox[{"metalist", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"metalist", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
    RowBox[{"Product", "[", 
     RowBox[{
      RowBox[{"halfedgeactiontXiZ", "[", 
       RowBox[{
        RowBox[{"xilist", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"zlist", "[", 
         RowBox[{"[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"OddQ", "[", "i", "]"}], ",", "i", ",", 
            RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"glist", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"\[Kappa]list", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"metalist", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"metalist", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "xilist"}]}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.89083681674596*^9, 3.890836843461211*^9}, {
   3.8908370321197643`*^9, 3.8908370346284113`*^9}, {3.890845347864902*^9, 
   3.890845374482642*^9}, {3.890847533651389*^9, 3.890847544060142*^9}, {
   3.891166306371318*^9, 3.891166309468824*^9}, 3.891260082050331*^9, 
   3.8912602094305067`*^9, 3.8912617885747747`*^9, 3.891263568420595*^9, {
   3.89188643756417*^9, 3.891886470870153*^9}, {3.8918886923521013`*^9, 
   3.891888709513221*^9}},
 CellLabel->
  "In[628]:=",ExpressionUUID->"12d7c475-e621-450a-b91f-07f8b563b3e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"faceactionBDZZ", "[", 
   RowBox[{
   "xilist_", ",", "zlist_", ",", "glist_", ",", "\[Kappa]list_", ",", 
    "metalist_", ",", "sgndetlist_", ",", 
    RowBox[{"facesign_", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"facesign", ">", "0"}], ",", 
    RowBox[{
     RowBox[{"halfedgeactionZZ", "[", 
      RowBox[{
       RowBox[{"xilist", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"zlist", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"glist", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"\[Kappa]list", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"metalist", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"metalist", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"halfedgeactionZZ", "[", 
         RowBox[{
          RowBox[{"xilist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"zlist", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
          RowBox[{"glist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"\[Kappa]list", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"metalist", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"metalist", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], "+", 
        RowBox[{"halfedgeactionZZ", "[", 
         RowBox[{
          RowBox[{"xilist", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
          RowBox[{"zlist", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
          RowBox[{"glist", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
          RowBox[{"\[Kappa]list", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
          RowBox[{"metalist", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"metalist", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "2"}], "]"}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{
          RowBox[{"Length", "@", "glist"}], "-", "1"}], ",", "2"}], "}"}]}], 
      "]"}], "+", 
     RowBox[{"halfedgeactionZZ", "[", 
      RowBox[{
       RowBox[{"xilist", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", 
       RowBox[{"zlist", "[", 
        RowBox[{"[", 
         RowBox[{"-", "2"}], "]"}], "]"}], ",", 
       RowBox[{"glist", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", 
       RowBox[{"\[Kappa]list", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], ",", 
       RowBox[{"metalist", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"metalist", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"halfedgeactiontZZ", "[", 
       RowBox[{
        RowBox[{"xilist", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"zlist", "[", 
         RowBox[{"[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"OddQ", "[", "i", "]"}], ",", "i", ",", 
            RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"glist", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"\[Kappa]list", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"metalist", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"metalist", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "xilist"}]}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.891166313439519*^9, 3.8911663160279922`*^9}, 
   3.89126358373217*^9, {3.891886491740116*^9, 3.891886516818079*^9}},
 CellLabel->
  "In[629]:=",ExpressionUUID->"a924f968-0bf0-4296-8e61-d89e1045dde9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bdyxikappafa", "=", "zetabdryall"}], ";"}]], "Input",
 CellChangeTimes->{{3.9129050109609222`*^9, 3.912905016789918*^9}},
 CellLabel->
  "In[630]:=",ExpressionUUID->"03e5ac5b-1104-4ca5-bc49-838b4b0d9084"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"allfaces", "=", "OrderBDryFaces"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metaxikappaf", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sgndet", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "i"}], "]"}], "]"}], ">", "0"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", "1"}], "}"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tetareasign", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "<", "0"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PauliMatrix", "[", "3", "]"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PauliMatrix", "[", "3", "]"}], ",", 
               RowBox[{"tetn0signtest1", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}]}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.912905027593423*^9, 3.912905035451642*^9}},
 CellLabel->
  "In[631]:=",ExpressionUUID->"28d2dc29-2868-46fe-b99e-55c7e58e8f4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ActionComplex", "[", 
   RowBox[{"gvariablesall_", ",", "zvariablesall_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "jvariables", ",", "gvariables", ",", "zvariables", ",", "allfaces", ",",
       "BDActions", ",", "xilist", ",", " ", "zlist", ",", " ", "glist", ",", 
      " ", "\[Kappa]list", ",", " ", "metalist", ",", " ", "sgndetlist", ",", 
      " ", "jvalue", ",", "areasign", ",", "BDActionsXiZ", ",", "term1", ",", 
      "term2", ",", "BDActionsZZ"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"jvariables", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"tetareasign", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "j1", ",", "j2"}], "]"}], "]"}], "==", "1"}],
             ",", 
            RowBox[{"jlabels", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "j1", ",", "j2"}], "]"}], "]"}], ",", 
            RowBox[{"jlabels", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "j1", ",", "j2"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j1", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j2", ",", "5"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"gvariables", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"gvariablesall", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"zvariables", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"zvariablesall", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "5"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "@", "bdydata"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"allfaces", "=", "OrderBDryFaces"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"BDActionsXiZ", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Off", "[", 
          RowBox[{"N", "::", "meprec"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"xilist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"bdyxikappafa", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], "/@", 
           "faces"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"zlist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"zvariables", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], "/@", 
           "faces"}]}], ";", 
         RowBox[{"glist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"gvariables", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "]"}], "]"}], 
            "&"}], "/@", "faces"}]}], ";", 
         RowBox[{"\[Kappa]list", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"kappa", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], "/@", 
           "faces"}]}], ";", 
         RowBox[{"metalist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"metaxikappaf", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], "/@", 
           "faces"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sgndetlist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"sgndet", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "]"}], "]"}], 
            "&"}], "/@", "faces"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"areasign", "=", 
          RowBox[{"tetareasign", "[", 
           RowBox[{"[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"faces", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
         RowBox[{"jvalue", "=", 
          RowBox[{"jvariables", "[", 
           RowBox[{"[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"faces", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
         RowBox[{"term1", "=", 
          RowBox[{"2", "*", "jvalue", "*", 
           RowBox[{"Log", "[", 
            RowBox[{"faceactionXiZ", "[", 
             RowBox[{
             "xilist", ",", "zlist", ",", "glist", ",", "\[Kappa]list", ",", 
              "metalist", ",", "sgndetlist", ",", "areasign"}], "]"}], 
            "]"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"faces", ",", "allfaces"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"BDActionsZZ", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Off", "[", 
          RowBox[{"N", "::", "meprec"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"xilist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"bdyxikappafa", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], "/@", 
           "faces"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"zlist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"zvariables", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], "/@", 
           "faces"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"glist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"gvariables", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "]"}], "]"}], 
            "&"}], "/@", "faces"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Kappa]list", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"kappa", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], "/@", 
           "faces"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"metalist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"metaxikappaf", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], "/@", 
           "faces"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sgndetlist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"sgndet", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "]"}], "]"}], 
            "&"}], "/@", "faces"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"areasign", "=", 
          RowBox[{"tetareasign", "[", 
           RowBox[{"[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"faces", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"jvalue", "=", 
          RowBox[{"jvariables", "[", 
           RowBox[{"[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"faces", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"jvalue", "*", 
          RowBox[{"faceactionBDZZ", "[", 
           RowBox[{
           "xilist", ",", "zlist", ",", "glist", ",", "\[Kappa]list", ",", 
            "metalist", ",", "sgndetlist", ",", "areasign"}], "]"}]}]}], ",", 
        
        RowBox[{"{", 
         RowBox[{"faces", ",", "allfaces"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Refine", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"BDActionsXiZ", ",", "BDActionsZZ"}], "}"}], "]"}], "//", 
        "Total"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"_Symbol", "\[Element]", "Reals"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8870423809256697`*^9, 3.88704238092872*^9}, {
   3.8870428745500193`*^9, 3.8870429203282337`*^9}, {3.889889100742951*^9, 
   3.889889111319755*^9}, {3.889889861486177*^9, 3.889889873249898*^9}, {
   3.889890767707844*^9, 3.889890793294141*^9}, {3.889890914752852*^9, 
   3.8898909198056793`*^9}, {3.889891296346596*^9, 3.8898913190558233`*^9}, {
   3.8898977815606833`*^9, 3.889897792175407*^9}, {3.889898207682508*^9, 
   3.8898982181694202`*^9}, 3.889898463189259*^9, {3.889898650102867*^9, 
   3.8898986510422707`*^9}, {3.8900563894025707`*^9, 3.890056439467821*^9}, {
   3.8900565704241447`*^9, 3.8900565709471807`*^9}, {3.890056645809514*^9, 
   3.89005666265656*^9}, {3.890056898550768*^9, 3.890056951132083*^9}, {
   3.890056995500996*^9, 3.890057096573552*^9}, {3.890057161496428*^9, 
   3.8900572145227537`*^9}, {3.890057962649046*^9, 3.890057971106838*^9}, {
   3.890058065956839*^9, 3.8900580942703047`*^9}, {3.8900583003012037`*^9, 
   3.890058301551982*^9}, {3.890058426658049*^9, 3.890058538704772*^9}, {
   3.8900585696674*^9, 3.8900585728865433`*^9}, {3.890059290848729*^9, 
   3.890059341965027*^9}, 3.8900593781534777`*^9, {3.890059432686957*^9, 
   3.8900594337277327`*^9}, {3.890059498525853*^9, 3.8900595017521973`*^9}, 
   3.8900596440328608`*^9, {3.890059708944236*^9, 3.890059736012116*^9}, {
   3.890059801403309*^9, 3.890059822415247*^9}, {3.890059857890983*^9, 
   3.890059901102363*^9}, {3.89005993453839*^9, 3.890059977678904*^9}, {
   3.890060014447365*^9, 3.890060033422518*^9}, {3.890060068731989*^9, 
   3.890060089217458*^9}, {3.8900627559635468`*^9, 3.890062786979274*^9}, {
   3.890062833583446*^9, 3.890062864534998*^9}, {3.890151086907427*^9, 
   3.8901511376739807`*^9}, {3.890151453195557*^9, 3.89015148473732*^9}, {
   3.890151946200136*^9, 3.890151960203491*^9}, {3.890152021826324*^9, 
   3.890152022654316*^9}, {3.89015211597823*^9, 3.890152153145121*^9}, {
   3.890153320945569*^9, 3.890153321371777*^9}, {3.890153453250244*^9, 
   3.89015345383991*^9}, {3.890250441434538*^9, 3.890250443526896*^9}, 
   3.890306116487228*^9, {3.8903124743513727`*^9, 3.890312501938031*^9}, {
   3.8903205084572887`*^9, 3.890320539009655*^9}, {3.890416126680645*^9, 
   3.890416148734398*^9}, {3.8904165160668173`*^9, 3.89041654470726*^9}, {
   3.8904741976709557`*^9, 3.890474209195609*^9}, {3.8904743603488073`*^9, 
   3.890474360728591*^9}, {3.8904746686238127`*^9, 3.890474687317561*^9}, {
   3.890474724409273*^9, 3.890474736781168*^9}, 3.890474771116534*^9, {
   3.890475429893538*^9, 3.89047543085165*^9}, {3.890476030399543*^9, 
   3.890476040908049*^9}, {3.890578755736191*^9, 3.890578813502598*^9}, 
   3.8905803419217978`*^9, {3.890580490241796*^9, 3.8905805007387037`*^9}, {
   3.890580601614471*^9, 3.890580616354328*^9}, {3.89058169262426*^9, 
   3.890581704596959*^9}, 3.890582071232139*^9, {3.890582656260681*^9, 
   3.890582780234768*^9}, {3.890583046908737*^9, 3.890583060010056*^9}, {
   3.890583422406019*^9, 3.890583468044886*^9}, {3.8907520903627234`*^9, 
   3.890752106399289*^9}, {3.890756392927968*^9, 3.890756411651061*^9}, {
   3.890756447141542*^9, 3.890756462837281*^9}, {3.8908202424404182`*^9, 
   3.890820288051671*^9}, {3.8908207141343*^9, 3.8908207171137457`*^9}, {
   3.890820940097576*^9, 3.8908209588669567`*^9}, {3.890822298172592*^9, 
   3.890822325656227*^9}, {3.8908225560944242`*^9, 3.890822573431275*^9}, {
   3.8908229205367393`*^9, 3.890822952574068*^9}, {3.890824084282703*^9, 
   3.890824085785851*^9}, {3.89082414967117*^9, 3.8908242713717823`*^9}, {
   3.890824350153914*^9, 3.8908243558577557`*^9}, {3.890826347659359*^9, 
   3.890826358591558*^9}, {3.890826423640964*^9, 3.8908265032991037`*^9}, {
   3.89083127968285*^9, 3.890831314665303*^9}, {3.8908315961745453`*^9, 
   3.890831618313324*^9}, {3.8908317387819223`*^9, 3.890831745313526*^9}, {
   3.890831795564734*^9, 3.890831808897439*^9}, {3.8908362241920967`*^9, 
   3.890836225299048*^9}, {3.89083632437177*^9, 3.890836346780746*^9}, {
   3.890836384913733*^9, 3.8908363875874166`*^9}, {3.890836429352202*^9, 
   3.890836432760941*^9}, {3.89083646806844*^9, 3.890836479244095*^9}, {
   3.89083720434258*^9, 3.890837210356886*^9}, {3.890837258230649*^9, 
   3.890837261395547*^9}, {3.890837474572864*^9, 3.8908374789827213`*^9}, {
   3.890838500903945*^9, 3.89083851132225*^9}, {3.89083912315784*^9, 
   3.890839166167615*^9}, {3.8908405838117237`*^9, 3.890840629324638*^9}, {
   3.890840714458952*^9, 3.890840719764913*^9}, {3.8908429598465147`*^9, 
   3.890842964738257*^9}, {3.890843957185327*^9, 3.890843960052044*^9}, {
   3.8908440730825453`*^9, 3.890844074043254*^9}, {3.8908441045403357`*^9, 
   3.8908441088355217`*^9}, 3.890845476659061*^9, 3.890845673028328*^9, {
   3.890845813346889*^9, 3.890845848491679*^9}, {3.890846088703368*^9, 
   3.890846114481942*^9}, {3.890846395153878*^9, 3.8908464366409283`*^9}, 
   3.8908480096828003`*^9, {3.890848220957806*^9, 3.890848232293208*^9}, {
   3.890848585854368*^9, 3.890848595182568*^9}, {3.8908489473563623`*^9, 
   3.890848951166469*^9}, {3.89085120899681*^9, 3.890851240661561*^9}, {
   3.8908514311608753`*^9, 3.890851445472793*^9}, {3.8908516811241827`*^9, 
   3.890851721935614*^9}, {3.89109618113754*^9, 3.8910962296939774`*^9}, {
   3.891166765040347*^9, 3.891166774605441*^9}, {3.891166807997642*^9, 
   3.8911668122189817`*^9}, {3.89116706898337*^9, 3.891167074877714*^9}, 
   3.891180759747099*^9, {3.891180790966385*^9, 3.8911808037823563`*^9}, {
   3.8911808382897463`*^9, 3.8911808662499037`*^9}, {3.891180910801174*^9, 
   3.891180934428564*^9}, {3.891180972598558*^9, 3.891180980034628*^9}, 
   3.891181027262394*^9, {3.891181084661084*^9, 3.891181111530552*^9}, 
   3.891181269704815*^9, {3.891181305386538*^9, 3.891181305886736*^9}, 
   3.891181345251677*^9, {3.891194071650063*^9, 3.891194075573574*^9}, {
   3.8912598240080767`*^9, 3.891259827236532*^9}, {3.8912598811780367`*^9, 
   3.891259896353466*^9}, 3.891260467684842*^9, 3.891260520651969*^9, 
   3.891260577542321*^9, {3.891260644679352*^9, 3.891260646576046*^9}, {
   3.891260717358303*^9, 3.891260720510726*^9}, {3.89126078664939*^9, 
   3.8912607877343807`*^9}, {3.891260940390627*^9, 3.891260942163768*^9}, {
   3.891260996458808*^9, 3.891261003421266*^9}, {3.891261158712659*^9, 
   3.8912611610181427`*^9}, {3.891261813775622*^9, 3.891261838983838*^9}, {
   3.891423229835134*^9, 3.891423231860729*^9}, {3.891886680299855*^9, 
   3.891886732092348*^9}, {3.891887072328841*^9, 3.891887080729372*^9}, {
   3.891887239180209*^9, 3.8918872678714447`*^9}, {3.891887306618422*^9, 
   3.89188730694888*^9}, {3.8918879481660137`*^9, 3.891887966985654*^9}, {
   3.89188808382766*^9, 3.891888092240286*^9}, {3.8918893063030767`*^9, 
   3.891889310399612*^9}, {3.891901764037372*^9, 3.8919017928345013`*^9}, {
   3.91290505470474*^9, 3.912905061231792*^9}, {3.912905114218309*^9, 
   3.912905118302897*^9}, 3.914940906527596*^9, {3.918820147699942*^9, 
   3.918820156388467*^9}, 3.918820355822001*^9},
 CellLabel->
  "In[633]:=",ExpressionUUID->"96fe6eba-0c0a-4264-bfdb-2f612021ccbe"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["action and EOM computation", "Section",
 CellChangeTimes->{
  3.887042411897176*^9, {3.918820447987287*^9, 
   3.91882045127313*^9}},ExpressionUUID->"6148301d-b24e-493a-afa4-\
ddf8cf81d77e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"criti", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"jcrit", ",", "zetadata", ",", "gsoln", ",", "zsoln"}], "]"}], "//",
     "N"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.918819486031006*^9, 3.9188195053736477`*^9}, {
  3.918820166042664*^9, 3.918820167996955*^9}},
 CellLabel->
  "In[634]:=",ExpressionUUID->"1ee05b6f-ca55-48a4-b944-b6c5b9b642ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"actionv1v3", "=", 
   RowBox[{"ActionComplex", "[", 
    RowBox[{"gvariablesall", ",", "zvariablesall"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.891180818889902*^9, 3.891180821446813*^9}, {
   3.891181019967122*^9, 3.891181021067327*^9}, {3.891181090300465*^9, 
   3.891181091223971*^9}, {3.891181356098689*^9, 3.89118135960279*^9}, {
   3.91458475229081*^9, 3.914584812754298*^9}, {3.914584893909182*^9, 
   3.914584902994033*^9}, 3.914584933602702*^9, {3.914584993669488*^9, 
   3.914585000518276*^9}, {3.914942264603896*^9, 3.914942264851056*^9}, {
   3.9188203699733686`*^9, 3.918820372375372*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[635]:=",ExpressionUUID->"f4cf37f6-cca3-4f7a-a0e2-3221d00773fb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"actionv1v3", "/.", "criti"}], ")"}], "//", "ExpandAll"}], "//", 
  "Chop"}]], "Input",
 CellChangeTimes->{{3.891181287388834*^9, 3.891181292958027*^9}, 
   3.891181440012124*^9, {3.8911938229081173`*^9, 3.8911938899023647`*^9}, {
   3.891193950236368*^9, 3.8911939612010612`*^9}, {3.8911942410101833`*^9, 
   3.891194260122816*^9}, 3.89119444625056*^9, {3.891194479558317*^9, 
   3.89119449564933*^9}, {3.8911945384999332`*^9, 3.891194539711686*^9}, {
   3.8912595975207157`*^9, 3.891259675998042*^9}, 3.891259901994627*^9, {
   3.891261016255762*^9, 3.891261038393072*^9}, {3.8912611789059772`*^9, 
   3.891261180458527*^9}, {3.891261220512545*^9, 3.891261245242668*^9}, {
   3.891261291656742*^9, 3.891261297369399*^9}, {3.891261392770164*^9, 
   3.891261397516938*^9}, {3.891261917448221*^9, 3.891261938741303*^9}, {
   3.891263426694747*^9, 3.89126343247711*^9}, {3.891269737298416*^9, 
   3.8912697517385883`*^9}, 3.8914232494794197`*^9, {3.891423305776114*^9, 
   3.891423331965477*^9}, {3.891426428390156*^9, 3.891426496378725*^9}, 
   3.891427201931757*^9, {3.89142723975919*^9, 3.8914272420732803`*^9}, {
   3.891427346437248*^9, 3.891427348168262*^9}, {3.8918874480404654`*^9, 
   3.891887479871389*^9}, {3.891887660878532*^9, 3.89188766757653*^9}, {
   3.891887706278117*^9, 3.8918877447432404`*^9}, {3.891888566462532*^9, 
   3.891888567677415*^9}, {3.891889323600189*^9, 3.8918893285190287`*^9}, {
   3.891901837236134*^9, 3.8919018584340963`*^9}, {3.891902793529645*^9, 
   3.891902830657773*^9}, 3.9145848680421963`*^9, {3.914584909047943*^9, 
   3.914584931602992*^9}, 3.914585005315909*^9, {3.9149422726974897`*^9, 
   3.9149422729339848`*^9}, {3.918819512992633*^9, 3.918819514873085*^9}, {
   3.918820682099105*^9, 3.918820691904461*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[636]:=",ExpressionUUID->"a6d54f08-48eb-4f56-924f-d2320b697d25"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "-", 
    RowBox[{"3.1158289663139263`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  FractionBox[
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"8.504003874599086`", " ", "\[ImaginaryI]"}]}], 
   "\[Gamma]"]}]], "Output",
 CellChangeTimes->{{3.8925399302987022`*^9, 3.8925399393906612`*^9}, 
   3.892540667478119*^9, 3.8925408147011337`*^9, 3.892541019461289*^9, 
   3.912905103724958*^9, 3.912905211225503*^9, 3.9129274263713493`*^9, 
   3.914583679126218*^9, 3.914584412083396*^9, 3.91458451999786*^9, 
   3.9145846528869247`*^9, 3.914584868868918*^9, 3.9145849095163507`*^9, 
   3.9145849449447002`*^9, 3.914585007354082*^9, 3.914942316144239*^9, 
   3.9183935218349247`*^9, 3.91881798766476*^9, 3.918819484096196*^9, 
   3.91881951527593*^9, 3.918819768582231*^9, 3.9188198808187103`*^9, 
   3.9188199886523113`*^9, 3.9188200423804903`*^9, 3.918820169585215*^9, 
   3.91882025536545*^9, {3.918820489531129*^9, 3.918820516000778*^9}, 
   3.9188205847656918`*^9, 3.918820651587*^9, 3.9188208379055433`*^9, 
   3.9188211561554823`*^9, 3.918821439790148*^9, 3.9189238104820557`*^9},
 Background->RGBColor[0.9, 1, 1],
 CellLabel->
  "Out[636]=",ExpressionUUID->"048d7f88-8964-4a15-b975-330428c3593d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"variablesAll", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"DeleteDuplicates", "@", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", "gvariablesall"}], ",", 
           RowBox[{"Flatten", "@", "zvariablesall"}]}], "]"}], "//", 
         "Flatten"}], ",", "_Symbol", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ",", "Gbdry"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.893218597209367*^9, 3.89321860358533*^9}, {
  3.914584488568709*^9, 3.914584497797462*^9}},
 CellLabel->
  "In[637]:=",ExpressionUUID->"61913043-8e97-4d19-8592-1c1b44ce85b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", "variablesAll"}]], "Input",
 CellLabel->
  "In[638]:=",ExpressionUUID->"132fc161-a994-482a-83ac-0e6a7518070c"],

Cell[BoxData["88"], "Output",
 CellChangeTimes->{
  3.893218612683455*^9, 3.893219533807811*^9, 3.8932197336501913`*^9, 
   3.912903583532524*^9, 3.912904606084241*^9, 3.912904881083933*^9, 
   3.912904973602162*^9, 3.912927360102406*^9, 3.914584302535242*^9, 
   3.914584338492218*^9, 3.914584500113398*^9, 3.914942140615543*^9, 
   3.918393435309931*^9, 3.918401928882071*^9, 3.91881792879491*^9, 
   3.91881935455825*^9, 3.918819419668867*^9, {3.918819768595414*^9, 
   3.918819777571135*^9}, 3.9188198808320627`*^9, 3.918819988667694*^9, 
   3.918820042398603*^9, 3.918820176059929*^9, 3.9188202553814297`*^9, 
   3.918820489552189*^9, 3.9188205864293203`*^9, 3.918820651600959*^9, 
   3.918820837924752*^9, 3.918821156170238*^9, 3.918821439805502*^9, 
   3.918923810492509*^9},
 CellLabel->
  "Out[638]=",ExpressionUUID->"93aecd9d-32b0-487d-97b0-b6fa5a8c26e1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"daction", "=", 
   RowBox[{"D", "[", 
    RowBox[{"actionv1v3", ",", 
     RowBox[{"{", "variablesAll", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.891423364904662*^9, 3.8914234084007883`*^9}, {
   3.914584680053783*^9, 3.9145846889004917`*^9}, {3.914584872568363*^9, 
   3.914584879748157*^9}, 3.914584912183729*^9, {3.9145849494679527`*^9, 
   3.914584957813382*^9}, 3.9145850109100847`*^9, {3.9149423267432833`*^9, 
   3.914942326983967*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[639]:=",ExpressionUUID->"0f2db63f-5c4d-4fda-9015-cf3ae6eb95c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"(", 
     RowBox[{"daction", "/.", "criti"}], ")"}], "]"}], "//", "N"}], "//", 
  "Chop"}]], "Input",
 CellChangeTimes->{{3.89142338119571*^9, 3.89142342682458*^9}, {
   3.8914273391311693`*^9, 3.8914273409752693`*^9}, 3.914584961359282*^9, 
   3.918819534945849*^9},
 CellLabel->
  "In[640]:=",ExpressionUUID->"caac62f3-4572-4926-816c-ef2b575b6098"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.891424062838457*^9, 3.891424070718224*^9}, 
   3.891425089470565*^9, 3.891427250144414*^9, 3.891427342087998*^9, 
   3.891902837796543*^9, 3.8920067859496317`*^9, 3.892008578005987*^9, 
   3.892031797212233*^9, 3.89217557488181*^9, 3.892268110918236*^9, 
   3.892539942411581*^9, 3.892540667956814*^9, 3.892540815184476*^9, 
   3.892541019930334*^9, 3.9129052329959917`*^9, 3.914583763856485*^9, 
   3.914584695859459*^9, 3.914584886074991*^9, 3.9145849184328203`*^9, {
   3.914584955757883*^9, 3.914584968529037*^9}, 3.9145850187642403`*^9, 
   3.914942332969198*^9, 3.9183935126242027`*^9, 3.918817991831593*^9, {
   3.918819527738922*^9, 3.918819536359256*^9}, 3.918819778050364*^9, 
   3.918819884216247*^9, 3.918819995098727*^9, 3.9188200493829603`*^9, 
   3.918820176503593*^9, 3.918820586884087*^9, 3.918820655302228*^9, 
   3.918820875843704*^9, 3.918821156626134*^9, 3.918821440258642*^9, 
   3.918923810935356*^9},
 Background->RGBColor[0.9, 1, 1],
 CellLabel->
  "Out[640]=",ExpressionUUID->"b6a99dce-5423-44bd-a511-577bb8f63ca9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare with Regge action", "Section",
 CellChangeTimes->{{3.918654893612049*^9, 
  3.9186549007133837`*^9}},ExpressionUUID->"6bf007d9-ee62-46b1-a108-\
caf5149cd2b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"critnoj", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"zetadata", ",", "gsoln", ",", "zsoln"}], "]"}], "//", "N"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.918820780847295*^9, 3.918820791699335*^9}},
 CellLabel->
  "In[641]:=",ExpressionUUID->"ecb1c1e3-6694-498c-bcb1-cc7a6a9a1deb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Spp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"actionv1v3", "/.", "critnoj"}], "//", "Expand"}], "//", "N"}], "//",
    "Chop"}]}]], "Input",
 CellChangeTimes->{{3.918810217323138*^9, 3.918810228255004*^9}, {
  3.918820758373642*^9, 3.918820805056056*^9}, {3.9188210634939737`*^9, 
  3.918821064086974*^9}, {3.918821323433745*^9, 3.918821323718602*^9}, {
  3.918923751336351*^9, 3.918923752652871*^9}},
 CellLabel->
  "In[642]:=",ExpressionUUID->"93d508ea-62c9-4abf-87f8-c08466958f63"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"3.1415926535897936`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j1$1$4"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"6.139837738274221`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j1$2$3"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"3.1415926535897936`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j1$2$5"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"3.141592653589793`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j1$4$2"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"2.356194490192345`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j1$4$5"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"3.1415926535897936`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j1$5$1"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"6.283185307179586`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j2$1$3"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"3.141592653589793`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j2$1$5"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"3.141592653589793`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j2$2$4"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"3.141592653589793`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j2$4$1"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"4.528627114240513`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j2$4$3"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"3.141592653589793`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j2$5$2"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"2.356194490192345`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j2$5$4"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.5493061443340552`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j1$1$2", " ", "\[Gamma]"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.7953654612239061`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j1$2$3", " ", "\[Gamma]"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.5493061443340549`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "j2$2$1", " ", "\[Gamma]"}]}]], "Output",
 CellChangeTimes->{3.918820855711409*^9, 3.9188211566985283`*^9, 
  3.9188214403315477`*^9, 3.918923811006493*^9},
 CellLabel->
  "Out[642]=",ExpressionUUID->"209d2142-9d00-48c9-a387-9bec60e3f90e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Save", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<data/Sppdata.wl\>\""}], ",", "Spp"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.918813361318358*^9, 3.91881339404858*^9}, {
  3.918813622811172*^9, 3.9188136230300217`*^9}, {3.918820862291616*^9, 
  3.918820869276843*^9}, {3.918821068016182*^9, 3.9188210729991217`*^9}, {
  3.918821327962474*^9, 3.918821330839625*^9}, {3.9189237562828407`*^9, 
  3.91892375827344*^9}},
 CellLabel->
  "In[643]:=",ExpressionUUID->"f6e57170-c010-49b0-9c31-7727910c7543"]
}, Open  ]]
},
WindowSize->{857, 847},
WindowMargins->{{182, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"93ba5c08-0d25-402d-b3ca-abbd27d3c68c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 270, 6, 30, "Input",ExpressionUUID->"8669d291-cd7e-49ac-9853-a9c2c01b9b80"],
Cell[831, 28, 159, 3, 30, "Input",ExpressionUUID->"1e5cfc05-c04b-411b-97a1-ba180fbdfeb8"],
Cell[CellGroupData[{
Cell[1015, 35, 216, 3, 67, "Section",ExpressionUUID->"8f6b0ca8-8e8f-4233-868a-0bc0990a9a1d"],
Cell[CellGroupData[{
Cell[1256, 42, 167, 3, 54, "Subsection",ExpressionUUID->"0a9e6b0e-d1c8-4b85-9aa2-0cde8a146d25"],
Cell[1426, 47, 1211, 37, 73, "Input",ExpressionUUID->"e148683c-689f-4aee-b41f-11a3fb4c777f"],
Cell[2640, 86, 2789, 74, 136, "Input",ExpressionUUID->"4eb677e2-2168-475c-8282-b2ae79a65ce3"],
Cell[5432, 162, 953, 29, 52, "Input",ExpressionUUID->"5503d985-7f3a-494f-8f84-b49421c8aa66"],
Cell[6388, 193, 901, 27, 52, "Input",ExpressionUUID->"3849ae44-2d4d-4f3f-b200-07ce27a5a7e0"],
Cell[7292, 222, 1707, 53, 115, "Input",ExpressionUUID->"10e54791-b7bd-45c1-9baa-790251373679"]
}, Closed]],
Cell[CellGroupData[{
Cell[9036, 280, 176, 3, 38, "Subsection",ExpressionUUID->"f3f1d9ed-413d-4230-94f6-73b49feffba9"],
Cell[9215, 285, 426, 10, 30, "Input",ExpressionUUID->"cae9c073-1829-4e80-9a25-b696075e30fa"],
Cell[9644, 297, 542, 15, 30, "Input",ExpressionUUID->"b66829b9-9c75-43bc-aece-e3415bf4509a"],
Cell[10189, 314, 397, 10, 30, "Input",ExpressionUUID->"10c29e57-9de2-4959-912a-1ec06790559d"],
Cell[10589, 326, 1799, 52, 177, "Input",ExpressionUUID->"960ce8e4-c9a3-4601-997c-715da9fecc9a"],
Cell[12391, 380, 672, 15, 52, "Input",ExpressionUUID->"debf953e-7e37-48a1-9351-0cd78e5dd699"],
Cell[13066, 397, 8203, 203, 787, "Input",ExpressionUUID->"a663f5bd-7cac-4814-85dd-f853c40ca3b9"]
}, Closed]],
Cell[CellGroupData[{
Cell[21306, 605, 267, 4, 38, "Subsection",ExpressionUUID->"689c27db-9127-4471-a209-675c52a6038c"],
Cell[21576, 611, 343, 8, 30, "Input",ExpressionUUID->"68a76143-e71e-4f42-bf29-d3c1f0e67136"],
Cell[21922, 621, 1621, 47, 136, "Input",ExpressionUUID->"a2ca764f-781f-4db5-b677-8e785f1facaf"]
}, Closed]],
Cell[CellGroupData[{
Cell[23580, 673, 222, 4, 38, "Subsection",ExpressionUUID->"994ce7da-b7c6-462e-a662-1247c0d8e0c6"],
Cell[23805, 679, 2489, 63, 388, "Input",ExpressionUUID->"89e90888-b160-4de6-9f9d-19784d934775"]
}, Closed]],
Cell[CellGroupData[{
Cell[26331, 747, 178, 3, 38, "Subsection",ExpressionUUID->"0abec264-c9f3-4e15-9238-7136059ab9b5"],
Cell[26512, 752, 248, 5, 30, "Input",ExpressionUUID->"fdf7ed59-ab0d-4a69-ac99-69c59229c03d"],
Cell[26763, 759, 916, 27, 30, "Input",ExpressionUUID->"b35bef18-65f7-4bef-9016-7ae27e97e016"],
Cell[27682, 788, 509, 12, 52, "Input",ExpressionUUID->"6213babd-71ed-49a9-9f5e-1250423ee970"],
Cell[28194, 802, 3319, 89, 241, "Input",ExpressionUUID->"04d22bea-f5d6-48f4-b7ad-109b9ca51e9f"]
}, Closed]],
Cell[CellGroupData[{
Cell[31550, 896, 277, 4, 38, "Subsection",ExpressionUUID->"26454666-9b23-4a7f-b54d-7e2f89c218df"],
Cell[31830, 902, 471, 9, 52, "Input",ExpressionUUID->"93b3473b-d845-42ee-ad26-1f348e6ca697"],
Cell[32304, 913, 982, 28, 73, "Input",ExpressionUUID->"7b810fd4-d29b-4fd0-a033-1ae9e7aeb1cb"],
Cell[33289, 943, 511, 12, 52, "Input",ExpressionUUID->"c45c33bc-53b7-45af-a7c8-6553bda46f74"],
Cell[33803, 957, 4701, 106, 241, "Input",ExpressionUUID->"d4e73489-c2c8-4f3f-b5be-16b69128b530"]
}, Closed]],
Cell[CellGroupData[{
Cell[38541, 1068, 217, 3, 38, "Subsection",ExpressionUUID->"f09de286-1ed5-4523-b5dd-e31c47923b04"],
Cell[38761, 1073, 1161, 24, 115, "Input",ExpressionUUID->"e37a33d6-cd9a-4fca-9f1a-1bee725ffbf8"],
Cell[39925, 1099, 1518, 42, 136, "Input",ExpressionUUID->"ab3edbcb-efc2-4fa0-9441-c9909c65a896"],
Cell[41446, 1143, 748, 20, 94, "Input",ExpressionUUID->"b0065fcd-5728-4df0-b37d-b47edd488cc8"],
Cell[42197, 1165, 469, 14, 30, "Input",ExpressionUUID->"1b6fb8cf-213c-4f02-921b-f49194e31240"],
Cell[42669, 1181, 1231, 35, 94, "Input",ExpressionUUID->"abb98497-aa98-4bb1-b2cd-95aedf866e7f"],
Cell[43903, 1218, 1980, 53, 199, "Input",ExpressionUUID->"27eeaa4a-7cdd-4fa4-891b-2d5f98c4aefc"]
}, Closed]],
Cell[CellGroupData[{
Cell[45920, 1276, 162, 3, 38, "Subsection",ExpressionUUID->"a6296958-32d9-4b6f-aa49-c26ef71b9613"],
Cell[46085, 1281, 3879, 103, 291, "Input",ExpressionUUID->"63291a80-32df-4db9-8c1e-67e8168abee3"],
Cell[49967, 1386, 2574, 66, 115, "Input",ExpressionUUID->"17d05ce5-41fc-454f-aa06-be9bf29ec20e"]
}, Closed]],
Cell[CellGroupData[{
Cell[52578, 1457, 182, 3, 38, "Subsection",ExpressionUUID->"aa84edbf-57ea-4960-a7c1-05be3704ce5a"],
Cell[52763, 1462, 5303, 120, 228, "Input",ExpressionUUID->"a139b93c-590c-400d-be35-d89a5f8743b9"]
}, Closed]],
Cell[CellGroupData[{
Cell[58103, 1587, 231, 4, 38, "Subsection",ExpressionUUID->"9a23a412-000a-4e42-8f59-67652ad5d5e0"],
Cell[58337, 1593, 3719, 102, 228, "Input",ExpressionUUID->"42253e32-a5df-434b-86dc-2d8a2d175084"],
Cell[62059, 1697, 5523, 134, 273, "Input",ExpressionUUID->"ad124562-c0e8-4ed2-8c16-a6513a76dee2"]
}, Closed]],
Cell[CellGroupData[{
Cell[67619, 1836, 297, 5, 38, "Subsection",ExpressionUUID->"c3792b50-7537-4d87-b1c2-92db99c9dcc6"],
Cell[67919, 1843, 704, 17, 52, "Input",ExpressionUUID->"fd5684e4-afd7-4892-ba1c-2f598a6df4ea"],
Cell[68626, 1862, 1760, 54, 134, "Input",ExpressionUUID->"34f77bf4-2a3f-4f16-b9d0-0efeb8b90048"],
Cell[70389, 1918, 1376, 37, 73, "Input",ExpressionUUID->"6d6b2e42-3253-47da-b7fa-99722b16c4a1"]
}, Closed]],
Cell[CellGroupData[{
Cell[71802, 1960, 307, 5, 38, "Subsection",ExpressionUUID->"8bbf9c70-fe4d-4871-891b-2c1270967f2d"],
Cell[72112, 1967, 1805, 41, 94, "Input",ExpressionUUID->"9cc1778a-0d30-4cea-9a35-ea5c5d243b9b"],
Cell[73920, 2010, 10000, 250, 875, "Input",ExpressionUUID->"dfa6c960-0ef1-4dba-a5f0-6679c1b692c6"],
Cell[83923, 2262, 1497, 38, 73, "Input",ExpressionUUID->"8e96711a-94e9-4572-8113-1ae11693f52a"]
}, Closed]],
Cell[CellGroupData[{
Cell[85457, 2305, 311, 5, 38, "Subsection",ExpressionUUID->"545a340a-5527-427c-988a-b9cc8a7be66d"],
Cell[85771, 2312, 19628, 466, 1732, "Input",ExpressionUUID->"ad9daf91-2a58-4121-8f03-88039b4fbf99"]
}, Closed]],
Cell[CellGroupData[{
Cell[105436, 2783, 175, 3, 38, "Subsection",ExpressionUUID->"d1d6f3d4-b12a-403d-b041-9db0f6b8f6f9"],
Cell[105614, 2788, 502, 13, 30, "Input",ExpressionUUID->"79e47f20-e180-4740-83b3-14f50fcaa641"],
Cell[106119, 2803, 3385, 64, 87, "Input",ExpressionUUID->"88316e5b-4886-4e78-a448-3ffdeb6526d4"],
Cell[109507, 2869, 467, 11, 30, "Input",ExpressionUUID->"7a9dbe2c-49cb-4300-a9a5-9656503cf110"],
Cell[109977, 2882, 1516, 41, 73, "Input",ExpressionUUID->"01b611dc-9ebc-4458-849d-36db35724206"],
Cell[111496, 2925, 743, 15, 73, "Input",ExpressionUUID->"b8eb227b-21c8-4ca6-90ac-5f42bc145a0c"],
Cell[112242, 2942, 524, 13, 30, "Input",ExpressionUUID->"b9fc31d5-3bd8-4e1c-9f3d-5f2e1901fe0a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112803, 2960, 219, 3, 54, "Subsection",ExpressionUUID->"8a280100-5ebb-444b-ab94-8e32d418bdc4"],
Cell[CellGroupData[{
Cell[113047, 2967, 1843, 47, 73, "Input",ExpressionUUID->"17193056-af62-42af-9a14-d585b21ff230"],
Cell[114893, 3016, 3777, 55, 70, "Output",ExpressionUUID->"501489c7-853e-4c5a-bf2e-687a91cbe212"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118707, 3076, 1327, 35, 52, "Input",ExpressionUUID->"cc5097e5-3bcb-43c4-b60c-446c0f336f08"],
Cell[120037, 3113, 3737, 54, 70, "Output",ExpressionUUID->"7b0d2035-c607-4f14-8754-69e8a79f738e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123811, 3172, 1227, 33, 52, "Input",ExpressionUUID->"39cd7503-604b-4deb-8a49-3b06f1743982"],
Cell[125041, 3207, 1226, 19, 70, "Output",ExpressionUUID->"2d9659ba-9d2d-4c29-a3e7-6a0ce349078b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126304, 3231, 1988, 51, 115, "Input",ExpressionUUID->"aed04b56-aa51-41a4-bb91-bc0fae0298b6"],
Cell[128295, 3284, 3409, 49, 70, "Output",ExpressionUUID->"bfeaef6f-43fa-4430-b8cb-b985bebd9d98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131741, 3338, 403, 10, 30, "Input",ExpressionUUID->"2c73614d-62dc-4cbf-a0df-ebd6023d7624"],
Cell[132147, 3350, 3189, 47, 70, "Output",ExpressionUUID->"b7baf589-9123-4131-9b98-7b0e1cb130f6"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[135397, 3404, 177, 3, 53, "Section",ExpressionUUID->"a9c141ba-8519-4b49-85c6-9baa527a44f2"],
Cell[CellGroupData[{
Cell[135599, 3411, 470, 12, 30, "Input",ExpressionUUID->"7171acee-803e-444b-b3c8-b5d5d647b567"],
Cell[136072, 3425, 2448, 49, 70, "Output",ExpressionUUID->"30a3be11-52f5-4cd2-8762-fc0be1c3364b"]
}, Open  ]],
Cell[138535, 3477, 1450, 44, 73, "Input",ExpressionUUID->"84d3efc7-023d-4218-8384-e1aac8e96f87"],
Cell[139988, 3523, 878, 25, 73, "Input",ExpressionUUID->"b1db5281-929e-4d97-bb73-a8bf27f0a238"],
Cell[140869, 3550, 600, 14, 30, "Input",ExpressionUUID->"de9b5445-4358-44f0-b901-21403aa22caf"],
Cell[141472, 3566, 1436, 40, 94, "Input",ExpressionUUID->"8e4930e2-6f5a-49f0-9289-e06f0b5f9ecb"],
Cell[142911, 3608, 404, 11, 30, "Input",ExpressionUUID->"12b78450-1da4-4d9a-84e9-540c84e438c2"],
Cell[143318, 3621, 1339, 38, 94, "Input",ExpressionUUID->"381e6d30-0182-48ea-a19c-dc4060a475aa"],
Cell[144660, 3661, 360, 10, 30, "Input",ExpressionUUID->"095c6809-4c03-4250-bf5a-fbcf2eb3f31e"],
Cell[CellGroupData[{
Cell[145045, 3675, 1046, 30, 73, "Input",ExpressionUUID->"e5c02916-5d63-4fde-b9c6-99a9c0cab218"],
Cell[146094, 3707, 2592, 42, 70, "Output",ExpressionUUID->"ff75c0e1-a051-42f7-a05e-e6aac703dcd7"]
}, Open  ]],
Cell[148701, 3752, 4763, 128, 283, "Input",ExpressionUUID->"f4892534-b283-48f4-b1af-4592d49a94f3"],
Cell[153467, 3882, 2062, 57, 136, "Input",ExpressionUUID->"62c8938a-a58f-4d53-ac8b-5ef4d0058544"],
Cell[155532, 3941, 841, 24, 73, "Input",ExpressionUUID->"db678403-e4e6-412d-9838-ad5544d16bc6"],
Cell[156376, 3967, 2402, 66, 157, "Input",ExpressionUUID->"7a054ed2-5030-4e08-85fb-d29914dfe64a"],
Cell[CellGroupData[{
Cell[158803, 4037, 537, 15, 30, "Input",ExpressionUUID->"1e1f08bb-5552-4822-a6c0-ab69f163bb18"],
Cell[159343, 4054, 2063, 66, 70, "Output",ExpressionUUID->"6610d3c2-6e5f-4dce-9356-7a707043f77e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[161455, 4126, 225, 4, 53, "Section",ExpressionUUID->"fdf6a17b-845c-40dd-99dd-458087b41466"],
Cell[CellGroupData[{
Cell[161705, 4134, 244, 5, 54, "Subsection",ExpressionUUID->"6e7047fe-0eab-44fe-84f5-117f1d33e0f3"],
Cell[161952, 4141, 415, 13, 30, "Input",ExpressionUUID->"d6899ffb-f89c-4b15-86cc-8dae5eaad5c0"],
Cell[162370, 4156, 3963, 100, 262, "Input",ExpressionUUID->"415aa5c4-3a5c-4423-90f2-cdbf2ea032f4"],
Cell[166336, 4258, 2145, 55, 94, "Input",ExpressionUUID->"201ea1b3-645d-4fd2-a4bf-2c79ea99619b"],
Cell[CellGroupData[{
Cell[168506, 4317, 1025, 28, 73, "Input",ExpressionUUID->"467cd5b9-6e7f-4b32-8901-8dea4329113a"],
Cell[169534, 4347, 1137, 19, 34, "Output",ExpressionUUID->"8046e151-c011-446c-bf63-a8dc997e64f7"]
}, Open  ]],
Cell[170686, 4369, 1391, 37, 52, "Input",ExpressionUUID->"13130738-1649-4fa1-bdf0-db7e08d09deb"],
Cell[172080, 4408, 1119, 33, 73, "Input",ExpressionUUID->"a2f80fb3-3351-4e93-bcc1-26b5791c3d4a"],
Cell[173202, 4443, 1909, 51, 94, "Input",ExpressionUUID->"a81658cf-ad43-4ed3-8ebd-9815baf2429b"],
Cell[175114, 4496, 1613, 45, 115, "Input",ExpressionUUID->"9d18ab4f-de7d-4634-8491-274d0a6f0a34"],
Cell[176730, 4543, 1043, 26, 52, "Input",ExpressionUUID->"411dde82-7e1b-4b38-b04b-9751d5f0349b"],
Cell[177776, 4571, 1359, 34, 52, "Input",ExpressionUUID->"d429a0bf-e83a-4bbd-bdff-3431ae4a5a62"],
Cell[179138, 4607, 1549, 38, 52, "Input",ExpressionUUID->"53bf9186-cce3-48bf-93c5-b9ee0d2693b2"],
Cell[180690, 4647, 4430, 115, 283, "Input",ExpressionUUID->"58d940c1-7152-4acd-9b4d-221074b0997e"],
Cell[185123, 4764, 1636, 39, 73, "Input",ExpressionUUID->"4b224eff-15d1-40a9-b411-85fd0f0a895a"],
Cell[186762, 4805, 967, 24, 30, "Input",ExpressionUUID->"b3d97911-6808-4159-89a5-02fc9f4c851c"],
Cell[187732, 4831, 1522, 37, 73, "Input",ExpressionUUID->"3a30565a-5643-4bf8-a192-f7159c59b32a"],
Cell[189257, 4870, 1434, 37, 94, "Input",ExpressionUUID->"3bafd588-35fa-4784-b45d-c125c27ec105"],
Cell[190694, 4909, 2083, 52, 136, "Input",ExpressionUUID->"a490e974-9ed2-4bb7-a4e1-ce013a00d4ae"],
Cell[192780, 4963, 1619, 38, 73, "Input",ExpressionUUID->"21224414-9bde-4864-9250-dc46179f1af2"],
Cell[194402, 5003, 1352, 34, 73, "Input",ExpressionUUID->"10d4692d-9a82-4cff-a821-9b210c77c2d7"],
Cell[CellGroupData[{
Cell[195779, 5041, 2412, 59, 73, "Input",ExpressionUUID->"1ae54e05-9edc-413b-8b43-0549e5dae5ec"],
Cell[198194, 5102, 4128, 60, 34, "Output",ExpressionUUID->"50579ddd-f296-451a-9c91-82b8178bf5cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202359, 5167, 224, 3, 45, "Subsubsection",ExpressionUUID->"e85f810f-a90a-4ea9-97a2-ac9aa0925e54"],
Cell[CellGroupData[{
Cell[202608, 5174, 1946, 49, 115, "Input",ExpressionUUID->"175176a2-c0ea-40cf-9bbd-1b7eb201b5c3"],
Cell[204557, 5225, 1039, 17, 70, "Output",ExpressionUUID->"350a80ab-e2e7-451a-a844-2deb9001086d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205633, 5247, 1376, 35, 52, "Input",ExpressionUUID->"66bd0bca-9cd1-4dca-9df4-565f6ac5c982"],
Cell[207012, 5284, 963, 16, 70, "Output",ExpressionUUID->"69880995-ef5d-4098-9c74-8ea141b695e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208012, 5305, 3695, 97, 115, "Input",ExpressionUUID->"66d76a0b-96c5-4ad6-b144-c71a690c1faf"],
Cell[211710, 5404, 942, 15, 70, "Output",ExpressionUUID->"e306c4ad-a5a8-43c3-8623-daa9a772a7d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212689, 5424, 3969, 101, 115, "Input",ExpressionUUID->"2cff1d52-501d-47a7-b1de-f602616ba5c9"],
Cell[216661, 5527, 924, 15, 70, "Output",ExpressionUUID->"71ac3e8f-1394-462e-86df-39150951c70e"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[217646, 5549, 317, 6, 54, "Subsection",ExpressionUUID->"c5f8b8f6-d571-4639-8698-17c825fec5a1"],
Cell[217966, 5557, 614, 16, 30, "Input",ExpressionUUID->"2153d7f3-93e3-4799-b8ea-a577d9318015"],
Cell[218583, 5575, 1770, 44, 94, "Input",ExpressionUUID->"4a504094-0d1b-48d2-9585-f2d1106d97d9"],
Cell[220356, 5621, 1487, 37, 73, "Input",ExpressionUUID->"3c30d81c-97e4-4651-8048-b9d88386d607"],
Cell[221846, 5660, 1788, 49, 115, "Input",ExpressionUUID->"f257b120-d769-4866-b943-d26bf3197e45"],
Cell[223637, 5711, 659, 16, 30, "Input",ExpressionUUID->"238d879c-9233-4d36-bca2-8da894d0919f"],
Cell[224299, 5729, 2554, 67, 115, "Input",ExpressionUUID->"6f8075d8-f769-4238-9a63-1732d75ca222"],
Cell[226856, 5798, 1350, 35, 52, "Input",ExpressionUUID->"c1d7b40d-ee49-4220-99c1-8ea47bef519e"],
Cell[228209, 5835, 2128, 53, 115, "Input",ExpressionUUID->"ae17c9e7-3abe-470a-8482-61e43a87082c"],
Cell[230340, 5890, 1091, 28, 52, "Input",ExpressionUUID->"acfa0575-dc90-4d20-a66d-db5a60d5293a"]
}, Closed]],
Cell[CellGroupData[{
Cell[231468, 5923, 195, 4, 38, "Subsection",ExpressionUUID->"8c583446-be8f-41c8-99b8-72d1cf73ad63"],
Cell[231666, 5929, 4285, 110, 199, "Input",ExpressionUUID->"7c04be06-3864-48bf-9a18-7d4a93c6dcc4"],
Cell[235954, 6041, 6651, 136, 493, "Input",ExpressionUUID->"07d3d6ea-d18b-44d5-9705-cca83c1c13a1"],
Cell[242608, 6179, 1137, 30, 94, "Input",ExpressionUUID->"bf4363b4-2f6a-4c27-8a3e-87fb81d9c82b"],
Cell[243748, 6211, 1636, 44, 136, "Input",ExpressionUUID->"03507d32-3026-4253-a4ea-f6cc5decab6f"]
}, Closed]],
Cell[CellGroupData[{
Cell[245421, 6260, 140, 3, 38, "Subsection",ExpressionUUID->"406dc209-f1f7-425c-992c-b4f6afc99697"],
Cell[245564, 6265, 4367, 109, 241, "Input",ExpressionUUID->"02453a95-be21-44a5-b0dc-68d99a7c71c5"],
Cell[249934, 6376, 573, 14, 30, "Input",ExpressionUUID->"c438f1ce-c006-4961-a115-6cde4a584fb1"],
Cell[CellGroupData[{
Cell[250532, 6394, 1111, 32, 94, "Input",ExpressionUUID->"75ac012e-0e5a-47d2-aae7-7bfe3dd3934d"],
Cell[251646, 6428, 688, 11, 70, "Output",ExpressionUUID->"1b0a50cb-b185-4745-a052-905aa1836396"]
}, Open  ]],
Cell[252349, 6442, 9853, 212, 682, "Input",ExpressionUUID->"c2a592fc-4ee1-4831-b2b6-082b65a4708c"],
Cell[CellGroupData[{
Cell[262227, 6658, 1710, 45, 157, "Input",ExpressionUUID->"10a34ec0-84d6-4981-aa31-7b15e4ba1e8e"],
Cell[263940, 6705, 1025, 17, 70, "Output",ExpressionUUID->"e5eb71c6-e18a-4e67-8585-50be3dd81f20"]
}, Open  ]],
Cell[264980, 6725, 3118, 70, 199, "Input",ExpressionUUID->"35033052-bb44-4dd4-87a3-9de3690217c1"],
Cell[CellGroupData[{
Cell[268123, 6799, 381, 9, 30, "Input",ExpressionUUID->"5c27dae1-ca9d-491a-aa19-eda113d40980"],
Cell[268507, 6810, 1673, 25, 70, "Output",ExpressionUUID->"42a6399a-28a2-495a-93b7-afd92169845d"]
}, Open  ]],
Cell[270195, 6838, 3534, 76, 283, "Input",ExpressionUUID->"851ec7c1-dd94-4090-afad-102f30ed8e6b"],
Cell[273732, 6916, 8563, 196, 493, "Input",ExpressionUUID->"26d6ea67-70a7-4fba-aa9c-aec2a1467ff4"],
Cell[CellGroupData[{
Cell[282320, 7116, 454, 11, 30, "Input",ExpressionUUID->"0494ae42-a03d-4794-9ab3-7fc0f6dfbb6e"],
Cell[282777, 7129, 643, 11, 70, "Output",ExpressionUUID->"4c8d7009-a0b2-40b2-bbbc-bc21debed964"]
}, Open  ]],
Cell[283435, 7143, 395, 10, 30, "Input",ExpressionUUID->"3372287c-4b0e-4385-8941-07fde7549cf5"],
Cell[283833, 7155, 1896, 46, 178, "Input",ExpressionUUID->"98f3766b-1760-4bee-95f1-a927506d0f55"],
Cell[CellGroupData[{
Cell[285754, 7205, 378, 10, 30, "Input",ExpressionUUID->"c9da7019-2f34-410e-9bf3-f264bb091583"],
Cell[286135, 7217, 729, 12, 70, "Output",ExpressionUUID->"2404d0d1-f9b1-43b8-9336-acec99ccd13d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[286913, 7235, 249, 5, 38, "Subsection",ExpressionUUID->"dcc6eac5-eeba-42d7-ab19-101c17266e8a"],
Cell[287165, 7242, 2301, 55, 115, "Input",ExpressionUUID->"83f29ebf-2f3e-4471-a2ad-45dd7aa31412"],
Cell[CellGroupData[{
Cell[289491, 7301, 521, 11, 30, "Input",ExpressionUUID->"e8fb6775-9efe-4f20-885b-e7d0789631d0"],
Cell[290015, 7314, 1981, 31, 70, "Output",ExpressionUUID->"310110e8-ab05-4c84-984a-44a86df775ba"]
}, Open  ]],
Cell[292011, 7348, 2320, 55, 199, "Input",ExpressionUUID->"3de79e43-3c0e-4643-93c3-748f959daeb2"]
}, Closed]],
Cell[CellGroupData[{
Cell[294368, 7408, 162, 3, 38, "Subsection",ExpressionUUID->"c5afec6d-d936-415e-bb62-7d28526b0f42"],
Cell[294533, 7413, 2503, 54, 77, "Input",ExpressionUUID->"dcac8d7c-56bb-4f01-9cc6-a73222053280"],
Cell[297039, 7469, 1087, 28, 94, "Input",ExpressionUUID->"32f46293-bbdb-479d-ae1c-e748cbf8a992"],
Cell[298129, 7499, 1114, 28, 73, "Input",ExpressionUUID->"eec844ae-c16f-4780-aebd-15d9889c5f79"],
Cell[299246, 7529, 1032, 27, 116, "Input",ExpressionUUID->"d2409465-6f1e-4672-abf1-cbb7e4d0ca6b"],
Cell[300281, 7558, 4912, 131, 220, "Input",ExpressionUUID->"12d7c475-e621-450a-b91f-07f8b563b3e7"],
Cell[305196, 7691, 4577, 126, 220, "Input",ExpressionUUID->"a924f968-0bf0-4296-8e61-d89e1045dde9"],
Cell[309776, 7819, 239, 5, 30, "Input",ExpressionUUID->"03e5ac5b-1104-4ca5-bc49-838b4b0d9084"],
Cell[310018, 7826, 1952, 54, 136, "Input",ExpressionUUID->"28d2dc29-2868-46fe-b99e-55c7e58e8f4d"],
Cell[311973, 7882, 16296, 335, 913, "Input",ExpressionUUID->"96fe6eba-0c0a-4264-bfdb-2f612021ccbe"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[328318, 8223, 196, 4, 67, "Section",ExpressionUUID->"6148301d-b24e-493a-afa4-ddf8cf81d77e"],
Cell[328517, 8229, 399, 10, 30, "Input",ExpressionUUID->"1ee05b6f-ca55-48a4-b944-b6c5b9b642ef"],
Cell[328919, 8241, 769, 15, 46, "Input",ExpressionUUID->"f4cf37f6-cca3-4f7a-a0e2-3221d00773fb"],
Cell[CellGroupData[{
Cell[329713, 8260, 1943, 31, 46, "Input",ExpressionUUID->"a6d54f08-48eb-4f56-924f-d2320b697d25"],
Cell[331659, 8293, 1284, 23, 67, "Output",ExpressionUUID->"048d7f88-8964-4a15-b975-330428c3593d"]
}, Open  ]],
Cell[332958, 8319, 705, 19, 94, "Input",ExpressionUUID->"61913043-8e97-4d19-8592-1c1b44ce85b7"],
Cell[CellGroupData[{
Cell[333688, 8342, 148, 3, 30, "Input",ExpressionUUID->"132fc161-a994-482a-83ac-0e6a7518070c"],
Cell[333839, 8347, 865, 14, 34, "Output",ExpressionUUID->"93aecd9d-32b0-487d-97b0-b6fa5a8c26e1"]
}, Open  ]],
Cell[334719, 8364, 614, 13, 46, "Input",ExpressionUUID->"0f2db63f-5c4d-4fda-9015-cf3ae6eb95c1"],
Cell[CellGroupData[{
Cell[335358, 8381, 428, 11, 30, "Input",ExpressionUUID->"caac62f3-4572-4926-816c-ef2b575b6098"],
Cell[335789, 8394, 2044, 31, 93, "Output",ExpressionUUID->"b6a99dce-5423-44bd-a511-577bb8f63ca9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[337882, 8431, 172, 3, 67, "Section",ExpressionUUID->"6bf007d9-ee62-46b1-a108-caf5149cd2b8"],
Cell[338057, 8436, 334, 9, 30, "Input",ExpressionUUID->"ecb1c1e3-6694-498c-bcb1-cc7a6a9a1deb"],
Cell[CellGroupData[{
Cell[338416, 8449, 524, 12, 30, "Input",ExpressionUUID->"93d508ea-62c9-4abf-87f8-c08466958f63"],
Cell[338943, 8463, 2973, 85, 119, "Output",ExpressionUUID->"209d2142-9d00-48c9-a387-9bec60e3f90e"]
}, Open  ]],
Cell[341931, 8551, 592, 13, 30, "Input",ExpressionUUID->"f6e57170-c010-49b0-9c31-7727910c7543"]
}, Open  ]]
}
]
*)

